!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CappuccinoChatEmbeddedWidget={})}(this,(function(e){"use strict";var t=Object.defineProperty,n=(e,n,i)=>((e,n,i)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i)(e,"symbol"!=typeof n?n+"":n,i);function i(e,t){for(var n=0;n<t.length;n++){const i=t[n];if("string"!=typeof i&&!Array.isArray(i))for(const t in i)if("default"!==t&&!(t in e)){const n=Object.getOwnPropertyDescriptor(i,t);n&&Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>i[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}
/**
  * @vue/shared v3.4.38
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **/
/*! #__NO_SIDE_EFFECTS__ */function o(e,t){const n=new Set(e.split(","));return e=>n.has(e)}const s={},r=[],a=()=>{},l=()=>!1,c=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),d=e=>e.startsWith("onUpdate:"),u=Object.assign,h=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},g=Object.prototype.hasOwnProperty,p=(e,t)=>g.call(e,t),f=Array.isArray,m=e=>"[object Map]"===C(e),y=e=>"[object Set]"===C(e),v=e=>"[object Date]"===C(e),w=e=>"function"==typeof e,b=e=>"string"==typeof e,k=e=>"symbol"==typeof e,_=e=>null!==e&&"object"==typeof e,x=e=>(_(e)||w(e))&&w(e.then)&&w(e.catch),S=Object.prototype.toString,C=e=>S.call(e),T=e=>C(e).slice(8,-1),E=e=>"[object Object]"===C(e),I=e=>b(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,O=o(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),P=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},A=/-(\w)/g,D=P((e=>e.replace(A,((e,t)=>t?t.toUpperCase():"")))),M=/\B([A-Z])/g,W=P((e=>e.replace(M,"-$1").toLowerCase())),U=P((e=>e.charAt(0).toUpperCase()+e.slice(1))),L=P((e=>e?`on${U(e)}`:"")),F=(e,t)=>!Object.is(e,t),j=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},H=(e,t,n,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:n})},R=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let N;const z=()=>N||(N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});function B(e){if(f(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],o=b(i)?q(i):B(i);if(o)for(const e in o)t[e]=o[e]}return t}if(b(e)||_(e))return e}const $=/;(?![^(]*\))/g,G=/:([^]+)/,V=/\/\*[^]*?\*\//g;function q(e){const t={};return e.replace(V,"").split($).forEach((e=>{if(e){const n=e.split(G);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function K(e){let t="";if(b(e))t=e;else if(f(e))for(let n=0;n<e.length;n++){const i=K(e[n]);i&&(t+=i+" ")}else if(_(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const X=o("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function J(e){return!!e||""===e}function Y(e,t){if(e===t)return!0;let n=v(e),i=v(t);if(n||i)return!(!n||!i)&&e.getTime()===t.getTime();if(n=k(e),i=k(t),n||i)return e===t;if(n=f(e),i=f(t),n||i)return!(!n||!i)&&function(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=Y(e[i],t[i]);return n}(e,t);if(n=_(e),i=_(t),n||i){if(!n||!i)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e){const i=e.hasOwnProperty(n),o=t.hasOwnProperty(n);if(i&&!o||!i&&o||!Y(e[n],t[n]))return!1}}return String(e)===String(t)}function Z(e,t){return e.findIndex((e=>Y(e,t)))}const Q=e=>!(!e||!0!==e.__v_isRef),ee=e=>b(e)?e:null==e?"":f(e)||_(e)&&(e.toString===S||!w(e.toString))?Q(e)?ee(e.value):JSON.stringify(e,te,2):String(e),te=(e,t)=>Q(t)?te(e,t.value):m(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,n],i)=>(e[ne(t,i)+" =>"]=n,e)),{})}:y(t)?{[`Set(${t.size})`]:[...t.values()].map((e=>ne(e)))}:k(t)?ne(t):!_(t)||f(t)||E(t)?t:String(t),ne=(e,t="")=>{var n;return k(e)?`Symbol(${null!=(n=e.description)?n:t})`:e};
/**
  * @vue/reactivity v3.4.38
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **/
let ie,oe;class se{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ie,!e&&ie&&(this.index=(ie.scopes||(ie.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=ie;try{return ie=this,e()}finally{ie=t}}}on(){ie=this}off(){ie=this.parent}stop(e){if(this._active){let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0,this._active=!1}}}function re(e){return new se(e)}function ae(){return ie}class le{constructor(e,t,n,i){this.fn=e,this.trigger=t,this.scheduler=n,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,function(e,t=ie){t&&t.active&&t.effects.push(e)}(this,i)}get dirty(){if(2===this._dirtyLevel||3===this._dirtyLevel){this._dirtyLevel=1,fe();for(let e=0;e<this._depsLength;e++){const t=this.deps[e];if(t.computed&&(t.computed.value,this._dirtyLevel>=4))break}1===this._dirtyLevel&&(this._dirtyLevel=0),me()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=he,t=oe;try{return he=!0,oe=this,this._runnings++,ce(this),this.fn()}finally{de(this),this._runnings--,oe=t,he=e}}stop(){this.active&&(ce(this),de(this),this.onStop&&this.onStop(),this.active=!1)}}function ce(e){e._trackId++,e._depsLength=0}function de(e){if(e.deps.length>e._depsLength){for(let t=e._depsLength;t<e.deps.length;t++)ue(e.deps[t],e);e.deps.length=e._depsLength}}function ue(e,t){const n=e.get(t);void 0!==n&&t._trackId!==n&&(e.delete(t),0===e.size&&e.cleanup())}let he=!0,ge=0;const pe=[];function fe(){pe.push(he),he=!1}function me(){const e=pe.pop();he=void 0===e||e}function ye(){ge++}function ve(){for(ge--;!ge&&be.length;)be.shift()()}function we(e,t,n){if(t.get(e)!==e._trackId){t.set(e,e._trackId);const n=e.deps[e._depsLength];n!==t?(n&&ue(n,e),e.deps[e._depsLength++]=t):e._depsLength++}}const be=[];function ke(e,t,n){ye();for(const i of e.keys()){let n;i._dirtyLevel<t&&(null!=n?n:n=e.get(i)===i._trackId)&&(i._shouldSchedule||(i._shouldSchedule=0===i._dirtyLevel),i._dirtyLevel=t),i._shouldSchedule&&(null!=n?n:n=e.get(i)===i._trackId)&&(i.trigger(),i._runnings&&!i.allowRecurse||2===i._dirtyLevel||(i._shouldSchedule=!1,i.scheduler&&be.push(i.scheduler)))}ve()}const _e=(e,t)=>{const n=new Map;return n.cleanup=e,n.computed=t,n},xe=new WeakMap,Se=Symbol(""),Ce=Symbol("");function Te(e,t,n){if(he&&oe){let t=xe.get(e);t||xe.set(e,t=new Map);let i=t.get(n);i||t.set(n,i=_e((()=>t.delete(n)))),we(oe,i)}}function Ee(e,t,n,i,o,s){const r=xe.get(e);if(!r)return;let a=[];if("clear"===t)a=[...r.values()];else if("length"===n&&f(e)){const e=Number(i);r.forEach(((t,n)=>{("length"===n||!k(n)&&n>=e)&&a.push(t)}))}else switch(void 0!==n&&a.push(r.get(n)),t){case"add":f(e)?I(n)&&a.push(r.get("length")):(a.push(r.get(Se)),m(e)&&a.push(r.get(Ce)));break;case"delete":f(e)||(a.push(r.get(Se)),m(e)&&a.push(r.get(Ce)));break;case"set":m(e)&&a.push(r.get(Se))}ye();for(const l of a)l&&ke(l,4);ve()}const Ie=o("__proto__,__v_isRef,__isVue"),Oe=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(k)),Pe=Ae();function Ae(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const n=yt(this);for(let t=0,o=this.length;t<o;t++)Te(n,0,t+"");const i=n[t](...e);return-1===i||!1===i?n[t](...e.map(yt)):i}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){fe(),ye();const n=yt(this)[t].apply(this,e);return ve(),me(),n}})),e}function De(e){k(e)||(e=String(e));const t=yt(this);return Te(t,0,e),t.hasOwnProperty(e)}class Me{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){const i=this._isReadonly,o=this._isShallow;if("__v_isReactive"===t)return!i;if("__v_isReadonly"===t)return i;if("__v_isShallow"===t)return o;if("__v_raw"===t)return n===(i?o?ct:lt:o?at:rt).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const s=f(e);if(!i){if(s&&p(Pe,t))return Reflect.get(Pe,t,n);if("hasOwnProperty"===t)return De}const r=Reflect.get(e,t,n);return(k(t)?Oe.has(t):Ie(t))?r:(i||Te(e,0,t),o?r:St(r)?s&&I(t)?r:r.value:_(r)?i?ut(r):dt(r):r)}}class We extends Me{constructor(e=!1){super(!1,e)}set(e,t,n,i){let o=e[t];if(!this._isShallow){const t=pt(o);if(ft(n)||pt(n)||(o=yt(o),n=yt(n)),!f(e)&&St(o)&&!St(n))return!t&&(o.value=n,!0)}const s=f(e)&&I(t)?Number(t)<e.length:p(e,t),r=Reflect.set(e,t,n,i);return e===yt(i)&&(s?F(n,o)&&Ee(e,"set",t,n):Ee(e,"add",t,n)),r}deleteProperty(e,t){const n=p(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&n&&Ee(e,"delete",t,void 0),i}has(e,t){const n=Reflect.has(e,t);return k(t)&&Oe.has(t)||Te(e,0,t),n}ownKeys(e){return Te(e,0,f(e)?"length":Se),Reflect.ownKeys(e)}}class Ue extends Me{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const Le=new We,Fe=new Ue,je=new We(!0),He=e=>e,Re=e=>Reflect.getPrototypeOf(e);function Ne(e,t,n=!1,i=!1){const o=yt(e=e.__v_raw),s=yt(t);n||(F(t,s)&&Te(o,0,t),Te(o,0,s));const{has:r}=Re(o),a=i?He:n?bt:wt;return r.call(o,t)?a(e.get(t)):r.call(o,s)?a(e.get(s)):void(e!==o&&e.get(t))}function ze(e,t=!1){const n=this.__v_raw,i=yt(n),o=yt(e);return t||(F(e,o)&&Te(i,0,e),Te(i,0,o)),e===o?n.has(e):n.has(e)||n.has(o)}function Be(e,t=!1){return e=e.__v_raw,!t&&Te(yt(e),0,Se),Reflect.get(e,"size",e)}function $e(e,t=!1){t||ft(e)||pt(e)||(e=yt(e));const n=yt(this);return Re(n).has.call(n,e)||(n.add(e),Ee(n,"add",e,e)),this}function Ge(e,t,n=!1){n||ft(t)||pt(t)||(t=yt(t));const i=yt(this),{has:o,get:s}=Re(i);let r=o.call(i,e);r||(e=yt(e),r=o.call(i,e));const a=s.call(i,e);return i.set(e,t),r?F(t,a)&&Ee(i,"set",e,t):Ee(i,"add",e,t),this}function Ve(e){const t=yt(this),{has:n,get:i}=Re(t);let o=n.call(t,e);o||(e=yt(e),o=n.call(t,e)),i&&i.call(t,e);const s=t.delete(e);return o&&Ee(t,"delete",e,void 0),s}function qe(){const e=yt(this),t=0!==e.size,n=e.clear();return t&&Ee(e,"clear",void 0,void 0),n}function Ke(e,t){return function(n,i){const o=this,s=o.__v_raw,r=yt(s),a=t?He:e?bt:wt;return!e&&Te(r,0,Se),s.forEach(((e,t)=>n.call(i,a(e),a(t),o)))}}function Xe(e,t,n){return function(...i){const o=this.__v_raw,s=yt(o),r=m(s),a="entries"===e||e===Symbol.iterator&&r,l="keys"===e&&r,c=o[e](...i),d=n?He:t?bt:wt;return!t&&Te(s,0,l?Ce:Se),{next(){const{value:e,done:t}=c.next();return t?{value:e,done:t}:{value:a?[d(e[0]),d(e[1])]:d(e),done:t}},[Symbol.iterator](){return this}}}}function Je(e){return function(...t){return"delete"!==e&&("clear"===e?void 0:this)}}function Ye(){const e={get(e){return Ne(this,e)},get size(){return Be(this)},has:ze,add:$e,set:Ge,delete:Ve,clear:qe,forEach:Ke(!1,!1)},t={get(e){return Ne(this,e,!1,!0)},get size(){return Be(this)},has:ze,add(e){return $e.call(this,e,!0)},set(e,t){return Ge.call(this,e,t,!0)},delete:Ve,clear:qe,forEach:Ke(!1,!0)},n={get(e){return Ne(this,e,!0)},get size(){return Be(this,!0)},has(e){return ze.call(this,e,!0)},add:Je("add"),set:Je("set"),delete:Je("delete"),clear:Je("clear"),forEach:Ke(!0,!1)},i={get(e){return Ne(this,e,!0,!0)},get size(){return Be(this,!0)},has(e){return ze.call(this,e,!0)},add:Je("add"),set:Je("set"),delete:Je("delete"),clear:Je("clear"),forEach:Ke(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((o=>{e[o]=Xe(o,!1,!1),n[o]=Xe(o,!0,!1),t[o]=Xe(o,!1,!0),i[o]=Xe(o,!0,!0)})),[e,n,t,i]}const[Ze,Qe,et,tt]=Ye();function nt(e,t){const n=t?e?tt:et:e?Qe:Ze;return(t,i,o)=>"__v_isReactive"===i?!e:"__v_isReadonly"===i?e:"__v_raw"===i?t:Reflect.get(p(n,i)&&i in t?n:t,i,o)}const it={get:nt(!1,!1)},ot={get:nt(!1,!0)},st={get:nt(!0,!1)},rt=new WeakMap,at=new WeakMap,lt=new WeakMap,ct=new WeakMap;function dt(e){return pt(e)?e:ht(e,!1,Le,it,rt)}function ut(e){return ht(e,!0,Fe,st,lt)}function ht(e,t,n,i,o){if(!_(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const s=o.get(e);if(s)return s;const r=(a=e).__v_skip||!Object.isExtensible(a)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}(T(a));var a;if(0===r)return e;const l=new Proxy(e,2===r?i:n);return o.set(e,l),l}function gt(e){return pt(e)?gt(e.__v_raw):!(!e||!e.__v_isReactive)}function pt(e){return!(!e||!e.__v_isReadonly)}function ft(e){return!(!e||!e.__v_isShallow)}function mt(e){return!!e&&!!e.__v_raw}function yt(e){const t=e&&e.__v_raw;return t?yt(t):e}function vt(e){return Object.isExtensible(e)&&H(e,"__v_skip",!0),e}const wt=e=>_(e)?dt(e):e,bt=e=>_(e)?ut(e):e;class kt{constructor(e,t,n,i){this.getter=e,this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new le((()=>e(this._value)),(()=>xt(this,2===this.effect._dirtyLevel?2:3))),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=n}get value(){const e=yt(this);return e._cacheable&&!e.effect.dirty||!F(e._value,e._value=e.effect.run())||xt(e,4),_t(e),e.effect._dirtyLevel>=2&&xt(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function _t(e){var t;he&&oe&&(e=yt(e),we(oe,null!=(t=e.dep)?t:e.dep=_e((()=>e.dep=void 0),e instanceof kt?e:void 0)))}function xt(e,t=4,n,i){const o=(e=yt(e)).dep;o&&ke(o,t)}function St(e){return!(!e||!0!==e.__v_isRef)}function Ct(e){return function(e,t){if(St(e))return e;return new Tt(e,t)}(e,!1)}class Tt{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:yt(e),this._value=t?e:wt(e)}get value(){return _t(this),this._value}set value(e){const t=this.__v_isShallow||ft(e)||pt(e);e=t?e:yt(e),F(e,this._rawValue)&&(this._rawValue,this._rawValue=e,this._value=t?e:wt(e),xt(this,4))}}const Et={get:(e,t,n)=>{return St(i=Reflect.get(e,t,n))?i.value:i;var i},set:(e,t,n,i)=>{const o=e[t];return St(o)&&!St(n)?(o.value=n,!0):Reflect.set(e,t,n,i)}};function It(e){return gt(e)?e:new Proxy(e,Et)}class Ot{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return void 0===e?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return function(e,t){const n=xe.get(e);return n&&n.get(t)}(yt(this._object),this._key)}}class Pt{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function At(e,t,n){return St(e)?e:w(e)?new Pt(e):_(e)&&arguments.length>1?Dt(e,t,n):Ct(e)}function Dt(e,t,n){const i=e[t];return St(i)?i:new Ot(e,t,n)}
/**
  * @vue/runtime-core v3.4.38
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **/function Mt(e,t,n,i){try{return i?e(...i):e()}catch(o){Ut(o,t,n)}}function Wt(e,t,n,i){if(w(e)){const o=Mt(e,t,n,i);return o&&x(o)&&o.catch((e=>{Ut(e,t,n)})),o}if(f(e)){const o=[];for(let s=0;s<e.length;s++)o.push(Wt(e[s],t,n,i));return o}}function Ut(e,t,n,i=!0){t&&t.vnode;if(t){let i=t.parent;const o=t.proxy,s=`https://vuejs.org/error-reference/#runtime-${n}`;for(;i;){const t=i.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,o,s))return;i=i.parent}const r=t.appContext.config.errorHandler;if(r)return fe(),Mt(r,null,10,[e,o,s]),void me()}!function(e){console.error(e)}(e,0,0,i)}let Lt=!1,Ft=!1;const jt=[];let Ht=0;const Rt=[];let Nt=null,zt=0;const Bt=Promise.resolve();let $t=null;function Gt(e){const t=$t||Bt;return e?t.then(this?e.bind(this):e):t}function Vt(e){jt.length&&jt.includes(e,Lt&&e.allowRecurse?Ht+1:Ht)||(null==e.id?jt.push(e):jt.splice(function(e){let t=Ht+1,n=jt.length;for(;t<n;){const i=t+n>>>1,o=jt[i],s=Jt(o);s<e||s===e&&o.pre?t=i+1:n=i}return t}(e.id),0,e),qt())}function qt(){Lt||Ft||(Ft=!0,$t=Bt.then(Zt))}function Kt(e,t,n=(Lt?Ht+1:0)){for(;n<jt.length;n++){const t=jt[n];if(t&&t.pre){if(e&&t.id!==e.uid)continue;jt.splice(n,1),n--,t()}}}function Xt(e){if(Rt.length){const e=[...new Set(Rt)].sort(((e,t)=>Jt(e)-Jt(t)));if(Rt.length=0,Nt)return void Nt.push(...e);for(Nt=e,zt=0;zt<Nt.length;zt++){const e=Nt[zt];!1!==e.active&&e()}Nt=null,zt=0}}const Jt=e=>null==e.id?1/0:e.id,Yt=(e,t)=>{const n=Jt(e)-Jt(t);if(0===n){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function Zt(e){Ft=!1,Lt=!0,jt.sort(Yt);try{for(Ht=0;Ht<jt.length;Ht++){const e=jt[Ht];e&&!1!==e.active&&Mt(e,e.i,e.i?15:14)}}finally{Ht=0,jt.length=0,Xt(),Lt=!1,$t=null,(jt.length||Rt.length)&&Zt()}}let Qt=null,en=null;function tn(e){const t=Qt;return Qt=e,en=e&&e.type.__scopeId||null,t}function nn(e){en=e}function on(){en=null}function sn(e,t){if(null===Qt)return e;const n=So(Qt),i=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[e,r,a,l=s]=t[o];e&&(w(e)&&(e={mounted:e,updated:e}),e.deep&&Pi(r),i.push({dir:e,instance:n,value:r,oldValue:void 0,arg:a,modifiers:l}))}return e}function rn(e,t,n,i){const o=e.dirs,s=t&&t.dirs;for(let r=0;r<o.length;r++){const a=o[r];s&&(a.oldValue=s[r].value);let l=a.dir[i];l&&(fe(),Wt(l,n,8,[e.el,a,e,t]),me())}}function an(e,t){6&e.shapeFlag&&e.component?an(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}
/*! #__NO_SIDE_EFFECTS__ */function ln(e,t){return w(e)?(()=>u({name:e.name},t,{setup:e}))():e}const cn=e=>!!e.type.__asyncLoader,dn=e=>e.type.__isKeepAlive;function un(e,t){gn(e,"a",t)}function hn(e,t){gn(e,"da",t)}function gn(e,t,n=fo){const i=e.__wdc||(e.__wdc=()=>{let t=n;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(fn(t,i,n),n){let e=n.parent;for(;e&&e.parent;)dn(e.parent.vnode)&&pn(i,t,n,e),e=e.parent}}function pn(e,t,n,i){const o=fn(t,e,i,!0);_n((()=>{h(i[t],o)}),n)}function fn(e,t,n=fo,i=!1){if(n){const o=n[e]||(n[e]=[]),s=t.__weh||(t.__weh=(...i)=>{fe();const o=mo(n),s=Wt(t,n,e,i);return o(),me(),s});return i?o.unshift(s):o.push(s),s}}const mn=e=>(t,n=fo)=>{bo&&"sp"!==e||fn(e,((...e)=>t(...e)),n)},yn=mn("bm"),vn=mn("m"),wn=mn("bu"),bn=mn("u"),kn=mn("bum"),_n=mn("um"),xn=mn("sp"),Sn=mn("rtg"),Cn=mn("rtc");function Tn(e,t=fo){fn("ec",e,t)}const En=Symbol.for("v-ndc");function In(e,t,n,i){let o;const s=n;if(f(e)||b(e)){o=new Array(e.length);for(let n=0,i=e.length;n<i;n++)o[n]=t(e[n],n,void 0,s)}else if("number"==typeof e){o=new Array(e);for(let n=0;n<e;n++)o[n]=t(n+1,n,void 0,s)}else if(_(e))if(e[Symbol.iterator])o=Array.from(e,((e,n)=>t(e,n,void 0,s)));else{const n=Object.keys(e);o=new Array(n.length);for(let i=0,r=n.length;i<r;i++){const r=n[i];o[i]=t(e[r],r,i,s)}}else o=[];return o}const On=e=>e?vo(e)?So(e):On(e.parent):null,Pn=u(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>On(e.parent),$root:e=>On(e.root),$emit:e=>e.emit,$options:e=>jn(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,Vt(e.update)}),$nextTick:e=>e.n||(e.n=Gt.bind(e.proxy)),$watch:e=>Ii.bind(e)}),An=(e,t)=>e!==s&&!e.__isScriptSetup&&p(e,t),Dn={get({_:e},t){if("__v_skip"===t)return!0;const{ctx:n,setupState:i,data:o,props:r,accessCache:a,type:l,appContext:c}=e;let d;if("$"!==t[0]){const l=a[t];if(void 0!==l)switch(l){case 1:return i[t];case 2:return o[t];case 4:return n[t];case 3:return r[t]}else{if(An(i,t))return a[t]=1,i[t];if(o!==s&&p(o,t))return a[t]=2,o[t];if((d=e.propsOptions[0])&&p(d,t))return a[t]=3,r[t];if(n!==s&&p(n,t))return a[t]=4,n[t];Wn&&(a[t]=0)}}const u=Pn[t];let h,g;return u?("$attrs"===t&&Te(e.attrs,0,""),u(e)):(h=l.__cssModules)&&(h=h[t])?h:n!==s&&p(n,t)?(a[t]=4,n[t]):(g=c.config.globalProperties,p(g,t)?g[t]:void 0)},set({_:e},t,n){const{data:i,setupState:o,ctx:r}=e;return An(o,t)?(o[t]=n,!0):i!==s&&p(i,t)?(i[t]=n,!0):!p(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(r[t]=n,!0))},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:o,propsOptions:r}},a){let l;return!!n[a]||e!==s&&p(e,a)||An(t,a)||(l=r[0])&&p(l,a)||p(i,a)||p(Pn,a)||p(o.config.globalProperties,a)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:p(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Mn(e){return f(e)?e.reduce(((e,t)=>(e[t]=null,e)),{}):e}let Wn=!0;function Un(e){const t=jn(e),n=e.proxy,i=e.ctx;Wn=!1,t.beforeCreate&&Ln(t.beforeCreate,e,"bc");const{data:o,computed:s,methods:r,watch:l,provide:c,inject:d,created:u,beforeMount:h,mounted:g,beforeUpdate:p,updated:m,activated:y,deactivated:v,beforeDestroy:b,beforeUnmount:k,destroyed:x,unmounted:S,render:C,renderTracked:T,renderTriggered:E,errorCaptured:I,serverPrefetch:O,expose:P,inheritAttrs:A,components:D,directives:M,filters:W}=t;if(d&&function(e,t){f(e)&&(e=zn(e));for(const n in e){const i=e[n];let o;o=_(i)?"default"in i?Jn(i.from||n,i.default,!0):Jn(i.from||n):Jn(i),St(o)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>o.value,set:e=>o.value=e}):t[n]=o}}(d,i,null),r)for(const a in r){const e=r[a];w(e)&&(i[a]=e.bind(n))}if(o){const t=o.call(n,n);_(t)&&(e.data=dt(t))}if(Wn=!0,s)for(const f in s){const e=s[f],t=w(e)?e.bind(n,n):w(e.get)?e.get.bind(n,n):a,o=!w(e)&&w(e.set)?e.set.bind(n):a,r=Co({get:t,set:o});Object.defineProperty(i,f,{enumerable:!0,configurable:!0,get:()=>r.value,set:e=>r.value=e})}if(l)for(const a in l)Fn(l[a],i,n,a);if(c){const e=w(c)?c.call(n):c;Reflect.ownKeys(e).forEach((t=>{!function(e,t){if(fo){let n=fo.provides;const i=fo.parent&&fo.parent.provides;i===n&&(n=fo.provides=Object.create(i)),n[e]=t}else;}(t,e[t])}))}function U(e,t){f(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(u&&Ln(u,e,"c"),U(yn,h),U(vn,g),U(wn,p),U(bn,m),U(un,y),U(hn,v),U(Tn,I),U(Cn,T),U(Sn,E),U(kn,k),U(_n,S),U(xn,O),f(P))if(P.length){const t=e.exposed||(e.exposed={});P.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});C&&e.render===a&&(e.render=C),null!=A&&(e.inheritAttrs=A),D&&(e.components=D),M&&(e.directives=M)}function Ln(e,t,n){Wt(f(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function Fn(e,t,n,i){const o=i.includes(".")?Oi(n,i):()=>n[i];if(b(e)){const n=t[e];w(n)&&Ti(o,n)}else if(w(e))Ti(o,e.bind(n));else if(_(e))if(f(e))e.forEach((e=>Fn(e,t,n,i)));else{const i=w(e.handler)?e.handler.bind(n):t[e.handler];w(i)&&Ti(o,i,e)}}function jn(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:o,optionsCache:s,config:{optionMergeStrategies:r}}=e.appContext,a=s.get(t);let l;return a?l=a:o.length||n||i?(l={},o.length&&o.forEach((e=>Hn(l,e,r,!0))),Hn(l,t,r)):l=t,_(t)&&s.set(t,l),l}function Hn(e,t,n,i=!1){const{mixins:o,extends:s}=t;s&&Hn(e,s,n,!0),o&&o.forEach((t=>Hn(e,t,n,!0)));for(const r in t)if(i&&"expose"===r);else{const i=Rn[r]||n&&n[r];e[r]=i?i(e[r],t[r]):t[r]}return e}const Rn={data:Nn,props:Gn,emits:Gn,methods:$n,computed:$n,beforeCreate:Bn,created:Bn,beforeMount:Bn,mounted:Bn,beforeUpdate:Bn,updated:Bn,beforeDestroy:Bn,beforeUnmount:Bn,destroyed:Bn,unmounted:Bn,activated:Bn,deactivated:Bn,errorCaptured:Bn,serverPrefetch:Bn,components:$n,directives:$n,watch:function(e,t){if(!e)return t;if(!t)return e;const n=u(Object.create(null),e);for(const i in t)n[i]=Bn(e[i],t[i]);return n},provide:Nn,inject:function(e,t){return $n(zn(e),zn(t))}};function Nn(e,t){return t?e?function(){return u(w(e)?e.call(this,this):e,w(t)?t.call(this,this):t)}:t:e}function zn(e){if(f(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Bn(e,t){return e?[...new Set([].concat(e,t))]:t}function $n(e,t){return e?u(Object.create(null),e,t):t}function Gn(e,t){return e?f(e)&&f(t)?[...new Set([...e,...t])]:u(Object.create(null),Mn(e),Mn(null!=t?t:{})):t}function Vn(){return{app:null,config:{isNativeTag:l,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let qn=0;function Kn(e,t){return function(n,i=null){w(n)||(n=u({},n)),null==i||_(i)||(i=null);const o=Vn(),s=new WeakSet;let r=!1;const a=o.app={_uid:qn++,_component:n,_props:i,_container:null,_context:o,_instance:null,version:To,get config(){return o.config},set config(e){},use:(e,...t)=>(s.has(e)||(e&&w(e.install)?(s.add(e),e.install(a,...t)):w(e)&&(s.add(e),e(a,...t))),a),mixin:e=>(o.mixins.includes(e)||o.mixins.push(e),a),component:(e,t)=>t?(o.components[e]=t,a):o.components[e],directive:(e,t)=>t?(o.directives[e]=t,a):o.directives[e],mount(s,l,c){if(!r){const d=to(n,i);return d.appContext=o,!0===c?c="svg":!1===c&&(c=void 0),l&&t?t(d,s):e(d,s,c),r=!0,a._container=s,s.__vue_app__=a,So(d.component)}},unmount(){r&&(e(null,a._container),delete a._container.__vue_app__)},provide:(e,t)=>(o.provides[e]=t,a),runWithContext(e){const t=Xn;Xn=a;try{return e()}finally{Xn=t}}};return a}}let Xn=null;function Jn(e,t,n=!1){const i=fo||Qt;if(i||Xn){const o=Xn?Xn._context.provides:i?null==i.parent?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return n&&w(t)?t.call(i&&i.proxy):t}}const Yn={},Zn=()=>Object.create(Yn),Qn=e=>Object.getPrototypeOf(e)===Yn;function ei(e,t,n,i=!1){const o={},s=Zn();e.propsDefaults=Object.create(null),ti(e,t,o,s);for(const r in e.propsOptions[0])r in o||(o[r]=void 0);n?e.props=i?o:ht(o,!1,je,ot,at):e.type.props?e.props=o:e.props=s,e.attrs=s}function ti(e,t,n,i){const[o,r]=e.propsOptions;let a,l=!1;if(t)for(let s in t){if(O(s))continue;const c=t[s];let d;o&&p(o,d=D(s))?r&&r.includes(d)?(a||(a={}))[d]=c:n[d]=c:Wi(e.emitsOptions,s)||s in i&&c===i[s]||(i[s]=c,l=!0)}if(r){const t=yt(n),i=a||s;for(let s=0;s<r.length;s++){const a=r[s];n[a]=ni(o,t,a,i[a],e,!p(i,a))}}return l}function ni(e,t,n,i,o,s){const r=e[n];if(null!=r){const e=p(r,"default");if(e&&void 0===i){const e=r.default;if(r.type!==Function&&!r.skipFactory&&w(e)){const{propsDefaults:s}=o;if(n in s)i=s[n];else{const r=mo(o);i=s[n]=e.call(null,t),r()}}else i=e}r[0]&&(s&&!e?i=!1:!r[1]||""!==i&&i!==W(n)||(i=!0))}return i}const ii=new WeakMap;function oi(e,t,n=!1){const i=n?ii:t.propsCache,o=i.get(e);if(o)return o;const a=e.props,l={},c=[];let d=!1;if(!w(e)){const i=e=>{d=!0;const[n,i]=oi(e,t,!0);u(l,n),i&&c.push(...i)};!n&&t.mixins.length&&t.mixins.forEach(i),e.extends&&i(e.extends),e.mixins&&e.mixins.forEach(i)}if(!a&&!d)return _(e)&&i.set(e,r),r;if(f(a))for(let r=0;r<a.length;r++){const e=D(a[r]);si(e)&&(l[e]=s)}else if(a)for(const s in a){const e=D(s);if(si(e)){const t=a[s],n=l[e]=f(t)||w(t)?{type:t}:u({},t),i=n.type;let o=!1,r=!0;if(f(i))for(let e=0;e<i.length;++e){const t=i[e],n=w(t)&&t.name;if("Boolean"===n){o=!0;break}"String"===n&&(r=!1)}else o=w(i)&&"Boolean"===i.name;n[0]=o,n[1]=r,(o||p(n,"default"))&&c.push(e)}}const h=[l,c];return _(e)&&i.set(e,h),h}function si(e){return"$"!==e[0]&&!O(e)}const ri=e=>"_"===e[0]||"$stable"===e,ai=e=>f(e)?e.map(ro):[ro(e)],li=(e,t,n)=>{if(t._n)return t;const i=function(e,t=Qt){if(!t)return e;if(e._n)return e;const n=(...i)=>{n._d&&qi(-1);const o=tn(t);let s;try{s=e(...i)}finally{tn(o),n._d&&qi(1)}return s};return n._n=!0,n._c=!0,n._d=!0,n}(((...e)=>ai(t(...e))),n);return i._c=!1,i},ci=(e,t,n)=>{const i=e._ctx;for(const o in e){if(ri(o))continue;const n=e[o];if(w(n))t[o]=li(0,n,i);else if(null!=n){const e=ai(n);t[o]=()=>e}}},di=(e,t)=>{const n=ai(t);e.slots.default=()=>n},ui=(e,t,n)=>{for(const i in t)(n||"_"!==i)&&(e[i]=t[i])},hi=(e,t,n)=>{const i=e.slots=Zn();if(32&e.vnode.shapeFlag){const e=t._;e?(ui(i,t,n),n&&H(i,"_",e,!0)):ci(t,i)}else t&&di(e,t)},gi=(e,t,n)=>{const{vnode:i,slots:o}=e;let r=!0,a=s;if(32&i.shapeFlag){const e=t._;e?n&&1===e?r=!1:ui(o,t,n):(r=!t.$stable,ci(t,o)),a=t}else t&&(di(e,t),a={default:1});if(r)for(const s in o)ri(s)||null!=a[s]||delete o[s]};function pi(e,t,n,i,o=!1){if(f(e))return void e.forEach(((e,s)=>pi(e,t&&(f(t)?t[s]:t),n,i,o)));if(cn(i)&&!o)return;const r=4&i.shapeFlag?So(i.component):i.el,a=o?null:r,{i:l,r:c}=e,d=t&&t.r,u=l.refs===s?l.refs={}:l.refs,g=l.setupState;if(null!=d&&d!==c&&(b(d)?(u[d]=null,p(g,d)&&(g[d]=null)):St(d)&&(d.value=null)),w(c))Mt(c,l,12,[a,u]);else{const t=b(c),i=St(c);if(t||i){const s=()=>{if(e.f){const n=t?p(g,c)?g[c]:u[c]:c.value;o?f(n)&&h(n,r):f(n)?n.includes(r)||n.push(r):t?(u[c]=[r],p(g,c)&&(g[c]=u[c])):(c.value=[r],e.k&&(u[e.k]=c.value))}else t?(u[c]=a,p(g,c)&&(g[c]=a)):i&&(c.value=a,e.k&&(u[e.k]=a))};a?(s.id=-1,mi(s,n)):s()}}}const fi=Symbol("_vte"),mi=function(e,t){t&&t.pendingBranch?f(e)?t.effects.push(...e):t.effects.push(e):(f(n=e)?Rt.push(...n):Nt&&Nt.includes(n,n.allowRecurse?zt+1:zt)||Rt.push(n),qt());var n};function yi(e){return function(e){z().__VUE__=!0;const{insert:t,remove:n,patchProp:i,createElement:o,createText:l,createComment:c,setText:d,setElementText:u,parentNode:h,nextSibling:g,setScopeId:f=a,insertStaticContent:m}=e,y=(e,t,n,i=null,o=null,s=null,r=void 0,a=null,l=!!t.dynamicChildren)=>{if(e===t)return;e&&!Yi(e,t)&&(i=Y(e),V(e,o,s,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:c,ref:d,shapeFlag:u}=t;switch(c){case Ri:v(e,t,n,i);break;case Ni:w(e,t,n,i);break;case zi:null==e&&b(t,n,i,r);break;case Hi:M(e,t,n,i,o,s,r,a,l);break;default:1&u?S(e,t,n,i,o,s,r,a,l):6&u?U(e,t,n,i,o,s,r,a,l):(64&u||128&u)&&c.process(e,t,n,i,o,s,r,a,l,ee)}null!=d&&o&&pi(d,e&&e.ref,s,t||e,!t)},v=(e,n,i,o)=>{if(null==e)t(n.el=l(n.children),i,o);else{const t=n.el=e.el;n.children!==e.children&&d(t,n.children)}},w=(e,n,i,o)=>{null==e?t(n.el=c(n.children||""),i,o):n.el=e.el},b=(e,t,n,i)=>{[e.el,e.anchor]=m(e.children,t,n,i,e.el,e.anchor)},k=({el:e,anchor:n},i,o)=>{let s;for(;e&&e!==n;)s=g(e),t(e,i,o),e=s;t(n,i,o)},_=({el:e,anchor:t})=>{let i;for(;e&&e!==t;)i=g(e),n(e),e=i;n(t)},S=(e,t,n,i,o,s,r,a,l)=>{"svg"===t.type?r="svg":"math"===t.type&&(r="mathml"),null==e?C(t,n,i,o,s,r,a,l):I(e,t,o,s,r,a,l)},C=(e,n,s,r,a,l,c,d)=>{let h,g;const{props:p,shapeFlag:f,transition:m,dirs:y}=e;if(h=e.el=o(e.type,l,p&&p.is,p),8&f?u(h,e.children):16&f&&E(e.children,h,null,r,a,vi(e,l),c,d),y&&rn(e,null,r,"created"),T(h,e,e.scopeId,c,r),p){for(const e in p)"value"===e||O(e)||i(h,e,null,p[e],l,r);"value"in p&&i(h,"value",null,p.value,l),(g=p.onVnodeBeforeMount)&&co(g,r,e)}y&&rn(e,null,r,"beforeMount");const v=function(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}(a,m);v&&m.beforeEnter(h),t(h,n,s),((g=p&&p.onVnodeMounted)||v||y)&&mi((()=>{g&&co(g,r,e),v&&m.enter(h),y&&rn(e,null,r,"mounted")}),a)},T=(e,t,n,i,o)=>{if(n&&f(e,n),i)for(let s=0;s<i.length;s++)f(e,i[s]);if(o){if(t===o.subTree){const t=o.vnode;T(e,t,t.scopeId,t.slotScopeIds,o.parent)}}},E=(e,t,n,i,o,s,r,a,l=0)=>{for(let c=l;c<e.length;c++){const l=e[c]=a?ao(e[c]):ro(e[c]);y(null,l,t,n,i,o,s,r,a)}},I=(e,t,n,o,r,a,l)=>{const c=t.el=e.el;let{patchFlag:d,dynamicChildren:h,dirs:g}=t;d|=16&e.patchFlag;const p=e.props||s,f=t.props||s;let m;if(n&&wi(n,!1),(m=f.onVnodeBeforeUpdate)&&co(m,n,t,e),g&&rn(t,e,n,"beforeUpdate"),n&&wi(n,!0),(p.innerHTML&&null==f.innerHTML||p.textContent&&null==f.textContent)&&u(c,""),h?P(e.dynamicChildren,h,c,n,o,vi(t,r),a):l||N(e,t,c,null,n,o,vi(t,r),a,!1),d>0){if(16&d)A(c,p,f,n,r);else if(2&d&&p.class!==f.class&&i(c,"class",null,f.class,r),4&d&&i(c,"style",p.style,f.style,r),8&d){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const o=e[t],s=p[o],a=f[o];a===s&&"value"!==o||i(c,o,s,a,r,n)}}1&d&&e.children!==t.children&&u(c,t.children)}else l||null!=h||A(c,p,f,n,r);((m=f.onVnodeUpdated)||g)&&mi((()=>{m&&co(m,n,t,e),g&&rn(t,e,n,"updated")}),o)},P=(e,t,n,i,o,s,r)=>{for(let a=0;a<t.length;a++){const l=e[a],c=t[a],d=l.el&&(l.type===Hi||!Yi(l,c)||70&l.shapeFlag)?h(l.el):n;y(l,c,d,null,i,o,s,r,!0)}},A=(e,t,n,o,r)=>{if(t!==n){if(t!==s)for(const s in t)O(s)||s in n||i(e,s,t[s],null,r,o);for(const s in n){if(O(s))continue;const a=n[s],l=t[s];a!==l&&"value"!==s&&i(e,s,l,a,r,o)}"value"in n&&i(e,"value",t.value,n.value,r)}},M=(e,n,i,o,s,r,a,c,d)=>{const u=n.el=e?e.el:l(""),h=n.anchor=e?e.anchor:l("");let{patchFlag:g,dynamicChildren:p,slotScopeIds:f}=n;f&&(c=c?c.concat(f):f),null==e?(t(u,i,o),t(h,i,o),E(n.children||[],i,h,s,r,a,c,d)):g>0&&64&g&&p&&e.dynamicChildren?(P(e.dynamicChildren,p,i,s,r,a,c),(null!=n.key||s&&n===s.subTree)&&bi(e,n,!0)):N(e,n,i,h,s,r,a,c,d)},U=(e,t,n,i,o,s,r,a,l)=>{t.slotScopeIds=a,null==e?512&t.shapeFlag?o.ctx.activate(t,n,i,r,l):L(t,n,i,o,s,r,l):F(e,t,l)},L=(e,t,n,i,o,r,a)=>{const l=e.component=function(e,t,n){const i=e.type,o=(t?t.appContext:e.appContext)||uo,r={uid:ho++,vnode:e,type:i,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new se(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:oi(i,o),emitsOptions:Mi(i,o),emit:null,emitted:null,propsDefaults:s,inheritAttrs:i.inheritAttrs,ctx:s,data:s,props:s,attrs:s,slots:s,refs:s,setupState:s,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};r.ctx={_:r},r.root=t?t.root:r,r.emit=Di.bind(null,r),e.ce&&e.ce(r);return r}(e,i,o);if(dn(e)&&(l.ctx.renderer=ee),function(e,t=!1,n=!1){t&&po(t);const{props:i,children:o}=e.vnode,s=vo(e);ei(e,i,s,t),hi(e,o,n);const r=s?function(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Dn);const{setup:i}=n;if(i){const n=e.setupContext=i.length>1?function(e){const t=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,xo),slots:e.slots,emit:e.emit,expose:t}}(e):null,o=mo(e);fe();const s=Mt(i,e,0,[e.props,n]);if(me(),o(),x(s)){if(s.then(yo,yo),t)return s.then((n=>{ko(e,n,t)})).catch((t=>{Ut(t,e,0)}));e.asyncDep=s}else ko(e,s,t)}else _o(e,t)}(e,t):void 0;t&&po(!1)}(l,!1,a),l.asyncDep){if(o&&o.registerDep(l,H,a),!e.el){const e=l.subTree=to(Ni);w(null,e,t,n)}}else H(l,e,t,n,o,r,a)},F=(e,t,n)=>{const i=t.component=e.component;if(function(e,t,n){const{props:i,children:o,component:s}=e,{props:r,children:a,patchFlag:l}=t,c=s.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&l>=0))return!(!o&&!a||a&&a.$stable)||i!==r&&(i?!r||ji(i,r,c):!!r);if(1024&l)return!0;if(16&l)return i?ji(i,r,c):!!r;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(r[n]!==i[n]&&!Wi(c,n))return!0}}return!1}(e,t,n)){if(i.asyncDep&&!i.asyncResolved)return void R(i,t,n);i.next=t,function(e){const t=jt.indexOf(e);t>Ht&&jt.splice(t,1)}(i.update),i.effect.dirty=!0,i.update()}else t.el=e.el,i.vnode=t},H=(e,t,n,i,o,s,r)=>{const l=()=>{if(e.isMounted){let{next:t,bu:n,u:i,parent:a,vnode:c}=e;{const n=ki(e);if(n)return t&&(t.el=c.el,R(e,t,r)),void n.asyncDep.then((()=>{e.isUnmounted||l()}))}let d,u=t;wi(e,!1),t?(t.el=c.el,R(e,t,r)):t=c,n&&j(n),(d=t.props&&t.props.onVnodeBeforeUpdate)&&co(d,a,t,c),wi(e,!0);const g=Ui(e),p=e.subTree;e.subTree=g,y(p,g,h(p.el),Y(p),e,o,s),t.el=g.el,null===u&&function({vnode:e,parent:t},n){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i!==e)break;(e=t.vnode).el=n,t=t.parent}}(e,g.el),i&&mi(i,o),(d=t.props&&t.props.onVnodeUpdated)&&mi((()=>co(d,a,t,c)),o)}else{let r;const{el:a,props:l}=t,{bm:c,m:d,parent:u}=e,h=cn(t);if(wi(e,!1),c&&j(c),!h&&(r=l&&l.onVnodeBeforeMount)&&co(r,u,t),wi(e,!0),a&&ne){const n=()=>{e.subTree=Ui(e),ne(a,e.subTree,e,o,null)};h?t.type.__asyncLoader().then((()=>!e.isUnmounted&&n())):n()}else{const r=e.subTree=Ui(e);y(null,r,n,i,e,o,s),t.el=r.el}if(d&&mi(d,o),!h&&(r=l&&l.onVnodeMounted)){const e=t;mi((()=>co(r,u,e)),o)}(256&t.shapeFlag||u&&cn(u.vnode)&&256&u.vnode.shapeFlag)&&e.a&&mi(e.a,o),e.isMounted=!0,t=n=i=null}},c=e.effect=new le(l,a,(()=>Vt(d)),e.scope),d=e.update=()=>{c.dirty&&c.run()};d.i=e,d.id=e.uid,wi(e,!0),d()},R=(e,t,n)=>{t.component=e;const i=e.vnode.props;e.vnode=t,e.next=null,function(e,t,n,i){const{props:o,attrs:s,vnode:{patchFlag:r}}=e,a=yt(o),[l]=e.propsOptions;let c=!1;if(!(i||r>0)||16&r){let i;ti(e,t,o,s)&&(c=!0);for(const s in a)t&&(p(t,s)||(i=W(s))!==s&&p(t,i))||(l?!n||void 0===n[s]&&void 0===n[i]||(o[s]=ni(l,a,s,void 0,e,!0)):delete o[s]);if(s!==a)for(const e in s)t&&p(t,e)||(delete s[e],c=!0)}else if(8&r){const n=e.vnode.dynamicProps;for(let i=0;i<n.length;i++){let r=n[i];if(Wi(e.emitsOptions,r))continue;const d=t[r];if(l)if(p(s,r))d!==s[r]&&(s[r]=d,c=!0);else{const t=D(r);o[t]=ni(l,a,t,d,e,!1)}else d!==s[r]&&(s[r]=d,c=!0)}}c&&Ee(e.attrs,"set","")}(e,t.props,i,n),gi(e,t.children,n),fe(),Kt(e),me()},N=(e,t,n,i,o,s,r,a,l=!1)=>{const c=e&&e.children,d=e?e.shapeFlag:0,h=t.children,{patchFlag:g,shapeFlag:p}=t;if(g>0){if(128&g)return void $(c,h,n,i,o,s,r,a,l);if(256&g)return void B(c,h,n,i,o,s,r,a,l)}8&p?(16&d&&J(c,o,s),h!==c&&u(n,h)):16&d?16&p?$(c,h,n,i,o,s,r,a,l):J(c,o,s,!0):(8&d&&u(n,""),16&p&&E(h,n,i,o,s,r,a,l))},B=(e,t,n,i,o,s,a,l,c)=>{t=t||r;const d=(e=e||r).length,u=t.length,h=Math.min(d,u);let g;for(g=0;g<h;g++){const i=t[g]=c?ao(t[g]):ro(t[g]);y(e[g],i,n,null,o,s,a,l,c)}d>u?J(e,o,s,!0,!1,h):E(t,n,i,o,s,a,l,c,h)},$=(e,t,n,i,o,s,a,l,c)=>{let d=0;const u=t.length;let h=e.length-1,g=u-1;for(;d<=h&&d<=g;){const i=e[d],r=t[d]=c?ao(t[d]):ro(t[d]);if(!Yi(i,r))break;y(i,r,n,null,o,s,a,l,c),d++}for(;d<=h&&d<=g;){const i=e[h],r=t[g]=c?ao(t[g]):ro(t[g]);if(!Yi(i,r))break;y(i,r,n,null,o,s,a,l,c),h--,g--}if(d>h){if(d<=g){const e=g+1,r=e<u?t[e].el:i;for(;d<=g;)y(null,t[d]=c?ao(t[d]):ro(t[d]),n,r,o,s,a,l,c),d++}}else if(d>g)for(;d<=h;)V(e[d],o,s,!0),d++;else{const p=d,f=d,m=new Map;for(d=f;d<=g;d++){const e=t[d]=c?ao(t[d]):ro(t[d]);null!=e.key&&m.set(e.key,d)}let v,w=0;const b=g-f+1;let k=!1,_=0;const x=new Array(b);for(d=0;d<b;d++)x[d]=0;for(d=p;d<=h;d++){const i=e[d];if(w>=b){V(i,o,s,!0);continue}let r;if(null!=i.key)r=m.get(i.key);else for(v=f;v<=g;v++)if(0===x[v-f]&&Yi(i,t[v])){r=v;break}void 0===r?V(i,o,s,!0):(x[r-f]=d+1,r>=_?_=r:k=!0,y(i,t[r],n,null,o,s,a,l,c),w++)}const S=k?function(e){const t=e.slice(),n=[0];let i,o,s,r,a;const l=e.length;for(i=0;i<l;i++){const l=e[i];if(0!==l){if(o=n[n.length-1],e[o]<l){t[i]=o,n.push(i);continue}for(s=0,r=n.length-1;s<r;)a=s+r>>1,e[n[a]]<l?s=a+1:r=a;l<e[n[s]]&&(s>0&&(t[i]=n[s-1]),n[s]=i)}}s=n.length,r=n[s-1];for(;s-- >0;)n[s]=r,r=t[r];return n}(x):r;for(v=S.length-1,d=b-1;d>=0;d--){const e=f+d,r=t[e],h=e+1<u?t[e+1].el:i;0===x[d]?y(null,r,n,h,o,s,a,l,c):k&&(v<0||d!==S[v]?G(r,n,h,2):v--)}}},G=(e,n,i,o,s=null)=>{const{el:r,type:a,transition:l,children:c,shapeFlag:d}=e;if(6&d)return void G(e.component.subTree,n,i,o);if(128&d)return void e.suspense.move(n,i,o);if(64&d)return void a.move(e,n,i,ee);if(a===Hi){t(r,n,i);for(let e=0;e<c.length;e++)G(c[e],n,i,o);return void t(e.anchor,n,i)}if(a===zi)return void k(e,n,i);if(2!==o&&1&d&&l)if(0===o)l.beforeEnter(r),t(r,n,i),mi((()=>l.enter(r)),s);else{const{leave:e,delayLeave:o,afterLeave:s}=l,a=()=>t(r,n,i),c=()=>{e(r,(()=>{a(),s&&s()}))};o?o(r,a,c):c()}else t(r,n,i)},V=(e,t,n,i=!1,o=!1)=>{const{type:s,props:r,ref:a,children:l,dynamicChildren:c,shapeFlag:d,patchFlag:u,dirs:h,cacheIndex:g}=e;if(-2===u&&(o=!1),null!=a&&pi(a,null,n,e,!0),null!=g&&(t.renderCache[g]=void 0),256&d)return void t.ctx.deactivate(e);const p=1&d&&h,f=!cn(e);let m;if(f&&(m=r&&r.onVnodeBeforeUnmount)&&co(m,t,e),6&d)X(e.component,n,i);else{if(128&d)return void e.suspense.unmount(n,i);p&&rn(e,null,t,"beforeUnmount"),64&d?e.type.remove(e,t,n,ee,i):c&&!c.hasOnce&&(s!==Hi||u>0&&64&u)?J(c,t,n,!1,!0):(s===Hi&&384&u||!o&&16&d)&&J(l,t,n),i&&q(e)}(f&&(m=r&&r.onVnodeUnmounted)||p)&&mi((()=>{m&&co(m,t,e),p&&rn(e,null,t,"unmounted")}),n)},q=e=>{const{type:t,el:i,anchor:o,transition:s}=e;if(t===Hi)return void K(i,o);if(t===zi)return void _(e);const r=()=>{n(i),s&&!s.persisted&&s.afterLeave&&s.afterLeave()};if(1&e.shapeFlag&&s&&!s.persisted){const{leave:t,delayLeave:n}=s,o=()=>t(i,r);n?n(e.el,r,o):o()}else r()},K=(e,t)=>{let i;for(;e!==t;)i=g(e),n(e),e=i;n(t)},X=(e,t,n)=>{const{bum:i,scope:o,update:s,subTree:r,um:a,m:l,a:c}=e;_i(l),_i(c),i&&j(i),o.stop(),s&&(s.active=!1,V(r,e,t,n)),a&&mi(a,t),mi((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},J=(e,t,n,i=!1,o=!1,s=0)=>{for(let r=s;r<e.length;r++)V(e[r],t,n,i,o)},Y=e=>{if(6&e.shapeFlag)return Y(e.component.subTree);if(128&e.shapeFlag)return e.suspense.next();const t=g(e.anchor||e.el),n=t&&t[fi];return n?g(n):t};let Z=!1;const Q=(e,t,n)=>{null==e?t._vnode&&V(t._vnode,null,null,!0):y(t._vnode||null,e,t,null,null,null,n),t._vnode=e,Z||(Z=!0,Kt(),Xt(),Z=!1)},ee={p:y,um:V,m:G,r:q,mt:L,mc:E,pc:N,pbc:P,n:Y,o:e};let te,ne;return{render:Q,hydrate:te,createApp:Kn(Q,te)}}(e)}function vi({type:e,props:t},n){return"svg"===n&&"foreignObject"===e||"mathml"===n&&"annotation-xml"===e&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function wi({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function bi(e,t,n=!1){const i=e.children,o=t.children;if(f(i)&&f(o))for(let s=0;s<i.length;s++){const e=i[s];let t=o[s];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=o[s]=ao(o[s]),t.el=e.el),n||-2===t.patchFlag||bi(e,t)),t.type===Ri&&(t.el=e.el)}}function ki(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:ki(t)}function _i(e){if(e)for(let t=0;t<e.length;t++)e[t].active=!1}const xi=Symbol.for("v-scx"),Si=()=>Jn(xi),Ci={};function Ti(e,t,n){return Ei(e,t,n)}function Ei(e,t,{immediate:n,deep:i,flush:o,once:r,onTrack:l,onTrigger:c}=s){if(t&&r){const e=t;t=(...t)=>{e(...t),T()}}const d=fo,u=e=>!0===i?e:Pi(e,!1===i?1:void 0);let g,p,m=!1,y=!1;if(St(e)?(g=()=>e.value,m=ft(e)):gt(e)?(g=()=>u(e),m=!0):f(e)?(y=!0,m=e.some((e=>gt(e)||ft(e))),g=()=>e.map((e=>St(e)?e.value:gt(e)?u(e):w(e)?Mt(e,d,2):void 0))):g=w(e)?t?()=>Mt(e,d,2):()=>(p&&p(),Wt(e,d,3,[b])):a,t&&i){const e=g;g=()=>Pi(e())}let v,b=e=>{p=S.onStop=()=>{Mt(e,d,4),p=S.onStop=void 0}};if(bo){if(b=a,t?n&&Wt(t,d,3,[g(),y?[]:void 0,b]):g(),"sync"!==o)return a;{const e=Si();v=e.__watcherHandles||(e.__watcherHandles=[])}}let k=y?new Array(e.length).fill(Ci):Ci;const _=()=>{if(S.active&&S.dirty)if(t){const e=S.run();(i||m||(y?e.some(((e,t)=>F(e,k[t]))):F(e,k)))&&(p&&p(),Wt(t,d,3,[e,k===Ci?void 0:y&&k[0]===Ci?[]:k,b]),k=e)}else S.run()};let x;_.allowRecurse=!!t,"sync"===o?x=_:"post"===o?x=()=>mi(_,d&&d.suspense):(_.pre=!0,d&&(_.id=d.uid),x=()=>Vt(_));const S=new le(g,a,x),C=ae(),T=()=>{S.stop(),C&&h(C.effects,S)};return t?n?_():k=S.run():"post"===o?mi(S.run.bind(S),d&&d.suspense):S.run(),v&&v.push(T),T}function Ii(e,t,n){const i=this.proxy,o=b(e)?e.includes(".")?Oi(i,e):()=>i[e]:e.bind(i,i);let s;w(t)?s=t:(s=t.handler,n=t);const r=mo(this),a=Ei(o,s.bind(i),n);return r(),a}function Oi(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}function Pi(e,t=1/0,n){if(t<=0||!_(e)||e.__v_skip)return e;if((n=n||new Set).has(e))return e;if(n.add(e),t--,St(e))Pi(e.value,t,n);else if(f(e))for(let i=0;i<e.length;i++)Pi(e[i],t,n);else if(y(e)||m(e))e.forEach((e=>{Pi(e,t,n)}));else if(E(e)){for(const i in e)Pi(e[i],t,n);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&Pi(e[i],t,n)}return e}const Ai=(e,t)=>"modelValue"===t||"model-value"===t?e.modelModifiers:e[`${t}Modifiers`]||e[`${D(t)}Modifiers`]||e[`${W(t)}Modifiers`];function Di(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||s;let o=n;const r=t.startsWith("update:"),a=r&&Ai(i,t.slice(7));let l;a&&(a.trim&&(o=n.map((e=>b(e)?e.trim():e))),a.number&&(o=n.map(R)));let c=i[l=L(t)]||i[l=L(D(t))];!c&&r&&(c=i[l=L(W(t))]),c&&Wt(c,e,6,o);const d=i[l+"Once"];if(d){if(e.emitted){if(e.emitted[l])return}else e.emitted={};e.emitted[l]=!0,Wt(d,e,6,o)}}function Mi(e,t,n=!1){const i=t.emitsCache,o=i.get(e);if(void 0!==o)return o;const s=e.emits;let r={},a=!1;if(!w(e)){const i=e=>{const n=Mi(e,t,!0);n&&(a=!0,u(r,n))};!n&&t.mixins.length&&t.mixins.forEach(i),e.extends&&i(e.extends),e.mixins&&e.mixins.forEach(i)}return s||a?(f(s)?s.forEach((e=>r[e]=null)):u(r,s),_(e)&&i.set(e,r),r):(_(e)&&i.set(e,null),null)}function Wi(e,t){return!(!e||!c(t))&&(t=t.slice(2).replace(/Once$/,""),p(e,t[0].toLowerCase()+t.slice(1))||p(e,W(t))||p(e,t))}function Ui(e){const{type:t,vnode:n,proxy:i,withProxy:o,propsOptions:[s],slots:r,attrs:a,emit:l,render:c,renderCache:u,props:h,data:g,setupState:p,ctx:f,inheritAttrs:m}=e,y=tn(e);let v,w;try{if(4&n.shapeFlag){const e=o||i,t=e;v=ro(c.call(t,e,u,h,p,g,f)),w=a}else{const e=t;0,v=ro(e.length>1?e(h,{attrs:a,slots:r,emit:l}):e(h,null)),w=t.props?a:Li(a)}}catch(k){Bi.length=0,Ut(k,e,1),v=to(Ni)}let b=v;if(w&&!1!==m){const e=Object.keys(w),{shapeFlag:t}=b;e.length&&7&t&&(s&&e.some(d)&&(w=Fi(w,s)),b=no(b,w,!1,!0))}return n.dirs&&(b=no(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&(b.transition=n.transition),v=b,tn(y),v}const Li=e=>{let t;for(const n in e)("class"===n||"style"===n||c(n))&&((t||(t={}))[n]=e[n]);return t},Fi=(e,t)=>{const n={};for(const i in e)d(i)&&i.slice(9)in t||(n[i]=e[i]);return n};function ji(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let o=0;o<i.length;o++){const s=i[o];if(t[s]!==e[s]&&!Wi(n,s))return!0}return!1}const Hi=Symbol.for("v-fgt"),Ri=Symbol.for("v-txt"),Ni=Symbol.for("v-cmt"),zi=Symbol.for("v-stc"),Bi=[];let $i=null;function Gi(e=!1){Bi.push($i=e?null:[])}let Vi=1;function qi(e){Vi+=e,e<0&&$i&&($i.hasOnce=!0)}function Ki(e){return e.dynamicChildren=Vi>0?$i||r:null,Bi.pop(),$i=Bi[Bi.length-1]||null,Vi>0&&$i&&$i.push(e),e}function Xi(e,t,n,i,o,s){return Ki(eo(e,t,n,i,o,s,!0))}function Ji(e,t,n,i,o){return Ki(to(e,t,n,i,o,!0))}function Yi(e,t){return e.type===t.type&&e.key===t.key}const Zi=({key:e})=>null!=e?e:null,Qi=({ref:e,ref_key:t,ref_for:n})=>("number"==typeof e&&(e=""+e),null!=e?b(e)||St(e)||w(e)?{i:Qt,r:e,k:t,f:!!n}:e:null);function eo(e,t=null,n=null,i=0,o=null,s=(e===Hi?0:1),r=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Zi(t),ref:t&&Qi(t),scopeId:en,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Qt};return a?(lo(l,n),128&s&&e.normalize(l)):n&&(l.shapeFlag|=b(n)?8:16),Vi>0&&!r&&$i&&(l.patchFlag>0||6&s)&&32!==l.patchFlag&&$i.push(l),l}const to=function(e,t=null,n=null,i=0,o=null,s=!1){e&&e!==En||(e=Ni);if(r=e,r&&!0===r.__v_isVNode){const i=no(e,t,!0);return n&&lo(i,n),Vi>0&&!s&&$i&&(6&i.shapeFlag?$i[$i.indexOf(e)]=i:$i.push(i)),i.patchFlag=-2,i}var r;(function(e){return w(e)&&"__vccOpts"in e})(e)&&(e=e.__vccOpts);if(t){t=function(e){return e?mt(e)||Qn(e)?u({},e):e:null}(t);let{class:e,style:n}=t;e&&!b(e)&&(t.class=K(e)),_(n)&&(mt(n)&&!f(n)&&(n=u({},n)),t.style=B(n))}const a=b(e)?1:(e=>e.__isSuspense)(e)?128:(e=>e.__isTeleport)(e)?64:_(e)?4:w(e)?2:0;return eo(e,t,n,i,o,a,s,!0)};function no(e,t,n=!1,i=!1){const{props:o,ref:s,patchFlag:r,children:a,transition:l}=e,d=t?function(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const e in i)if("class"===e)t.class!==i.class&&(t.class=K([t.class,i.class]));else if("style"===e)t.style=B([t.style,i.style]);else if(c(e)){const n=t[e],o=i[e];!o||n===o||f(n)&&n.includes(o)||(t[e]=n?[].concat(n,o):o)}else""!==e&&(t[e]=i[e])}return t}(o||{},t):o,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:d,key:d&&Zi(d),ref:t&&t.ref?n&&s?f(s)?s.concat(Qi(t)):[s,Qi(t)]:Qi(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Hi?-1===r?16:16|r:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&no(e.ssContent),ssFallback:e.ssFallback&&no(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&i&&an(u,l.clone(u)),u}function io(e=" ",t=0){return to(Ri,null,e,t)}function oo(e,t){const n=to(zi,null,e);return n.staticCount=t,n}function so(e="",t=!1){return t?(Gi(),Ji(Ni,null,e)):to(Ni,null,e)}function ro(e){return null==e||"boolean"==typeof e?to(Ni):f(e)?to(Hi,null,e.slice()):"object"==typeof e?ao(e):to(Ri,null,String(e))}function ao(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:no(e)}function lo(e,t){let n=0;const{shapeFlag:i}=e;if(null==t)t=null;else if(f(t))n=16;else if("object"==typeof t){if(65&i){const n=t.default;return void(n&&(n._c&&(n._d=!1),lo(e,n()),n._c&&(n._d=!0)))}{n=32;const i=t._;i||Qn(t)?3===i&&Qt&&(1===Qt.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=Qt}}else w(t)?(t={default:t,_ctx:Qt},n=32):(t=String(t),64&i?(n=16,t=[io(t)]):n=8);e.children=t,e.shapeFlag|=n}function co(e,t,n,i=null){Wt(e,t,7,[n,i])}const uo=Vn();let ho=0;let go,po,fo=null;{const e=z(),t=(t,n)=>{let i;return(i=e[t])||(i=e[t]=[]),i.push(n),e=>{i.length>1?i.forEach((t=>t(e))):i[0](e)}};go=t("__VUE_INSTANCE_SETTERS__",(e=>fo=e)),po=t("__VUE_SSR_SETTERS__",(e=>bo=e))}const mo=e=>{const t=fo;return go(e),e.scope.on(),()=>{e.scope.off(),go(t)}},yo=()=>{fo&&fo.scope.off(),go(null)};function vo(e){return 4&e.vnode.shapeFlag}let wo,bo=!1;function ko(e,t,n){w(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:_(t)&&(e.setupState=It(t)),_o(e,n)}function _o(e,t,n){const i=e.type;if(!e.render){if(!t&&wo&&!i.render){const t=i.template||jn(e).template;if(t){const{isCustomElement:n,compilerOptions:o}=e.appContext.config,{delimiters:s,compilerOptions:r}=i,a=u(u({isCustomElement:n,delimiters:s},o),r);i.render=wo(t,a)}}e.render=i.render||a}{const t=mo(e);fe();try{Un(e)}finally{me(),t()}}}const xo={get:(e,t)=>(Te(e,0,""),e[t])};function So(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(It(vt(e.exposed)),{get:(t,n)=>n in t?t[n]:n in Pn?Pn[n](e):void 0,has:(e,t)=>t in e||t in Pn})):e.proxy}const Co=(e,t)=>{const n=function(e,t,n=!1){let i,o;const s=w(e);return s?(i=e,o=a):(i=e.get,o=e.set),new kt(i,o,s||!o,n)}(e,0,bo);return n},To="3.4.38",Eo="undefined"!=typeof document?document:null,Io=Eo&&Eo.createElement("template"),Oo={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const o="svg"===t?Eo.createElementNS("http://www.w3.org/2000/svg",e):"mathml"===t?Eo.createElementNS("http://www.w3.org/1998/Math/MathML",e):n?Eo.createElement(e,{is:n}):Eo.createElement(e);return"select"===e&&i&&null!=i.multiple&&o.setAttribute("multiple",i.multiple),o},createText:e=>Eo.createTextNode(e),createComment:e=>Eo.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Eo.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,i,o,s){const r=n?n.previousSibling:t.lastChild;if(o&&(o===s||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),o!==s&&(o=o.nextSibling););else{Io.innerHTML="svg"===i?`<svg>${e}</svg>`:"mathml"===i?`<math>${e}</math>`:e;const o=Io.content;if("svg"===i||"mathml"===i){const e=o.firstChild;for(;e.firstChild;)o.appendChild(e.firstChild);o.removeChild(e)}t.insertBefore(o,n)}return[r?r.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Po=Symbol("_vtc");const Ao=Symbol("_vod"),Do=Symbol("_vsh"),Mo=Symbol(""),Wo=/(^|;)\s*display\s*:/;const Uo=/\s*!important$/;function Lo(e,t,n){if(f(n))n.forEach((n=>Lo(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=function(e,t){const n=jo[t];if(n)return n;let i=D(t);if("filter"!==i&&i in e)return jo[t]=i;i=U(i);for(let o=0;o<Fo.length;o++){const n=Fo[o]+i;if(n in e)return jo[t]=n}return t}(e,t);Uo.test(n)?e.setProperty(W(i),n.replace(Uo,""),"important"):e[i]=n}}const Fo=["Webkit","Moz","ms"],jo={};const Ho="http://www.w3.org/1999/xlink";function Ro(e,t,n,i,o,s=X(t)){i&&t.startsWith("xlink:")?null==n?e.removeAttributeNS(Ho,t.slice(6,t.length)):e.setAttributeNS(Ho,t,n):null==n||s&&!J(n)?e.removeAttribute(t):e.setAttribute(t,s?"":k(n)?String(n):n)}function No(e,t,n,i){e.addEventListener(t,n,i)}const zo=Symbol("_vei");function Bo(e,t,n,i,o=null){const s=e[zo]||(e[zo]={}),r=s[t];if(i&&r)r.value=i;else{const[n,a]=function(e){let t;if($o.test(e)){let n;for(t={};n=e.match($o);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}const n=":"===e[2]?e.slice(3):W(e.slice(2));return[n,t]}(t);if(i){const r=s[t]=function(e,t){const n=e=>{if(e._vts){if(e._vts<=n.attached)return}else e._vts=Date.now();Wt(function(e,t){if(f(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}(e,n.value),t,5,[e])};return n.value=e,n.attached=qo(),n}(i,o);No(e,n,r,a)}else r&&(!function(e,t,n,i){e.removeEventListener(t,n,i)}(e,n,r,a),s[t]=void 0)}}const $o=/(?:Once|Passive|Capture)$/;let Go=0;const Vo=Promise.resolve(),qo=()=>Go||(Vo.then((()=>Go=0)),Go=Date.now());const Ko=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123;const Xo=e=>{const t=e.props["onUpdate:modelValue"]||!1;return f(t)?e=>j(t,e):t};function Jo(e){e.target.composing=!0}function Yo(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Zo=Symbol("_assign"),Qo={created(e,{modifiers:{lazy:t,trim:n,number:i}},o){e[Zo]=Xo(o);const s=i||o.props&&"number"===o.props.type;No(e,t?"change":"input",(t=>{if(t.target.composing)return;let i=e.value;n&&(i=i.trim()),s&&(i=R(i)),e[Zo](i)})),n&&No(e,"change",(()=>{e.value=e.value.trim()})),t||(No(e,"compositionstart",Jo),No(e,"compositionend",Yo),No(e,"change",Yo))},mounted(e,{value:t}){e.value=null==t?"":t},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:i,trim:o,number:s}},r){if(e[Zo]=Xo(r),e.composing)return;const a=null==t?"":t;if((!s&&"number"!==e.type||/^0\d/.test(e.value)?e.value:R(e.value))!==a){if(document.activeElement===e&&"range"!==e.type){if(i&&t===n)return;if(o&&e.value.trim()===a)return}e.value=a}}},es={deep:!0,created(e,{value:t,modifiers:{number:n}},i){const o=y(t);No(e,"change",(()=>{const t=Array.prototype.filter.call(e.options,(e=>e.selected)).map((e=>n?R(ns(e)):ns(e)));e[Zo](e.multiple?o?new Set(t):t:t[0]),e._assigning=!0,Gt((()=>{e._assigning=!1}))})),e[Zo]=Xo(i)},mounted(e,{value:t,modifiers:{number:n}}){ts(e,t)},beforeUpdate(e,t,n){e[Zo]=Xo(n)},updated(e,{value:t,modifiers:{number:n}}){e._assigning||ts(e,t)}};function ts(e,t,n){const i=e.multiple,o=f(t);if(!i||o||y(t)){for(let n=0,s=e.options.length;n<s;n++){const s=e.options[n],r=ns(s);if(i)if(o){const e=typeof r;s.selected="string"===e||"number"===e?t.some((e=>String(e)===String(r))):Z(t,r)>-1}else s.selected=t.has(r);else if(Y(ns(s),t))return void(e.selectedIndex!==n&&(e.selectedIndex=n))}i||-1===e.selectedIndex||(e.selectedIndex=-1)}}function ns(e){return"_value"in e?e._value:e.value}const is=u({patchProp:(e,t,n,i,o,s)=>{const r="svg"===o;"class"===t?function(e,t,n){const i=e[Po];i&&(t=(t?[t,...i]:[...i]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}(e,i,r):"style"===t?function(e,t,n){const i=e.style,o=b(n);let s=!1;if(n&&!o){if(t)if(b(t))for(const e of t.split(";")){const t=e.slice(0,e.indexOf(":")).trim();null==n[t]&&Lo(i,t,"")}else for(const e in t)null==n[e]&&Lo(i,e,"");for(const e in n)"display"===e&&(s=!0),Lo(i,e,n[e])}else if(o){if(t!==n){const e=i[Mo];e&&(n+=";"+e),i.cssText=n,s=Wo.test(n)}}else t&&e.removeAttribute("style");Ao in e&&(e[Ao]=s?i.display:"",e[Do]&&(i.display="none"))}(e,n,i):c(t)?d(t)||Bo(e,t,0,i,s):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,n,i){if(i)return"innerHTML"===t||"textContent"===t||!!(t in e&&Ko(t)&&w(n));if("spellcheck"===t||"draggable"===t||"translate"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if("width"===t||"height"===t){const t=e.tagName;if("IMG"===t||"VIDEO"===t||"CANVAS"===t||"SOURCE"===t)return!1}if(Ko(t)&&b(n))return!1;return t in e}(e,t,i,r))?(!function(e,t,n){if("innerHTML"===t||"textContent"===t){if(null==n)return;return void(e[t]=n)}const i=e.tagName;if("value"===t&&"PROGRESS"!==i&&!i.includes("-")){const o="OPTION"===i?e.getAttribute("value")||"":e.value,s=null==n?"":String(n);return o===s&&"_value"in e||(e.value=s),null==n&&e.removeAttribute(t),void(e._value=n)}let o=!1;if(""===n||null==n){const i=typeof e[t];"boolean"===i?n=J(n):null==n&&"string"===i?(n="",o=!0):"number"===i&&(n=0,o=!0)}try{e[t]=n}catch(s){}o&&e.removeAttribute(t)}(e,t,i),e.tagName.includes("-")||"value"!==t&&"checked"!==t&&"selected"!==t||Ro(e,t,i,r,0,"value"!==t)):("true-value"===t?e._trueValue=i:"false-value"===t&&(e._falseValue=i),Ro(e,t,i,r))}},Oo);let os;const ss=(...e)=>{const t=(os||(os=yi(is))).createApp(...e),{mount:n}=t;return t.mount=e=>{const i=function(e){if(b(e)){return document.querySelector(e)}return e}(e);if(!i)return;const o=t._component;w(o)||o.render||o.template||(o.template=i.innerHTML),i.innerHTML="";const s=n(i,!1,function(e){if(e instanceof SVGElement)return"svg";if("function"==typeof MathMLElement&&e instanceof MathMLElement)return"mathml"}(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),s},t};var rs=!1;
/*!
   * pinia v2.3.1
   * (c) 2025 Eduardo San Martin Morote
   * @license MIT
   */let as;const ls=e=>as=e,cs=Symbol();function ds(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var us,hs;(hs=us||(us={})).direct="direct",hs.patchObject="patch object",hs.patchFunction="patch function";const gs=()=>{};function ps(e,t,n,i=gs){e.push(t);const o=()=>{const n=e.indexOf(t);n>-1&&(e.splice(n,1),i())};var s;return!n&&ae()&&(s=o,ie&&ie.cleanups.push(s)),o}function fs(e,...t){e.slice().forEach((e=>{e(...t)}))}const ms=e=>e(),ys=Symbol(),vs=Symbol();function ws(e,t){e instanceof Map&&t instanceof Map?t.forEach(((t,n)=>e.set(n,t))):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const i=t[n],o=e[n];ds(o)&&ds(i)&&e.hasOwnProperty(n)&&!St(i)&&!gt(i)?e[n]=ws(o,i):e[n]=i}return e}const bs=Symbol();const{assign:ks}=Object;function _s(e,t,n,i){const{state:o,actions:s,getters:r}=t,a=n.state.value[e];let l;return l=xs(e,(function(){a||(n.state.value[e]=o?o():{});const t=function(e){const t=f(e)?new Array(e.length):{};for(const n in e)t[n]=Dt(e,n);return t}(n.state.value[e]);return ks(t,s,Object.keys(r||{}).reduce(((t,i)=>(t[i]=vt(Co((()=>{ls(n);const t=n._s.get(e);return r[i].call(t,t)}))),t)),{}))}),t,n,i,!0),l}function xs(e,t,n={},i,o,s){let r;const a=ks({actions:{}},n),l={deep:!0};let c,d,u,h=[],g=[];const p=i.state.value[e];let f;function m(t){let n;c=d=!1,"function"==typeof t?(t(i.state.value[e]),n={type:us.patchFunction,storeId:e,events:u}):(ws(i.state.value[e],t),n={type:us.patchObject,payload:t,storeId:e,events:u});const o=f=Symbol();Gt().then((()=>{f===o&&(c=!0)})),d=!0,fs(h,n,i.state.value[e])}s||p||(i.state.value[e]={}),Ct({});const y=s?function(){const{state:e}=n,t=e?e():{};this.$patch((e=>{ks(e,t)}))}:gs;const v=(t,n="")=>{if(ys in t)return t[vs]=n,t;const o=function(){ls(i);const n=Array.from(arguments),s=[],r=[];let a;fs(g,{args:n,name:o[vs],store:w,after:function(e){s.push(e)},onError:function(e){r.push(e)}});try{a=t.apply(this&&this.$id===e?this:w,n)}catch(l){throw fs(r,l),l}return a instanceof Promise?a.then((e=>(fs(s,e),e))).catch((e=>(fs(r,e),Promise.reject(e)))):(fs(s,a),a)};return o[ys]=!0,o[vs]=n,o},w=dt({_p:i,$id:e,$onAction:ps.bind(null,g),$patch:m,$reset:y,$subscribe(t,n={}){const o=ps(h,t,n.detached,(()=>s())),s=r.run((()=>Ti((()=>i.state.value[e]),(i=>{("sync"===n.flush?d:c)&&t({storeId:e,type:us.direct,events:u},i)}),ks({},l,n))));return o},$dispose:function(){r.stop(),h=[],g=[],i._s.delete(e)}});i._s.set(e,w);const b=(i._a&&i._a.runWithContext||ms)((()=>i._e.run((()=>(r=re()).run((()=>t({action:v})))))));for(const x in b){const t=b[x];if(St(t)&&(!St(_=t)||!_.effect)||gt(t))s||(!p||ds(k=t)&&k.hasOwnProperty(bs)||(St(t)?t.value=p[x]:ws(t,p[x])),i.state.value[e][x]=t);else if("function"==typeof t){const e=v(t,x);b[x]=e,a.actions[x]=t}}var k,_;return ks(w,b),ks(yt(w),b),Object.defineProperty(w,"$state",{get:()=>i.state.value[e],set:e=>{m((t=>{ks(t,e)}))}}),i._p.forEach((e=>{ks(w,r.run((()=>e({store:w,app:i._a,pinia:i,options:a}))))})),p&&s&&n.hydrate&&n.hydrate(w.$state,p),c=!0,d=!0,w}
/*! #__NO_SIDE_EFFECTS__ */function Ss(e,t,n){let i,o;const s="function"==typeof t;function r(e,n){(e=e||(!!(fo||Qt||Xn)?Jn(cs,null):null))&&ls(e),(e=as)._s.has(i)||(s?xs(i,t,o,e):_s(i,o,e));return e._s.get(i)}return"string"==typeof e?(i=e,o=s?n:t):(o=e,i=e.id),r.$id=i,r}function Cs(e){{const t=yt(e),n={};for(const i in t){const o=t[i];o.effect?n[i]=Co({get:()=>e[i],set(t){e[i]=t}}):(St(o)||gt(o))&&(n[i]=At(e,i))}return n}}class Ts{constructor(){n(this,"apiKey",""),n(this,"baseUrl",""),n(this,"isProduction",!0),n(this,"configInitialized",!1)}initializeConfig(){if(!this.configInitialized){if(!window.WIDGET_CONFIG)throw new Error("Chat Widget configuration not found");if(this.apiKey=window.WIDGET_CONFIG.apiKey,this.baseUrl=window.WIDGET_CONFIG.baseUrlWs,this.isProduction=!window.WIDGET_CONFIG.isProduction||window.WIDGET_CONFIG.isProduction,this.isProduction&&(console.log("IS PRODUCTION!!!"),this.baseUrl=this.baseUrl.replace("ws://","wss://"),console.log("BASE URL WS : ",this.baseUrl)),!this.apiKey)throw new Error("API key is required");this.configInitialized=!0}}getHeaders(){return this.initializeConfig(),{"X-Api-Key":this.apiKey,"Content-Type":"application/json",Accept:"application/json"}}getBaseUrl(){return this.initializeConfig(),this.baseUrl}getApiKeyHeader(){return this.initializeConfig(),this.apiKey}getMultipartHeaders(){return this.initializeConfig(),{"X-Api-Key":this.apiKey}}handleError(e,t){var n,i;console.error("WS Error:",e);const o=(null==(i=null==(n=null==e?void 0:e.response)?void 0:n.data)?void 0:i.message)??(null==e?void 0:e.message)??t;throw new Error(o)}}var Es=(e=>(e.CHAT="chat_message",e.TYPING="typing_indicator",e.NOTIFICATION="notification",e.TICKET_UPDATE="ticket_update",e.NOTIFICATION_COUNT="notification_count",e.SYSTEM="system",e.USER_STATUS="user_status",e))(Es||{});const Is=class e extends Ts{constructor(){super(),n(this,"ws",null),n(this,"messageCallbacks",new Map),n(this,"statusCallbacks",[]),n(this,"reconnectAttempts",0),n(this,"maxReconnectAttempts",5),n(this,"reconnectTimeout",null),this.messageCallbacks.set("chat_message",[]),this.messageCallbacks.set("typing_indicator",[]),this.messageCallbacks.set("notification",[]),this.messageCallbacks.set("ticket_update",[]),this.messageCallbacks.set("system",[]),this.messageCallbacks.set("notification_count",[])}static getInstance(){return e.instance||(e.instance=new e),e.instance}initializeConnection(){return new Promise(((e,t)=>{var n;if((null==(n=this.ws)?void 0:n.readyState)===WebSocket.OPEN)return console.log("WebSocket already connected"),void e();const i=this.getApiKeyHeader(),o=`${this.getBaseUrl()}/ws/admin?api_key=${i}`;this.ws=new WebSocket(o),this.ws.onopen=()=>{console.log("WebSocket connected for admin interface"),this.reconnectAttempts=0,this.notifyStatusChange(!0),e()},this.ws.onerror=e=>{console.error("WebSocket error:",e),this.notifyStatusChange(!1),t(e)},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);if(console.log("[WS] Received WebSocket message:",t),t.type&&this.messageCallbacks.has(t.type)){(this.messageCallbacks.get(t.type)||[]).forEach((e=>e(t)))}else this.notifyMessageCallbacks("system",t)}catch(t){console.error("Error parsing WebSocket message:",t)}},this.ws.onclose=()=>{console.log("WebSocket disconnected"),this.notifyStatusChange(!1),this.attemptReconnect()}}))}attemptReconnect(){if(this.reconnectAttempts<this.maxReconnectAttempts){this.reconnectAttempts++;const e=Math.min(1e3*Math.pow(2,this.reconnectAttempts),3e4);this.reconnectTimeout=window.setTimeout((()=>{console.log(`Attempting to reconnect (${this.reconnectAttempts}/${this.maxReconnectAttempts})`),this.initializeConnection().catch(console.error)}),e)}}sendMessage(e){return this.sendWebSocketMessage(e)}sendTypingIndicator(e){return this.sendWebSocketMessage(e)}sendUserStatus(e){return this.sendWebSocketMessage(e)}sendHeartbeat(e){return this.sendWebSocketMessage(e)}sendWebSocketMessage(e){return new Promise(((t,n)=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN)try{this.ws.send(JSON.stringify({...e,timestamp:(new Date).toISOString()})),t()}catch(i){n(i)}else n(new Error("WebSocket is not connected"))}))}onMessage(e,t){this.messageCallbacks.has(e)||this.messageCallbacks.set(e,[]);const n=this.messageCallbacks.get(e)||[];n.push(t),this.messageCallbacks.set(e,n)}onStatusChange(e){this.statusCallbacks.push(e)}notifyMessageCallbacks(e,t){(this.messageCallbacks.get(e)||[]).forEach((e=>e(t)))}notifyStatusChange(e){this.statusCallbacks.forEach((t=>t(e)))}sendTypingStatus(e,t){return this.sendWebSocketMessage({type:"typing_indicator",code:t,is_typing:e,role:"cs",sender_id:""})}disconnect(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.ws&&(this.ws.close(),this.ws=null),this.statusCallbacks=[],this.reconnectAttempts=0}};n(Is,"instance",null);let Os=Is;class Ps{constructor(){n(this,"apiKey",""),n(this,"baseUrl",""),n(this,"isProduction",!0),n(this,"configInitialized",!1)}initializeConfig(){if(!this.configInitialized){if(!window.WIDGET_CONFIG)throw new Error("Chat Widget configuration not found");if(this.apiKey=window.WIDGET_CONFIG.apiKey,this.baseUrl=window.WIDGET_CONFIG.baseUrlApi,this.isProduction=!window.WIDGET_CONFIG.isProduction||window.WIDGET_CONFIG.isProduction,this.isProduction&&(console.log("IS PRODUCTION!!!"),this.baseUrl=this.baseUrl.replace("http://","https://"),console.log("BASE URL API : ",this.baseUrl)),!this.apiKey)throw new Error("API key is required");this.configInitialized=!0}}getHeaders(){return this.initializeConfig(),{"X-Api-Key":this.apiKey,"Content-Type":"application/json",Accept:"application/json"}}getMultipartHeaders(){return this.initializeConfig(),{"X-Api-Key":this.apiKey}}getBaseUrl(){return this.initializeConfig(),this.baseUrl}handleError(e,t){var n,i;console.error("API Error:",e);const o=(null==(i=null==(n=null==e?void 0:e.response)?void 0:n.data)?void 0:i.message)??(null==e?void 0:e.message)??t;throw new Error(o)}}const As=class e{static setSecurityConfig(t){e.securityConfig={...e.securityConfig,...t}}static getSecurityConfig(){return{...e.securityConfig}}static getWidgetDomains(){return[...e.widgetDomains]}static addWidgetDomain(t){e.widgetDomains.includes(t)||(e.widgetDomains.push(t),this.log(`Added widget domain: ${t}`))}static removeWidgetDomain(t){const n=e.widgetDomains.indexOf(t);n>-1&&(e.widgetDomains.splice(n,1),this.log(`Removed widget domain: ${t}`))}static isWidgetDomain(t){return!(!t||"string"!=typeof t)&&e.widgetDomains.some((e=>t.includes(e)))}static log(e,t){this.securityConfig.logSecurityEvents&&console.log(`[SafeSecureFetch] ${e}`,t||"")}static error(e,t){console.error(`[SafeSecureFetch] ${e}`,t||"")}static emitSecurityEvent(e,t,n){const i={type:e,data:t,timestamp:(new Date).toISOString(),domain:n||"unknown"};"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("fetch-security-event",{detail:i})),this.log(`Security Event: ${e}`,{...t,domain:n})}static sanitizeURL(e){if(!e||"string"!=typeof e)return e;let t=e.trim();if(t.startsWith("data:")||t.startsWith("blob:")||t.startsWith("javascript:")||t.startsWith("//"))return t;if(this.securityConfig.widgetDomainsOnly&&!this.isWidgetDomain(t))return t;if(this.securityConfig.enforceHTTPS){if(t.match(/^http:\/\//i)){const n=t.replace(/^http:\/\//i,"https://");return this.log("URL upgraded to HTTPS:",{original:e,sanitized:n}),this.emitSecurityEvent("url_https_upgrade",{original:e,sanitized:n,reason:this.isWidgetDomain(e)?"widget_domain":"global_policy"},this.extractDomain(e)),n}const n=t.replace(/([^s])http:\/\//gi,"$1https://");if(n!==t)return this.log("Embedded HTTP URLs upgraded:",{original:t,processed:n}),this.emitSecurityEvent("embedded_http_upgrade",{original:t,processed:n},this.extractDomain(t)),n}return t}static extractDomain(e){try{return new URL(e).hostname}catch{return"invalid-url"}}static async validateSecureContext(e){if((!this.securityConfig.widgetDomainsOnly||this.isWidgetDomain(e))&&"undefined"!=typeof window){if(("https:"===window.location.protocol||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)&&e.startsWith("http://")){const t=this.extractDomain(e),n=this.isWidgetDomain(e);if(this.error(`Potential mixed content: HTTPS page requesting HTTP resource: ${e}`),this.emitSecurityEvent("mixed_content_warning",{pageProtocol:window.location.protocol,requestUrl:e,hostname:window.location.hostname,isWidgetDomain:n},t),!this.securityConfig.enforceHTTPS)throw new Error(`Mixed content blocked: Cannot load HTTP resource from HTTPS page: ${e}`)}if(this.isWidgetDomain(e)){e.startsWith("https://")||this.emitSecurityEvent("widget_insecure_request",{url:e,protocol:e.startsWith("http://")?"http":"unknown"},this.extractDomain(e))}}}static isSecurityError(e){var t,n,i;if(!e)return!1;const o=(e.message||"").toLowerCase(),s=["mixed content","blocked by cors","insecure","ssl","tls","certificate","https required","upgrade required","security policy","net::err_ssl","net::err_cert","refused to connect"],r=s.some((e=>o.includes(e)))||426===(null==(t=e.response)?void 0:t.status)||400===(null==(n=e.response)?void 0:n.status)&&o.includes("mixed");return r&&this.emitSecurityEvent("security_error_detected",{error:e.message,status:null==(i=e.response)?void 0:i.status,keywords:s.filter((e=>o.includes(e)))}),r}static async customFetch(e,t={}){var n,i,o,s,r;try{const r="undefined"==typeof window||((null==(n=window.WIDGET_CONFIG)?void 0:n.isProduction)??!0),l="undefined"!=typeof window&&("https:"===window.location.protocol||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname),c=this.isWidgetDomain(e),d=this.extractDomain(e);this.log("Fetch request initiated:",{originalUrl:e,isProduction:r,isSecureContext:l,method:t.method||"GET",isWidgetDomain:c,domain:d});const u=this.sanitizeURL(e);await this.validateSecureContext(u);let h=u;if(r&&c){const t=h;h=h.replace(/^http:\/\//i,"https://"),h=h.replace(/([^s])http:\/\//gi,"$1https://"),t!==h&&(this.log("Production URL processing (widget domain):",{original:e,sanitized:u,final:h}),this.emitSecurityEvent("production_url_processing",{original:e,before:t,final:h,reason:"widget_domain_production"},d))}const g=!this.securityConfig.widgetDomainsOnly||c,p={...t,headers:{"Content-Type":"application/json",...g?{"X-Requested-With":"XMLHttpRequest","Cache-Control":"no-cache","X-CSRF-Protection":"1"}:{},...t.headers||{}},credentials:t.credentials||"same-origin",...t.integrity?{integrity:t.integrity}:{},signal:t.signal||(c&&AbortSignal.timeout?AbortSignal.timeout(3e4):void 0)};this.log("Making secure fetch request:",{url:h,method:p.method||"GET",hasAuth:!!(null==(i=p.headers)?void 0:i.Authorization)||!!(null==(o=p.headers)?void 0:o["X-Api-Key"]),isWidgetDomain:c,securityApplied:g});const f=await fetch(h,p);if(!f.ok){let t={};try{t=await f.json()}catch(a){t={message:`HTTP ${f.status}: ${f.statusText}`,status:f.status,statusText:f.statusText}}!c&&this.securityConfig.widgetDomainsOnly||(426===f.status?(this.error("Upgrade Required - Server requires HTTPS"),this.emitSecurityEvent("server_requires_https",{url:h,status:f.status,isWidgetDomain:c},d)):400===f.status&&(null==(s=t.message)?void 0:s.includes("mixed content"))?(this.error("Mixed content error detected"),this.emitSecurityEvent("mixed_content_error",{url:h,error:t.message,isWidgetDomain:c},d)):403===f.status?this.emitSecurityEvent("forbidden_access",{url:h,status:f.status,isWidgetDomain:c},d):f.status>=500&&this.emitSecurityEvent("server_error",{url:h,status:f.status,statusText:f.statusText,isWidgetDomain:c},d));throw{response:{_data:t,status:f.status,statusText:f.statusText,headers:Object.fromEntries(f.headers.entries())},message:t.message||`Request failed with status ${f.status}`,url:h,originalUrl:e,isWidgetDomain:c,securityRelated:this.isSecurityError(t)}}const m=f.headers.get("content-type"),y=f.headers.get("content-length");return this.log("Fetch request successful:",{url:h,status:f.status,contentType:m,contentLength:y?parseInt(y):void 0,isSecure:h.startsWith("https://"),isWidgetDomain:c}),this.emitSecurityEvent("fetch_success",{url:h,originalUrl:e,status:f.status,isSecure:h.startsWith("https://"),isWidgetDomain:c,contentType:m},d),await f.json()}catch(l){const t=this.isSecurityError(l),n=this.isWidgetDomain(e),i=this.extractDomain(e);throw this.error("Request failed:",{originalUrl:e,finalUrl:this.sanitizeURL(e),error:l.message||l,isSecurityRelated:t,isWidgetDomain:n,timestamp:(new Date).toISOString(),stack:null==(r=l.stack)?void 0:r.split("\n").slice(0,3)}),t&&(this.error("Security Error Detected - Recommended Actions:"),n?(this.error("1. Ensure widget API URLs use HTTPS"),this.error("2. Check widget server CORS configuration"),this.error("3. Verify SSL certificate validity for widget domain")):(this.error("1. Check third-party service configuration"),this.error("2. Verify external API security requirements")),this.error('4. Consider adding CSP meta tag: <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">'),this.emitSecurityEvent("security_error_with_guidance",{originalUrl:e,error:l.message,isWidgetDomain:n,recommendations:n?["Ensure widget API URLs use HTTPS","Check widget server CORS configuration","Verify SSL certificate validity for widget domain","Add CSP meta tag for automatic HTTPS upgrade"]:["Check third-party service configuration","Verify external API security requirements","Review CORS and SSL settings"]},i)),l}}static async testSecureConnection(e){const t=[];let n,i=!1,o=!1;const s=this.isWidgetDomain(e),r=this.extractDomain(e);try{const n=e.replace(/^http:\/\//i,"https://");this.log("Testing secure connection:",{baseUrl:e,httpsUrl:n,isWidgetDomain:s});const a=await fetch(n,{method:"HEAD",mode:"no-cors",cache:"no-cache",signal:AbortSignal.timeout?AbortSignal.timeout(1e4):void 0});i=!0,o=!0,this.log("HTTPS connection test successful:",{url:n,status:a.status,isWidgetDomain:s}),this.emitSecurityEvent("connection_test_success",{baseUrl:e,httpsUrl:n,status:a.status,isWidgetDomain:s},r),e.startsWith("http://")?s?(t.push(" HTTPS is supported for widget - consider updating default URLs to use HTTPS"),t.push(" Widget server accepts secure connections")):(t.push(" HTTPS is supported - this third-party service can use secure connections"),t.push(" Note: This is not a widget domain - security policies may differ")):t.push(" Already using HTTPS - excellent security posture")}catch(l){n=l.message,i=!1,o=!1,this.error("Connection test failed:",{baseUrl:e,error:l.message,isWidgetDomain:s}),this.emitSecurityEvent("connection_test_failed",{baseUrl:e,error:l.message,errorType:l.name,isWidgetDomain:s},r),e.startsWith("http://")&&(s?(t.push(" HTTP detected for widget domain - this may cause mixed content issues"),t.push(" Widget will auto-upgrade HTTP to HTTPS"),t.push(" Or update widget API endpoints to use HTTPS"),t.push(" Contact widget server administrator to enable HTTPS support")):(t.push(" HTTP detected for third-party service"),t.push(" Note: Widget security policies don't apply to this domain"),t.push(" Check third-party service security requirements"))),"undefined"!=typeof window&&"https:"===window.location.protocol&&(t.push(" Page is HTTPS but requested URL is HTTP - this causes mixed content blocking"),s?t.push(" Widget will handle HTTPS upgrade automatically"):t.push(" Third-party service may need manual HTTPS configuration"),t.push(" Long-term fix: Update all APIs to support HTTPS")),l.message.includes("net::ERR_SSL")?(t.push(" SSL certificate issue detected"),t.push(" Check certificate validity and configuration")):l.message.includes("CORS")&&(t.push(" CORS configuration may need adjustment"),s?t.push(" Ensure widget server allows cross-origin HTTPS requests"):t.push(" Check third-party service CORS settings"))}const a={success:o,httpsSupported:i,error:n,recommendations:t,isWidgetDomain:s};return this.log("Connection test completed:",a),a}static getSecurityStatus(){const e="undefined"!=typeof window&&("https:"===window.location.protocol||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname),t="undefined"!=typeof window?window.location.protocol:"unknown",n=[];if(e||(n.push(" Page is not served over HTTPS"),n.push(" Consider enabling HTTPS for better security")),"undefined"!=typeof window){!!document.querySelector('meta[http-equiv="Content-Security-Policy"]')||n.push(" Consider adding CSP meta tag for enhanced security")}return this.securityConfig.widgetDomainsOnly?(n.push(" Safe mode enabled - security measures only apply to widget domains"),n.push(` Protected domains: ${this.widgetDomains.join(", ")}`)):(n.push(" Global mode enabled - security measures apply to all requests"),n.push(" Consider enabling widgetDomainsOnly for safer operation")),{isSecureContext:e,protocol:t,securityConfig:this.getSecurityConfig(),widgetDomains:this.getWidgetDomains(),recommendations:n}}static setSecurityLogging(e){this.securityConfig.logSecurityEvents=e,this.log("Security logging "+(e?"enabled":"disabled"))}static setWidgetDomainsOnly(e){this.securityConfig.widgetDomainsOnly=e,this.log("Widget domains only mode "+(e?"enabled":"disabled")),e?this.log("Safe mode: Security measures will only apply to widget domains:",this.widgetDomains):this.log("Global mode: Security measures will apply to all requests")}static getSecurityEventHistory(){return[]}};n(As,"securityConfig",{enforceHTTPS:!0,logSecurityEvents:!0,validateCertificates:!0,widgetDomainsOnly:!0}),n(As,"widgetDomains",["cappuccino-api.bsa.id","cappucino-api.bsa.id","cappuccino.bsa.id","cappucino.bsa.id"]);let Ds=As;const Ms=Ds.customFetch.bind(Ds);Ds.testSecureConnection.bind(Ds),Ds.getSecurityStatus.bind(Ds),Ds.setSecurityConfig.bind(Ds),Ds.setSecurityLogging.bind(Ds),Ds.setWidgetDomainsOnly.bind(Ds),Ds.addWidgetDomain.bind(Ds),Ds.removeWidgetDomain.bind(Ds),Ds.isWidgetDomain.bind(Ds),Ds.getWidgetDomains.bind(Ds);const Ws=new class extends Ps{async getProfile(){var e,t;try{return await Ms(`${this.getBaseUrl()}/api/v1/profile/`,{method:"GET",headers:this.getHeaders()})}catch(n){throw console.error("Error fetching profile:",n),(null==(t=null==(e=null==n?void 0:n.response)?void 0:e._data)?void 0:t.message)??"Failed to fetch profile"}}async updateProfile(e){var t,n;try{return await Ms(`${this.getBaseUrl()}/api/v1/profile/`,{method:"PUT",body:JSON.stringify(e),headers:this.getHeaders()})}catch(i){throw console.error("Error updating profile:",i),(null==(n=null==(t=null==i?void 0:i.response)?void 0:t._data)?void 0:n.message)??"Failed to update profile"}}async updateStatus(e){var t,n;try{return await Ms(`${this.getBaseUrl()}/api/v1/profile/status`,{method:"PUT",body:JSON.stringify(e),headers:this.getHeaders()})}catch(i){throw console.error("Error updating status:",i),(null==(n=null==(t=null==i?void 0:i.response)?void 0:t._data)?void 0:n.message)??"Failed to update status"}}async uploadAvatar(e){var t,n;try{const t=this.getMultipartHeaders();return await fetch(`${this.getBaseUrl()}/api/v1/profile/avatar`,{method:"POST",body:e,headers:t}).then((e=>{if(!e.ok)throw new Error("Failed to upload avatar");return e.json()}))}catch(i){throw console.error("Error uploading avatar:",i),(null==(n=null==(t=null==i?void 0:i.response)?void 0:t._data)?void 0:n.message)??"Failed to upload avatar"}}async removeAvatar(){var e,t;try{return await Ms(`${this.getBaseUrl()}/api/v1/profile/avatar`,{method:"DELETE",headers:this.getHeaders()})}catch(n){throw console.error("Error removing avatar:",n),(null==(t=null==(e=null==n?void 0:n.response)?void 0:e._data)?void 0:t.message)??"Failed to remove avatar"}}},Us=Ss("profile",{state:()=>({user:null,isLoading:!1,error:null}),getters:{getUser:e=>e.user},actions:{async fetchProfile(){this.isLoading=!0,this.error=null;try{const e=await Ws.getProfile();if(!e._id||!e.email)throw new Error("Invalid user data received");return this.setProfile(e),this.user}catch(e){throw console.error("Error fetching user profile:",e),this.error=(null==e?void 0:e.message)||"Failed to fetch profile",e}finally{this.isLoading=!1}},async updateProfile(e){this.isLoading=!0,this.error=null;try{const t=await Ws.updateProfile(e);return this.setProfile(t),this.user}catch(t){throw console.error("Error updating user profile:",t),this.error=(null==t?void 0:t.message)||"Failed to update profile",t}finally{this.isLoading=!1}},async updateStatus(e,t){this.isLoading=!0,this.error=null;try{const n=await Ws.updateStatus({status:e,status_note:t});return this.setProfile(n),this.user}catch(n){throw console.error("Error updating user status:",n),this.error=(null==n?void 0:n.message)||"Failed to update status",n}finally{this.isLoading=!1}},async uploadAvatar(e){this.isLoading=!0,this.error=null;try{const t=await Ws.uploadAvatar(e);return this.setProfile(t),this.user}catch(t){throw console.error("Error uploading avatar:",t),this.error=(null==t?void 0:t.message)||"Failed to upload avatar",t}finally{this.isLoading=!1}},async removeAvatar(){this.isLoading=!0,this.error=null;try{const e=await Ws.removeAvatar();return this.setProfile(e),this.user}catch(e){throw console.error("Error removing avatar:",e),this.error=(null==e?void 0:e.message)||"Failed to remove avatar",e}finally{this.isLoading=!1}},setProfile(e){this.user=e;try{localStorage.setItem("user",JSON.stringify(e))}catch(t){console.error("Error saving user to localStorage:",t)}},clearProfile(){this.user=null;try{localStorage.removeItem("user")}catch(e){console.error("Error removing user from localStorage:",e)}},loadProfile(){try{const e=localStorage.getItem("user");if(e)return this.user=JSON.parse(e),!0}catch(e){console.error("Error loading user from localStorage:",e),this.clearProfile()}return!1}}});const Ls=new class extends Ps{async fetchTickets(e){var t,n;try{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.pageSize&&t.append("page_size",e.pageSize.toString()),e.filters&&(e.filters.companyId&&t.append("company_id",e.filters.companyId),e.filters.status&&"all"!==e.filters.status&&t.append("status",e.filters.status),e.filters.priority&&"all"!==e.filters.priority&&t.append("priority",e.filters.priority),e.filters.type&&"all"!==e.filters.type&&t.append("type",e.filters.type),e.filters.cs_id&&t.append("cs_id",e.filters.cs_id),e.filters.search&&t.append("search",e.filters.search)),await Ms(`${this.getBaseUrl()}/api/v1/tickets?${t.toString()}`,{headers:this.getHeaders()})}catch(i){throw console.error("Error fetching tickets:",i),(null==(n=null==(t=null==i?void 0:i.response)?void 0:t._data)?void 0:n.message)??"Failed to fetch tickets"}}async getTicketById(e){var t,n;try{return await Ms(`${this.getBaseUrl()}/api/v1/tickets/${e}`,{headers:this.getHeaders()})}catch(i){throw console.error("Error fetching ticket:",i),(null==(n=null==(t=null==i?void 0:i.response)?void 0:t._data)?void 0:n.message)??"Failed to fetch ticket"}}async createTicket(e,t){var n,i;try{return await Ms(`${this.getBaseUrl()}/api/v1/tickets?chat_id=${t}`,{method:"POST",body:JSON.stringify(e),headers:this.getHeaders()})}catch(o){throw console.error("Error creating ticket:",o),(null==(i=null==(n=null==o?void 0:o.response)?void 0:n._data)?void 0:i.message)??"Failed to create ticket"}}async updateTicket(e,t){var n,i;try{return await Ms(`${this.getBaseUrl()}/api/v1/tickets/${e}`,{method:"PUT",body:JSON.stringify(t),headers:this.getHeaders()})}catch(o){throw console.error("Error updating ticket:",o),(null==(i=null==(n=null==o?void 0:o.response)?void 0:n._data)?void 0:i.message)??"Failed to update ticket"}}async assignTicket(e,t){var n,i;try{return await Ms(`${this.getBaseUrl()}/api/v1/tickets/${e}/assign`,{method:"PUT",body:JSON.stringify({cs_id:t}),headers:this.getHeaders()})}catch(o){throw console.error("Error assigning ticket:",o),(null==(i=null==(n=null==o?void 0:o.response)?void 0:n._data)?void 0:i.message)??"Failed to assign ticket"}}async resolveTicket(e){var t,n;try{return await Ms(`${this.getBaseUrl()}/api/v1/tickets/${e}/resolve`,{method:"PUT",headers:this.getHeaders()})}catch(i){throw console.error("Error resolving ticket:",i),(null==(n=null==(t=null==i?void 0:i.response)?void 0:t._data)?void 0:n.message)??"Failed to resolve ticket"}}async closeTicket(e){var t,n;try{return await Ms(`${this.getBaseUrl()}/api/v1/tickets/${e}/close`,{method:"PUT",headers:this.getHeaders()})}catch(i){throw console.error("Error closing ticket:",i),(null==(n=null==(t=null==i?void 0:i.response)?void 0:t._data)?void 0:n.message)??"Failed to close ticket"}}async reopenTicket(e){var t,n;try{return await Ms(`${this.getBaseUrl()}/api/v1/tickets/${e}/reopen`,{method:"PUT",headers:this.getHeaders()})}catch(i){throw console.error("Error reopening ticket:",i),(null==(n=null==(t=null==i?void 0:i.response)?void 0:t._data)?void 0:n.message)??"Failed to reopen ticket"}}},Fs=Ss("tickets",{state:()=>({tickets:[],selectedTicket:null,meta:null,isLoading:!1,error:null,filters:{companyId:void 0,status:"all",priority:"all",type:"all",search:"",cs_id:void 0}}),actions:{async fetchTickets(e=1,t=10){this.isLoading=!0,this.error=null;try{const n=await Ls.fetchTickets({page:e,pageSize:t,filters:this.filters});this.tickets=n.data,this.meta=n.meta}catch(n){throw this.error=n.message??"Failed to fetch tickets",n}finally{this.isLoading=!1}},async getTicketById(e){this.isLoading=!0,this.error=null;try{const t=await Ls.getTicketById(e);return this.selectedTicket=t,t}catch(t){throw this.error=t.message??"Failed to fetch ticket",t}finally{this.isLoading=!1}},async createTicket(e,t){try{return await Ls.createTicket(e,t)}catch(n){throw this.error=n.message??"Failed to create ticket",n}},async updateTicket(e,t){var n;try{const i=await Ls.updateTicket(e,t);return(null==(n=this.selectedTicket)?void 0:n._id)===e&&(this.selectedTicket=i),i}catch(i){throw this.error=i.message??"Failed to update ticket",i}},async assignTicket(e,t){var n;try{const i=await Ls.assignTicket(e,t);return(null==(n=this.selectedTicket)?void 0:n._id)===e&&(this.selectedTicket=i),i}catch(i){throw this.error=i.message??"Failed to assign ticket",i}},async resolveTicket(e){var t;try{const n=await Ls.resolveTicket(e);return(null==(t=this.selectedTicket)?void 0:t._id)===e&&(this.selectedTicket=n),n}catch(n){throw this.error=n.message??"Failed to resolve ticket",n}},async closeTicket(e){var t;try{const n=await Ls.closeTicket(e);return(null==(t=this.selectedTicket)?void 0:t._id)===e&&(this.selectedTicket=n),n}catch(n){throw this.error=n.message??"Failed to close ticket",n}},async reopenTicket(e){var t;try{const n=await Ls.reopenTicket(e);return(null==(t=this.selectedTicket)?void 0:t._id)===e&&(this.selectedTicket=n),n}catch(n){throw this.error=n.message??"Failed to reopen ticket",n}},setFilters(e){this.filters={...this.filters,...e}},resetFilters(){this.filters={companyId:void 0,status:"all",priority:"all",type:"all",search:"",cs_id:void 0}}}}),js=Ss("ticket-chat",{state:()=>({isConnected:!1,messages:[],isCustomerTyping:!1}),actions:{async initializeChat(){try{const e=Os.getInstance();await e.initializeConnection(),this.isConnected=!0,e.onMessage(Es.CHAT,(e=>{console.log("[Store] Received chat message:",e),this.isCustomerTyping=!1;const t={_id:e._id||Date.now().toString(),created_at:e.timestamp||(new Date).toISOString(),updated_at:null,deleted_at:null,code:e.code,user_id:e.sender_id||"",avatar:e.avatar||null,cs_id:null,role:e.role,content:e.content};this.messages.push(t);const n=Fs();n.selectedTicket&&(Array.isArray(n.selectedTicket.chat_history)||(n.selectedTicket.chat_history=[]),n.selectedTicket.chat_history.push(t))})),e.onMessage(Es.TYPING,(e=>{console.log("Typing Indicator Received:",{isTyping:e.is_typing,role:e.role,senderId:e.sender_id}),"customer"===e.role&&(this.isCustomerTyping=e.is_typing,console.log("Updated isCustomerTyping:",this.isCustomerTyping))})),e.onStatusChange((e=>{this.isConnected=e}))}catch(e){throw console.error("Failed to initialize chat:",e),this.isConnected=!1,e}},async sendMessage(e,t){var n,i,o,s,r;const a=Us(),l=Os.getInstance();if(console.log("Checking WebSocket connection:",this.isConnected),!this.isConnected)throw new Error("WebSocket not connected");console.log("Sending message:",e);try{const c={_id:Date.now().toString(),created_at:(new Date).toISOString(),updated_at:null,deleted_at:null,avatar:null==(n=a.getUser)?void 0:n.avatar,code:t,user_id:a.$id,cs_id:null,role:null==(i=a.getUser)?void 0:i.role,content:e};await l.sendMessage({type:"chat_message",code:t,content:e,sender_name:(null==(o=a.getUser)?void 0:o.full_name)?null==(s=a.getUser)?void 0:s.full_name:"CS Agent",avatar:null==(r=a.getUser)?void 0:r.avatar}),this.messages.push(c);const d=Fs();d.selectedTicket&&(Array.isArray(d.selectedTicket.chat_history)||(d.selectedTicket.chat_history=[]),d.selectedTicket.chat_history.push(c))}catch(c){throw console.error("Failed to send message:",c),c}},async sendTypingIndicator(e,t){const n=Os.getInstance();if(!this.isConnected)throw new Error("WebSocket not connected");try{console.log("[store] Sending typing indicator"),await n.sendTypingIndicator({type:"typing_indicator",code:t,is_typing:e,sender_id:Us().$id,role:"cs"})}catch(i){throw console.error("Failed to send typing status:",i),i}},setInitialMessages(e){this.messages=e},setTypingStatus(e){this.isCustomerTyping=e},cleanup(){this.isConnected=!1,this.messages=[],this.isCustomerTyping=!1}}}),Hs=class e{static initAudioContext(){if(!e.audioContext)try{const t=window.AudioContext||window.webkitAudioContext;e.audioContext=new t}catch(t){console.error("Web Audio API is not supported in this browser",t)}}static async loadSound(t){const n=t||e.customSoundUrl||e.defaultSoundUrl;if(e.audioContext||e.initAudioContext(),e.audioContext)try{const i=await fetch(n,{mode:"cors"}),o=await i.arrayBuffer();e.notificationSound=await e.audioContext.decodeAudioData(o),t&&(e.customSoundUrl=t)}catch(i){console.error("Error loading notification sound:",i),console.error("Failed URL:",n);try{const t=new Audio(n);await t.load(),e.useExternalSound=!0,console.log("Fallback to HTML Audio API")}catch(o){console.error("Both Web Audio API and HTML Audio API failed:",o)}}else console.error("Could not initialize audio context")}static async playNotification(){if(!e.isEnabled)return;const t=e.customSoundUrl||e.defaultSoundUrl;if(e.audioContext&&e.notificationSound)try{"suspended"===e.audioContext.state&&await e.audioContext.resume();const t=e.audioContext.createBufferSource();t.buffer=e.notificationSound;const n=e.audioContext.createGain();return n.gain.value=e.volume,t.connect(n),n.connect(e.audioContext.destination),void t.start(0)}catch(n){console.error("Error playing notification sound with Web Audio API:",n)}if(e.useExternalSound)try{const n=new Audio(t);n.volume=e.volume,n.play().catch((e=>{console.error("HTMLAudioElement playback failed:",e)}))}catch(n){console.error("Error playing notification with HTML Audio API:",n)}else try{await e.loadSound(),e.playNotification()}catch(n){console.error("Could not load notification sound",n)}}static setEnabled(t){e.isEnabled=t}static setVolume(t){t>=0&&t<=1&&(e.volume=t)}static setCustomSound(t){e.customSoundUrl=t,e.loadSound(t)}static testSound(){e.playNotification()}static getCurrentSoundUrl(){return e.customSoundUrl||e.defaultSoundUrl}};n(Hs,"audioContext",null),n(Hs,"notificationSound",null),n(Hs,"defaultSoundUrl","https://cdn.pixabay.com/download/audio/2021/08/04/audio_0625c1539c.mp3"),n(Hs,"customSoundUrl",null),n(Hs,"isEnabled",!0),n(Hs,"volume",.5),n(Hs,"useExternalSound",!0);let Rs=Hs;const Ns=Ss("chat-theme",{state:()=>({currentTheme:"light",isInitialized:!1}),getters:{isDark:e=>(console.log("isDark getter called, currentTheme:",e.currentTheme),"dark"===e.currentTheme),isLight:e=>"light"===e.currentTheme},actions:{toggleTheme(){const e=this.currentTheme;this.currentTheme="light"===this.currentTheme?"dark":"light",console.log("Theme toggled from",e,"to",this.currentTheme),this.saveToStorage(),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("widget-theme-change",{detail:{theme:this.currentTheme,isDark:this.isDark}}))},setTheme(e){console.log("Setting theme to:",e),e!==this.currentTheme&&(this.currentTheme=e,this.saveToStorage(),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("widget-theme-change",{detail:{theme:this.currentTheme,isDark:this.isDark}}))),this.isInitialized=!0},initializeFromStorage(){if("undefined"!=typeof window)try{const e=localStorage.getItem("cappuccino-widget-theme");!e||"light"!==e&&"dark"!==e||(console.log("Loading theme from storage:",e),this.currentTheme=e)}catch(e){console.warn("Failed to load theme from storage:",e)}this.isInitialized=!0},saveToStorage(){if("undefined"!=typeof window)try{localStorage.setItem("cappuccino-widget-theme",this.currentTheme),console.log("Theme saved to storage:",this.currentTheme)}catch(e){console.warn("Failed to save theme to storage:",e)}},debug(){console.log("=== THEME STORE DEBUG ==="),console.log("currentTheme:",this.currentTheme),console.log("isDark:",this.isDark),console.log("isLight:",this.isLight),console.log("isInitialized:",this.isInitialized),"undefined"!=typeof window&&console.log("localStorage:",localStorage.getItem("cappuccino-widget-theme")),console.log("========================")}}});var zs=(e=>(e.OPEN="open",e.ASSIGNED="assigned",e.ACTIVE="active",e.RESOLVED="resolved",e.CLOSED="closed",e.REOPENED="reopened",e))(zs||{}),Bs=(e=>(e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.URGENT="urgent",e))(Bs||{}),$s=(e=>(e.COMPLAINT="complaint",e.INFORMATION="information",e.SUPPORT="support",e.FEEDBACK="feedback",e))($s||{}),Gs="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Vs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function qs(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var i=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,i.get?i:{enumerable:!0,get:function(){return e[t]}})})),n}var Ks=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};const Xs=qs(i({__proto__:null,default:Vs(Ks)},[Ks]));var Js="object"==typeof Gs&&Gs&&Gs.Object===Object&&Gs;var Ys=qs(i({__proto__:null,default:Vs(Js)},[Js])),Zs="object"==typeof self&&self&&self.Object===Object&&self,Qs=Ys||Zs||Function("return this")();const er=qs(i({__proto__:null,default:Vs(Qs)},[Qs]));var tr=er,nr=function(){return tr.Date.now()};const ir=qs(i({__proto__:null,default:Vs(nr)},[nr]));var or=/\s/;var sr=function(e){for(var t=e.length;t--&&or.test(e.charAt(t)););return t};var rr=qs(i({__proto__:null,default:Vs(sr)},[sr])),ar=/^\s+/;var lr=function(e){return e?e.slice(0,rr(e)+1).replace(ar,""):e};const cr=qs(i({__proto__:null,default:Vs(lr)},[lr]));var dr=er.Symbol;const ur=qs(i({__proto__:null,default:Vs(dr)},[dr]));var hr=ur,gr=Object.prototype,pr=gr.hasOwnProperty,fr=gr.toString,mr=hr?hr.toStringTag:void 0;var yr=function(e){var t=pr.call(e,mr),n=e[mr];try{e[mr]=void 0;var i=!0}catch(s){}var o=fr.call(e);return i&&(t?e[mr]=n:delete e[mr]),o};const vr=qs(i({__proto__:null,default:Vs(yr)},[yr]));var wr=Object.prototype.toString;var br=function(e){return wr.call(e)};var kr=vr,_r=qs(i({__proto__:null,default:Vs(br)},[br])),xr=ur?ur.toStringTag:void 0;var Sr=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":xr&&xr in Object(e)?kr(e):_r(e)};var Cr=function(e){return null!=e&&"object"==typeof e};var Tr=qs(i({__proto__:null,default:Vs(Sr)},[Sr])),Er=qs(i({__proto__:null,default:Vs(Cr)},[Cr]));var Ir=function(e){return"symbol"==typeof e||Er(e)&&"[object Symbol]"==Tr(e)};var Or=cr,Pr=Xs,Ar=qs(i({__proto__:null,default:Vs(Ir)},[Ir])),Dr=/^[-+]0x[0-9a-f]+$/i,Mr=/^0b[01]+$/i,Wr=/^0o[0-7]+$/i,Ur=parseInt;var Lr=function(e){if("number"==typeof e)return e;if(Ar(e))return NaN;if(Pr(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Pr(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Or(e);var n=Mr.test(e);return n||Wr.test(e)?Ur(e.slice(2),n?2:8):Dr.test(e)?NaN:+e};var Fr=Xs,jr=ir,Hr=qs(i({__proto__:null,default:Vs(Lr)},[Lr])),Rr=Math.max,Nr=Math.min;var zr=function(e,t,n){var i,o,s,r,a,l,c=0,d=!1,u=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function g(t){var n=i,s=o;return i=o=void 0,c=t,r=e.apply(s,n)}function p(e){var n=e-l;return void 0===l||n>=t||n<0||u&&e-c>=s}function f(){var e=jr();if(p(e))return m(e);a=setTimeout(f,function(e){var n=t-(e-l);return u?Nr(n,s-(e-c)):n}(e))}function m(e){return a=void 0,h&&i?g(e):(i=o=void 0,r)}function y(){var e=jr(),n=p(e);if(i=arguments,o=this,l=e,n){if(void 0===a)return function(e){return c=e,a=setTimeout(f,t),d?g(e):r}(l);if(u)return clearTimeout(a),a=setTimeout(f,t),g(l)}return void 0===a&&(a=setTimeout(f,t)),r}return t=Hr(t)||0,Fr(n)&&(d=!!n.leading,s=(u="maxWait"in n)?Rr(Hr(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h),y.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=l=o=a=void 0},y.flush=function(){return void 0===a?r:m(jr())},y};const Br=Vs(zr),$r=ln({__name:"Icons",props:{name:{type:String,required:!0}},setup(e,{expose:t}){t();const n={};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}}),Gr=(e,t)=>{const n=e.__vccOpts||e;for(const[i,o]of t)n[i]=o;return n},Vr={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-message-circle"},qr=[eo("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"},null,-1)],Kr={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-send"},Xr=[eo("line",{x1:"22",y1:"2",x2:"11",y2:"13"},null,-1),eo("polygon",{points:"22 2 15 22 11 13 2 9 22 2"},null,-1)],Jr={key:2,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-x"},Yr=[eo("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),eo("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1)],Zr=eo("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-bell"},[eo("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),eo("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})],-1),Qr=oo('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bell-off"><path d="M13.73 21a2 2 0 0 1-3.46 0"></path><path d="M18.63 13A17.89 17.89 0 0 1 18 8"></path><path d="M6.26 6.26A5.86 5.86 0 0 0 6 8c0 7-3 9-3 9h14"></path><path d="M18 8a6 6 0 0 0-9.33-5"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>',1),ea={key:5,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-settings"},ta=[eo("circle",{cx:"12",cy:"12",r:"3"},null,-1),eo("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},null,-1)],na=eo("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-volume-2"},[eo("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),eo("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"})],-1);const ia=Gr($r,[["render",function(e,t,n,i,o,s){return"message-circle"===n.name?(Gi(),Xi("svg",Vr,[...qr])):"send"===n.name?(Gi(),Xi("svg",Kr,[...Xr])):"x"===n.name?(Gi(),Xi("svg",Jr,[...Yr])):"bell"===n.name?(Gi(),Xi(Hi,{key:3},[so(" Bell Icon "),Zr],2112)):"bell-off"===n.name?(Gi(),Xi(Hi,{key:4},[so(" Bell Off Icon "),Qr],2112)):"settings"===n.name?(Gi(),Xi("svg",ea,[...ta])):"volume"===n.name?(Gi(),Xi(Hi,{key:6},[so(" Volume Icon "),na],2112)):so("v-if",!0)}],["__file","D:/nuxtjs/cappuccino-fe/widget/chat-box/components/icons/Icons.vue"]]),oa=ln({__name:"TicketChat",props:{ticket:{type:Object,required:!0}},emits:["sendMessage"],setup(e,{expose:t,emit:n}){t();const i=e,o=n,s=Ct(null),r=Ct(""),a=js(),l=Us(),{isConnected:c,messages:d,isCustomerTyping:u}=Cs(a),h=Ct(!1),g=Ct(null),p=Br((async e=>{if(i.ticket.chat_code)try{await a.sendTypingIndicator(e,i.ticket.chat_code)}catch(t){console.error("Failed to send typing status:",t)}}),300),f=()=>{r.value.trim()&&(p.cancel(),i.ticket.chat_code&&a.sendTypingIndicator(!1,i.ticket.chat_code),o("sendMessage",r.value),r.value="",setTimeout(m,100))},m=()=>{s.value&&(s.value.scrollTop=s.value.scrollHeight,h.value=!1)},y=()=>{if(!s.value)return;const{scrollTop:e,scrollHeight:t,clientHeight:n}=s.value,i=t-e-n;h.value=i>100};Ti([()=>{var e;return null==(e=i.ticket.chat_history)?void 0:e.length},()=>a.isCustomerTyping],(()=>{console.log("Customer typing: ",a.isCustomerTyping),setTimeout(m,100)})),vn((()=>{m(),s.value&&s.value.addEventListener("scroll",y)})),_n((()=>{g.value&&clearTimeout(g.value),p.cancel(),s.value&&s.value.removeEventListener("scroll",y)}));const v=Co((()=>{var e;const t=new Map;return null==(e=i.ticket.chat_history)||e.forEach((e=>{t.set(e._id,e)})),d.value.forEach((e=>{t.set(e._id,e)})),Array.from(t.values()).sort(((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()))})),w=Co((()=>{const e={};return v.value.forEach((t=>{try{const n=new Date(t.created_at).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"});e[n]||(e[n]=[]),e[n].push(t)}catch(n){console.error("Error processing message date:",n,t);const i="Unknown Date";e[i]||(e[i]=[]),e[i].push(t)}})),e})),b={props:i,emit:o,chatContainer:s,newMessage:r,ticketChatStore:a,profileStore:l,isConnected:c,wsMessages:d,isCustomerTyping:u,showScrollButton:h,typingTimeout:g,formatTime:e=>{if(e)try{const t=Intl.DateTimeFormat().resolvedOptions().timeZone;return new Date(e).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",timeZone:t})}catch(t){return console.error("Error formatting time:",t),""}return""},debouncedTypingStatus:p,handleSendMessage:f,scrollToBottom:m,handleScroll:y,handleInput:e=>{const t=e.target.value;if(!i.ticket.chat_code)return;const n=e.target;n.style.height="auto",n.style.height=Math.min(n.scrollHeight,120)+"px",t.length>0?p(!0):p(!1)},allMessages:v,isLeftSideMessage:e=>{var t;return e!==(null==(t=l.getUser)?void 0:t.role)},getSenderName:e=>{switch(e.role){case"customer":return"Customer";case"assistant":return"AI Assistant";case"cs":return"Customer Service";case"admin":return"Admin";default:return e.role}},groupedMessages:w,getMessageStyle:e=>{const t="px-3 py-1.5 rounded-lg break-words max-w-[280px] shadow-sm";switch(e.role){case"admin":return`${t} bg-green-500 text-white`;case"cs":return`${t} bg-blue-500 text-white`;case"assistant":return`${t} bg-emerald-100 dark:bg-emerald-900/20 text-emerald-800 dark:text-emerald-300`;default:return`${t} bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white`}},sendMessageWithEnter:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),f())},IconsComponent:ia};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),sa=e=>(nn("data-v-ad8e483a"),e=e(),on(),e),ra={class:"chat-container h-full flex flex-col relative overflow-hidden"},aa={class:"p-2 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"},la={class:"flex justify-between items-center"},ca=sa((()=>eo("h2",{class:"text-sm font-bold text-gray-900 dark:text-white flex items-center"},[eo("svg",{class:"h-4 w-4 mr-1.5 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})]),io(" Conversation ")],-1))),da={key:0,class:"flex items-center text-xs text-emerald-500"},ua=sa((()=>eo("span",{class:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-1 animate-pulse"},null,-1))),ha={key:1,class:"flex items-center text-xs text-amber-500"},ga=sa((()=>eo("span",{class:"w-1.5 h-1.5 bg-amber-500 rounded-full mr-1 animate-pulse"},null,-1))),pa={class:"flex justify-center my-2"},fa={class:"px-2 py-0.5 rounded-full text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 shadow-sm"},ma={class:"text-xs whitespace-pre-wrap"},ya={key:0,class:"flex flex-col items-center justify-center h-32 text-gray-500"},va=[sa((()=>eo("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1))),sa((()=>eo("p",{class:"text-sm font-medium"},"No messages yet",-1))),sa((()=>eo("p",{class:"text-xs text-gray-400 mt-1"},"Start the conversation",-1)))],wa={key:1,class:"flex items-start space-x-2 animate-fade-in"},ba=[oo('<div class="inline-flex items-center space-x-2 px-3 py-1.5 bg-gray-100 dark:bg-gray-800 rounded-lg shadow-sm" data-v-ad8e483a><span class="text-xs text-gray-600 dark:text-gray-400" data-v-ad8e483a> Customer is typing </span><span class="flex space-x-1" data-v-ad8e483a><span class="w-1 h-1 bg-gray-500 dark:bg-gray-400 rounded-full animate-bounce" style="animation-delay:0ms;" data-v-ad8e483a></span><span class="w-1 h-1 bg-gray-500 dark:bg-gray-400 rounded-full animate-bounce" style="animation-delay:150ms;" data-v-ad8e483a></span><span class="w-1 h-1 bg-gray-500 dark:bg-gray-400 rounded-full animate-bounce" style="animation-delay:300ms;" data-v-ad8e483a></span></span></div>',1)],ka=[sa((()=>eo("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)))],_a={class:"cs-chat-input-container dark:bg-gray-800 dark:border-gray-700"},xa={class:"flex items-center space-x-3",style:{"align-items":"center",display:"flex"}},Sa=sa((()=>eo("button",{class:"flex-shrink-0 flex items-center justify-center rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",style:{height:"40px",width:"40px","min-height":"40px","min-width":"40px"},type:"button"},[eo("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-gray-500 dark:text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})])],-1))),Ca={class:"flex-1",style:{flex:"1"}},Ta=["disabled"];const Ea=Gr(oa,[["render",function(e,t,n,i,o,s){var r;return Gi(),Xi("div",ra,[so(" Chat Header "),eo("div",aa,[eo("div",la,[ca,i.isConnected?(Gi(),Xi("div",da,[ua,io(" Live Chat Connected ")])):(Gi(),Xi("div",ha,[ga,io(" Connecting... ")]))])]),so(" Chat Messages - Increased padding at bottom to make room for input "),eo("div",{ref:"chatContainer",onScroll:i.handleScroll,class:"cs-messages flex-1 overflow-y-auto p-3 space-y-3 bg-gray-50 dark:bg-gray-900",style:{"padding-bottom":"120px"}},[so(" Messages grouped by date "),(Gi(!0),Xi(Hi,null,In(i.groupedMessages,((e,t)=>(Gi(),Xi(Hi,{key:t},[so(" Date Separator - Improved "),eo("div",pa,[eo("span",fa,ee(t),1)]),so(" Messages for this date "),(Gi(!0),Xi(Hi,null,In(e,(e=>(Gi(),Xi("div",{key:e._id,class:"space-y-3"},[eo("div",{class:K(["flex space-y-0.5",i.isLeftSideMessage(e.role)?"justify-start":"justify-end"])},[eo("div",{class:K(["space-y-0.5 max-w-[80%]",i.isLeftSideMessage(e.role)?"items-start":"items-end"])},[so(" Sender Name "),eo("div",{class:K(["text-xs font-medium text-gray-500 dark:text-gray-400",i.isLeftSideMessage(e.role)?"text-left":"text-right"])},ee(i.getSenderName(e)),3),so(" Message Content with improved styling "),eo("div",{class:K([i.getMessageStyle(e),i.isLeftSideMessage(e.role)?"rounded-tr-lg rounded-br-lg rounded-bl-lg":"rounded-tl-lg rounded-bl-lg rounded-br-lg","cs"===e.role?"hover:bg-blue-600 transition-colors":""])},[eo("p",ma,ee(e.content),1)],2),so(" Timestamp "),eo("div",{class:K(["text-xs text-gray-500 dark:text-gray-400",i.isLeftSideMessage(e.role)?"text-left":"text-right"])},ee(i.formatTime(e.created_at?e.created_at:"")),3)],2)],2)])))),128))],64)))),128)),so(" Empty state if no messages "),0===i.allMessages.length?(Gi(),Xi("div",ya,[...va])):so("v-if",!0),so(" Typing Indicator with animation "),i.isCustomerTyping?(Gi(),Xi("div",wa,[...ba])):so("v-if",!0)],544),so(" Scroll to bottom button "),i.showScrollButton?(Gi(),Xi("div",{key:0,onClick:i.scrollToBottom,class:"back-to-top visible bg-blue-500 hover:bg-blue-600 text-white rounded-full p-2 shadow-md transition-all"},[...ka])):so("v-if",!0),so(" Chat Input - Fixed positioning with improved visibility "),eo("div",_a,[so(" Reset any conflicting styles with explicit flex container "),eo("div",xa,[so(" Attachment Button dengan ukuran tetap "),Sa,so(" Textarea dengan ukuran yang konsisten "),eo("div",Ca,[sn(eo("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.newMessage=e),placeholder:"Type your message...",onInput:i.handleInput,onKeydown:i.sendMessageWithEnter,rows:"1",class:"cs-chat-input w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",style:{height:"40px","min-height":"40px","max-height":"120px","line-height":"1.5","vertical-align":"top","box-sizing":"border-box"}},null,544),[[Qo,i.newMessage]])]),so(" Send Button dengan ukuran tetap "),eo("button",{onClick:i.handleSendMessage,disabled:!(null==(r=i.newMessage)?void 0:r.trim()),class:"cs-send-button flex-shrink-0 flex items-center justify-center rounded-lg bg-blue-500 text-white hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",style:{height:"40px",width:"40px","min-height":"40px","min-width":"40px"},type:"button"},[to(i.IconsComponent,{name:"send",class:"h-4 w-4 dark:text-white"})],8,Ta)])])])}],["__scopeId","data-v-ad8e483a"],["__file","D:/nuxtjs/cappuccino-fe/widget/chat-box/components/tickets/TicketChat.vue"]]),Ia=ln({__name:"ChatEmbeddedWidget",props:{agentName:{type:String,required:!1,default:"CS Agent"},agentAvatar:{type:String,required:!1,default:void 0},initialTheme:{type:String,required:!1,default:"light"},showNotifications:{type:Boolean,required:!1,default:!0},chatLimit:{type:Number,required:!1,default:10},initialView:{type:String,required:!1,default:"tickets"},filterDefaults:{type:Object,required:!1,default:()=>({})},companyId:{type:String,required:!1,default:void 0},mode:{type:String,required:!1,default:"full"},chatOnly:{type:[Object,null],required:!1,default:null}},setup(e,{expose:t}){t();const n=e,i=Ct(!0),o=Ct(!1);vn((()=>{var e;try{o.value="undefined"!=typeof process&&"development"===(null==(e=process.env)?void 0:e.NODE_ENV)}catch{o.value="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||""!==window.location.port}}));const s=Co((()=>"chat-only"===n.mode)),r=Co((()=>"full"===n.mode)),{newMessage:a,messageContainer:l,currentView:c,tickets:d,filteredTickets:u,selectedTicket:h,ticketMeta:g,chatMessages:p,isCustomerTyping:f,isConnected:m,isInitialized:y,sendMessage:v,handleInput:w,selectTicket:b,switchView:k,handlePageChange:_,resolveTicket:x,closeTicket:S,reopenTicket:C,initialize:T,currentPage:E,pageSize:I,fetchTickets:O,handleSearch:P,setFilters:A}=function(e){const t=js(),n=Fs(),i=Us(),o=Ns(),s=Co((()=>"chat-only"===e.mode)),r=Co((()=>"chat-only"!==e.mode)),a=e.externalIsOpen||Ct(!1),l=Ct(""),c=Ct(null),d=Ct(!1),u=Ct(!1),h=Ct(!1),g=Ct(""),p=Ct(s.value?"chat":e.initialView||"tickets"),f=Ct(e.filterDefaults||{}),m=Ct(1),y=Ct(10),v=Ct(!1),w=Ct(null);e.initialTheme&&o.setTheme(e.initialTheme);let b=null;const k=Co((()=>n.tickets)),_=Co((()=>n.selectedTicket)),x=Co((()=>n.meta)),S=Co((()=>t.messages)),C=Co((()=>t.isCustomerTyping)),T=Co((()=>t.isConnected)),E=Co((()=>{if(s.value||!g.value.trim())return k.value;const e=g.value.trim().toLowerCase();return k.value.filter((t=>{var n,i,o,s,r;return(null==(n=t.title)?void 0:n.toLowerCase().includes(e))||(null==(i=t.description)?void 0:i.toLowerCase().includes(e))||(null==(o=t.customer_name)?void 0:o.toLowerCase().includes(e))||(null==(s=t.customer_email)?void 0:s.toLowerCase().includes(e))||(null==(r=t.ticket_number)?void 0:r.toString().includes(e))}))})),I=async()=>{var o;if(s.value&&(null==(o=e.chatOnly)?void 0:o.ticketId)){v.value=!0,w.value=null;try{if(console.log("[useChatWidget] Loading ticket for chat-only mode:",e.chatOnly.ticketId),await n.getTicketById(e.chatOnly.ticketId),!_.value)throw new Error("Failed to load ticket");p.value="chat",console.log("[useChatWidget] Chat-only ticket loaded successfully:",_.value.title),_.value.chat_history&&_.value.chat_history.length>0&&(console.log("[useChatWidget] Setting initial chat messages:",_.value.chat_history.length),t.setInitialMessages(_.value.chat_history)),!1!==e.chatOnly.autoConnect&&i.user&&(console.log("[useChatWidget] Auto-connecting to chat..."),await t.initializeChat())}catch(r){throw console.error("[useChatWidget] Failed to load chat-only ticket:",r),w.value=r.message||"Failed to load conversation",r}finally{v.value=!1}}},O=async()=>{if(!d.value)try{h.value=!0,console.log("[useChatWidget] Initializing widget in mode:",e.mode),await Rs.loadSound(),i.fetchProfile(),i.loadProfile(),i.user||i.setProfile({_id:"",full_name:e.agentName,avatar:e.agentAvatar,email:"",status:"online",company_id:e.companyId||""}),e.companyId&&r.value&&n.setFilters({companyId:e.companyId,...f.value}),s.value?await I():await P(),i.user&&await t.initializeChat(),d.value=!0,console.log("[useChatWidget] Widget initialization completed successfully")}catch(o){throw console.error("[useChatWidget] Failed to initialize Chat Widget:",o),o}finally{h.value=!1}},P=async()=>{if(s.value)console.log("[useChatWidget] fetchTickets called in chat-only mode - skipping");else try{await n.fetchTickets(m.value,y.value)}catch(e){console.error("[useChatWidget] Failed to fetch tickets:",e)}},A=()=>{Gt((()=>{c.value&&(c.value.scrollTop=c.value.scrollHeight)}))},D=async()=>{s.value?await I():console.log("[useChatWidget] reloadChatOnlyTicket called in non-chat-only mode - ignoring")};return e.externalIsOpen&&Ti(a,(e=>{e&&!d.value&&O()})),vn((()=>{(e.initialView||s.value)&&O()})),Ti((()=>S.value.length),(()=>A())),Ti((()=>{var e;return null==(e=_.value)?void 0:e._id}),((e,n)=>{var i;e&&e!==n&&(null==(i=_.value)?void 0:i.chat_history)&&(t.setInitialMessages(_.value.chat_history),A())})),_n((()=>{b&&(clearTimeout(b),b=null),t.cleanup()})),{isOpen:a,newMessage:l,messageContainer:c,isInitialized:d,isConnecting:h,showSettings:u,searchQuery:g,currentView:p,currentPage:m,pageSize:y,ticketFilters:f,isLoadingChatOnlyTicket:v,chatOnlyError:w,isChatOnlyMode:s,isFullMode:r,tickets:k,filteredTickets:E,selectedTicket:_,ticketMeta:x,chatMessages:S,isCustomerTyping:C,isConnected:T,initialize:O,sendMessage:async e=>{if(_.value&&_.value.chat_code)try{b&&(clearTimeout(b),b=null,t.sendTypingIndicator(!1,_.value.chat_code));const n=e||l.value.trim();l.value="",console.log("[useChatWidget] Sending message:",n),await t.sendMessage(n,_.value.chat_code),A()}catch(n){console.error("[useChatWidget] Error sending message:",n)}else console.error("[useChatWidget] Cannot send message: no selected ticket or chat code")},handleInput:()=>{var e;(null==(e=_.value)?void 0:e.chat_code)&&(b&&clearTimeout(b),t.sendTypingIndicator(!0,_.value.chat_code),b=window.setTimeout((()=>{var e;(null==(e=_.value)?void 0:e.chat_code)&&t.sendTypingIndicator(!1,_.value.chat_code),b=null}),3e3))},selectTicket:async e=>{var i;if(s.value)console.log("[useChatWidget] selectTicket called in chat-only mode - ignoring");else try{await n.getTicketById(e),p.value="chat",(null==(i=_.value)?void 0:i.chat_history)&&t.setInitialMessages(_.value.chat_history),A()}catch(o){console.error("[useChatWidget] Error selecting ticket:",o)}},resolveTicket:async()=>{var e;if(null==(e=_.value)?void 0:e._id)try{await n.resolveTicket(_.value._id),await n.getTicketById(_.value._id)}catch(t){console.error("[useChatWidget] Error resolving ticket:",t)}},closeTicket:async()=>{var e;if(null==(e=_.value)?void 0:e._id)try{await n.closeTicket(_.value._id),await n.getTicketById(_.value._id)}catch(t){console.error("[useChatWidget] Error closing ticket:",t)}},reopenTicket:async()=>{var e;if(null==(e=_.value)?void 0:e._id)try{await n.reopenTicket(_.value._id),await n.getTicketById(_.value._id)}catch(t){console.error("[useChatWidget] Error reopening ticket:",t)}},toggleWidget:()=>{a.value=!a.value,a.value&&!d.value&&O()},toggleSettings:()=>{u.value=!u.value},scrollToBottom:A,switchView:e=>{s.value&&"tickets"===e?console.log("[useChatWidget] switchView to tickets called in chat-only mode - ignoring"):(p.value=e,"tickets"===e&&r.value&&P())},handlePageChange:e=>{s.value?console.log("[useChatWidget] handlePageChange called in chat-only mode - ignoring"):(m.value=e,P())},setFilters:e=>{s.value?console.log("[useChatWidget] setFilters called in chat-only mode - ignoring"):(f.value={...f.value,...e},n.setFilters(f.value),m.value=1,P())},handleSearch:e=>{s.value?console.log("[useChatWidget] handleSearch called in chat-only mode - ignoring"):(g.value=e,"tickets"===p.value&&(n.setFilters({search:e}),m.value=1,P()))},fetchTickets:P,loadChatOnlyTicket:I,reloadChatOnlyTicket:D,updateChatOnlyConfig:t=>{s.value&&e.chatOnly?(Object.assign(e.chatOnly,t),t.ticketId&&t.ticketId!==e.chatOnly.ticketId&&(console.log("[useChatWidget] Ticket ID changed, reloading..."),D())):console.log("[useChatWidget] updateChatOnlyConfig called in non-chat-only mode - ignoring")}}}({agentName:n.agentName,agentAvatar:n.agentAvatar,initialView:s.value?"chat":n.initialView,position:"bottom-right",initialTheme:n.initialTheme,companyId:n.companyId,filterDefaults:n.filterDefaults,externalIsOpen:i,mode:n.mode,chatOnly:n.chatOnly?{ticketId:n.chatOnly.ticketId,hideTicketInfo:n.chatOnly.hideTicketInfo,hideActions:n.chatOnly.hideActions,customTitle:n.chatOnly.customTitle,autoConnect:n.chatOnly.autoConnect}:null}),D=Ns(),{isDark:M}=Cs(D),W=Fs(),U=js(),L=Us(),F=Ct(""),j=Ct(s.value),H=Ct(!1),R=Ct(!1),N=Ct(!1),z=async()=>{var e;if(s.value&&(null==(e=n.chatOnly)?void 0:e.ticketId)){N.value=!0;try{if(console.log("Loading ticket for chat-only mode:",n.chatOnly.ticketId),await W.getTicketById(n.chatOnly.ticketId),h.value){if(j.value=!0,h.value.chat_history){const e=h.value.chat_history.map((e=>{var t,n,i;let o;return o="admin"===e.role?"admin":"customer"===e.role?"customer":e.user_id===(null==(t=null==h?void 0:h.value)?void 0:t.cs_id)?"cs":"assistant",{...e,role:o,sender_name:e.user_id===(null==(n=h.value)?void 0:n.cs_id)?(null==(i=h.value.cs_user)?void 0:i.full_name)||"CS Agent":"assistant"===o?"AI Assistant":"Customer"}}));U.setInitialMessages(e)}!1!==n.chatOnly.autoConnect&&L.user&&await U.initializeChat(),console.log("Chat-only ticket loaded successfully:",h.value.title)}}catch(t){console.error("Failed to load ticket for chat-only mode:",t)}finally{N.value=!1}}},B=(e,t)=>{e.classList.remove("dark","light"),e.classList.add(t),e.setAttribute("data-theme",t);try{e.style.colorScheme=t}catch{}};Ti(M,(e=>{console.log("Theme changed to:",e?"dark":"light");[document.querySelector(".cappuccino-chat-embedded-widget"),document.getElementById(n.companyId?`widget-${n.companyId}`:"default-widget"),document.querySelector('[class*="cappuccino-chat"]')].filter(Boolean).forEach((t=>{t&&(B(t,e?"dark":"light"),console.log("Theme applied to container:",{element:t.className,isDark:e,dataTheme:t.getAttribute("data-theme")}))})),setTimeout((()=>{document.querySelectorAll(".cappuccino-chat-embedded-widget *").forEach((e=>{e instanceof HTMLElement&&(e.style.transition="all 0.2s ease")}))}),50)}),{immediate:!0,flush:"post"});vn((async()=>{var e;try{console.log("Mounting widget with mode:",n.mode),console.log("Chat-only config:",n.chatOnly),D.initializeFromStorage(),D.setTheme(n.initialTheme),await Gt();const t=document.querySelector(".cappuccino-chat-embedded-widget");if(t){const e=D.isDark?"dark":"light";B(t,e),console.log("Initial theme applied:",{isDark:D.isDark,classes:t.className,dataTheme:t.getAttribute("data-theme")})}await T(),s.value&&await z(),console.log("Embedded widget initialized"),r.value?console.log("Tickets loaded:",d.value.length):console.log("Chat-only mode, ticket loaded:",null==(e=h.value)?void 0:e.title)}catch(t){console.error("Error during widget initialization:",t)}}));const $=()=>{console.log("=== THEME DEBUG ==="),console.log("Store theme:",D.currentTheme),console.log("Store isDark:",D.isDark),console.log("Store isInitialized:",D.isInitialized);const e=document.querySelector(".cappuccino-chat-embedded-widget");if(e){console.log("Container classes:",e.className),console.log("Container data-theme:",e.getAttribute("data-theme"));const t=window.getComputedStyle(e);console.log("Computed background:",t.backgroundColor),console.log("Computed color:",t.color);const n=e.classList.contains("light"),i=e.classList.contains("dark");console.log("Has light class:",n),console.log("Has dark class:",i)}"undefined"!=typeof window&&console.log("LocalStorage theme:",localStorage.getItem("cappuccino-widget-theme")),console.log("==================")},G=e=>{const t=e||D.currentTheme,n=document.querySelector(".cappuccino-chat-embedded-widget");n&&(B(n,t),console.log("Force applied theme:",t))};"undefined"!=typeof window&&(window.debugWidgetTheme=$,window.forceWidgetTheme=G);const V=[{value:"all",label:"All Status"},{value:zs.OPEN,label:"Open"},{value:zs.ASSIGNED,label:"Assigned"},{value:zs.ACTIVE,label:"Active"},{value:zs.RESOLVED,label:"Resolved"},{value:zs.CLOSED,label:"Closed"},{value:zs.REOPENED,label:"Reopened"}],q=[{value:"all",label:"All Types"},{value:$s.COMPLAINT,label:"Complaint"},{value:$s.INFORMATION,label:"Information"},{value:$s.SUPPORT,label:"Support"},{value:$s.FEEDBACK,label:"Feedback"}],K=[{value:"all",label:"All Priority"},{value:Bs.LOW,label:"Low"},{value:Bs.MEDIUM,label:"Medium"},{value:Bs.HIGH,label:"High"},{value:Bs.URGENT,label:"Urgent"}],X=Co((()=>{var e,t,i;return s.value?(null==(e=n.chatOnly)?void 0:e.customTitle)||(null==(t=h.value)?void 0:t.title)||"Chat":(null==(i=h.value)?void 0:i.title)||"Chat"})),J={props:n,isOpen:i,isDevelopment:o,isChatOnlyMode:s,isFullMode:r,newMessage:a,messageContainer:l,currentView:c,tickets:d,filteredTickets:u,selectedTicket:h,ticketMeta:g,chatMessages:p,isCustomerTyping:f,isConnected:m,isInitialized:y,sendMessage:v,handleInput:w,selectTicket:b,switchView:k,handlePageChange:_,resolveTicket:x,closeTicket:S,reopenTicket:C,initialize:T,currentPage:E,pageSize:I,fetchTickets:O,handleSearch:P,setFilters:A,themeStore:D,isDark:M,ticketsStore:W,ticketChatStore:U,profileStore:L,searchQuery:F,displayingTicketDetail:j,isUpdating:H,showTicketDrawer:R,isLoadingTicket:N,loadChatOnlyTicket:z,applyThemeToContainer:B,toggleDarkMode:()=>{console.log("Toggling theme from:",D.currentTheme),D.toggleTheme(),console.log("Theme toggled to:",D.currentTheme),Gt((()=>{const e=document.querySelector(".cappuccino-chat-embedded-widget");if(e){const t=D.isDark;B(e,t?"dark":"light"),console.log("Container classes after toggle:",e.className)}}))},formatDate:e=>{if(!e)return"";try{return new Date(e).toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return console.error("Date formatting error:",t),e}},onSearchInput:e=>{if(s.value)return;const t=e.target.value;F.value=t,P(t)},debugTheme:$,forceApplyTheme:G,goToTicketDetail:async(e,t)=>{var n,i;if(!s.value)try{if(t&&t.stopPropagation(),console.log("Going to ticket detail:",e),j.value=!0,await W.getTicketById(e),null==(n=h.value)?void 0:n.chat_history){const e=h.value.chat_history.map((e=>{var t,n,i,o;let s;return s="admin"===e.role?"admin":"customer"===e.role?"customer":e.user_id===(null==(t=null==h?void 0:h.value)?void 0:t.cs_id)?"cs":"cs"===e.role&&e.user_id!=(null==(n=null==h?void 0:h.value)?void 0:n.cs_id)?"admin":"assistant",{...e,role:s,sender_name:e.user_id===(null==(i=h.value)?void 0:i.cs_id)?(null==(o=h.value.cs_user)?void 0:o.full_name)||"CS Agent":"assistant"===s?"AI Assistant":"Customer"}}));U.setInitialMessages(e)}L.user&&await U.initializeChat(),console.log("Ticket detail loaded:",null==(i=h.value)?void 0:i.title)}catch(o){console.error("Error fetching ticket details:",o),j.value=!1}},toggleTicketDrawer:e=>{e&&e.stopPropagation(),R.value=!R.value},goBackToTickets:e=>{s.value||(e&&e.stopPropagation(),j.value=!1,R.value=!1)},getStatusStyle:e=>{switch(e){case zs.OPEN:return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-500";case zs.ASSIGNED:case zs.ACTIVE:return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-500";case zs.RESOLVED:return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-500";case zs.REOPENED:return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-500";case zs.CLOSED:default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-500"}},getPriorityStyle:e=>{switch(e){case Bs.URGENT:return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-500";case Bs.HIGH:return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-500";case Bs.MEDIUM:return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-500";case Bs.LOW:default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-500"}},handleSendMessage:async e=>{if(h.value&&h.value.chat_code)try{await U.sendMessage(e,h.value.chat_code)}catch(t){console.error("Failed to send message:",t)}},handleResolve:async e=>{var t;if(e&&e.stopPropagation(),null==(t=h.value)?void 0:t._id){H.value=!0;try{await W.resolveTicket(h.value._id),console.log("Ticket resolved successfully"),await W.getTicketById(h.value._id)}catch(n){console.error("Failed to resolve ticket:",n)}finally{H.value=!1}}},handleClose:async e=>{var t;if(e&&e.stopPropagation(),null==(t=h.value)?void 0:t._id){H.value=!0;try{await W.closeTicket(h.value._id),console.log("Ticket closed successfully"),await W.getTicketById(h.value._id)}catch(n){console.error("Failed to close ticket:",n)}finally{H.value=!1}}},handleReopen:async e=>{var t;if(e&&e.stopPropagation(),null==(t=h.value)?void 0:t._id){H.value=!0;try{await W.reopenTicket(h.value._id),console.log("Ticket reopened successfully"),await W.getTicketById(h.value._id)}catch(n){console.error("Failed to reopen ticket:",n)}finally{H.value=!1}}},statusOptions:V,typeOptions:q,priorityOptions:K,handleStatusChange:e=>{if(s.value)return;const t=e.target.value;A({status:t})},handleTypeChange:e=>{if(s.value)return;const t=e.target.value;A({type:t})},handlePriorityChange:e=>{if(s.value)return;const t=e.target.value;A({priority:t})},handleSearchChange:async e=>{if(s.value)return;const t=e.target.value;A({search:t})},chatHeaderTitle:X,TicketChat:Ea};return Object.defineProperty(J,"__isScriptSetup",{enumerable:!1,value:!0}),J}}),Oa=e=>(nn("data-v-ef3fe763"),e=e(),on(),e),Pa={key:0,class:"chat-only-container h-full"},Aa={key:0,class:"h-full flex flex-col items-center justify-center p-6 bg-gray-50 dark:bg-gray-900"},Da=[Oa((()=>eo("div",{class:"relative w-10 h-10 mb-4"},[eo("div",{class:"absolute top-0 left-0 w-full h-full border-3 border-blue-200 dark:border-blue-900 rounded-full animate-pulse"}),eo("div",{class:"absolute top-0 left-0 w-full h-full border-3 border-transparent border-t-blue-500 rounded-full animate-spin"})],-1))),Oa((()=>eo("p",{class:"text-gray-600 dark:text-gray-400"},"Loading conversation...",-1)))],Ma={class:"h-full flex flex-col"},Wa={class:"bg-white dark:bg-gray-800 p-3 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"},Ua={class:"flex-1"},La={class:"flex items-center"},Fa={class:"font-bold text-gray-900 dark:text-white text-lg"},ja={class:"flex items-center space-x-2 mt-1"},Ha={key:1,class:"flex items-center text-xs text-emerald-500"},Ra=Oa((()=>eo("span",{class:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-1 animate-pulse"},null,-1))),Na={key:0,class:"flex items-center space-x-2"},za=["title"],Ba={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},$a=[Oa((()=>eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)))],Ga={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Va=[Oa((()=>eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)))],qa=["disabled"],Ka=Oa((()=>eo("svg",{class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1))),Xa=["disabled"],Ja=Oa((()=>eo("svg",{class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1))),Ya=["disabled"],Za=Oa((()=>eo("svg",{class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1))),Qa={key:0,class:"p-3 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-700 shadow-inner"},el={class:"space-y-3"},tl=Oa((()=>eo("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Description",-1))),nl={class:"text-sm text-gray-800 dark:text-gray-200 mt-1 whitespace-pre-line"},il={class:"grid grid-cols-2 gap-3"},ol=Oa((()=>eo("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Customer",-1))),sl={class:"text-sm text-gray-800 dark:text-gray-200 flex items-center"},rl=Oa((()=>eo("svg",{class:"h-4 w-4 mr-1 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1))),al=Oa((()=>eo("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Created",-1))),ll={class:"text-sm text-gray-800 dark:text-gray-200"},cl={key:0},dl=Oa((()=>eo("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Assigned To",-1))),ul={class:"text-sm text-gray-800 dark:text-gray-200"},hl={class:"chat-embedded-container h-full flex overflow-hidden"},gl={class:"bg-white dark:bg-gray-800 p-3 border-b border-gray-200 dark:border-gray-700"},pl={class:"flex justify-between items-center mb-2"},fl=Oa((()=>eo("h2",{class:"text-lg font-bold text-gray-900 dark:text-white"},"Tickets",-1))),ml={class:"flex space-x-2"},yl=["title"],vl={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},wl=[Oa((()=>eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)))],bl={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},kl=[Oa((()=>eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)))],_l=[Oa((()=>eo("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)))],xl=[Oa((()=>eo("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)))],Sl={class:"space-y-2"},Cl={class:"relative"},Tl=Oa((()=>eo("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[eo("svg",{class:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))),El={class:"grid grid-cols-2 gap-2"},Il=["value"],Ol=["value"],Pl={class:"flex-1 overflow-y-auto bg-gray-50 dark:bg-gray-900"},Al={key:0,class:"flex justify-center items-center h-32"},Dl=[Oa((()=>eo("div",{class:"relative w-10 h-10"},[eo("div",{class:"absolute top-0 left-0 w-full h-full border-3 border-blue-200 dark:border-blue-900 rounded-full animate-pulse"}),eo("div",{class:"absolute top-0 left-0 w-full h-full border-3 border-transparent border-t-blue-500 rounded-full animate-spin"})],-1)))],Ml={class:"p-4 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 m-3 rounded-lg border border-red-200 dark:border-red-800"},Wl={class:"flex items-start"},Ul=Oa((()=>eo("svg",{class:"h-5 w-5 mr-2 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1))),Ll={class:"p-3 space-y-3"},Fl=["onClick"],jl={class:"flex flex-col"},Hl={class:"flex justify-between items-start mb-2"},Rl={class:"flex-1"},Nl={class:"font-medium text-gray-900 dark:text-white text-sm line-clamp-1"},zl={class:"flex flex-wrap gap-1.5 mb-2"},Bl={key:0,class:"px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"},$l={class:"text-xs text-gray-600 dark:text-gray-400 line-clamp-2 mb-2"},Gl={class:"flex justify-between items-center pt-2 border-t border-gray-100 dark:border-gray-700 text-xs"},Vl={class:"text-gray-600 dark:text-gray-400 flex items-center"},ql=Oa((()=>eo("svg",{class:"h-3.5 w-3.5 mr-1 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1))),Kl={class:"text-gray-500 dark:text-gray-400 flex items-center"},Xl=Oa((()=>eo("svg",{class:"h-3.5 w-3.5 mr-1 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1))),Jl=oo('<div class="flex flex-col items-center justify-center h-64 text-gray-500 dark:text-gray-400 p-4" data-v-ef3fe763><div class="w-16 h-16 mb-3 flex items-center justify-center text-blue-400 dark:text-blue-500 opacity-80" data-v-ef3fe763><svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-ef3fe763><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z" data-v-ef3fe763></path></svg></div><p class="font-medium text-base mb-1" data-v-ef3fe763>No tickets found</p><p class="text-sm text-gray-400 dark:text-gray-500 text-center" data-v-ef3fe763>Any new support requests will appear here</p></div>',1),Yl={key:0,class:"p-3 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 flex justify-center"},Zl={class:"inline-flex shadow-sm"},Ql=["disabled"],ec=[Oa((()=>eo("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)))],tc=["onClick"],nc=["disabled"],ic=[Oa((()=>eo("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)))],oc={key:0,class:"h-full flex flex-col items-center justify-center p-6 bg-gray-50 dark:bg-gray-900 text-gray-500 dark:text-gray-400"},sc=oo('<div class="w-20 h-20 mb-4 flex items-center justify-center text-blue-400 dark:text-blue-500 opacity-80" data-v-ef3fe763><svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-ef3fe763><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" data-v-ef3fe763></path></svg></div><h3 class="text-xl font-bold mb-2" data-v-ef3fe763>No conversation selected</h3><p class="text-center text-gray-400 dark:text-gray-500 mb-4" data-v-ef3fe763> Select a ticket from the list to view the conversation </p>',3),rc=Oa((()=>eo("svg",{class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1))),ac={class:"h-full flex flex-col"},lc={class:"bg-white dark:bg-gray-800 p-3 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"},cc=[Oa((()=>eo("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)))],dc={class:"flex-1"},uc={class:"flex items-center"},hc={class:"font-bold text-gray-900 dark:text-white text-lg"},gc={class:"flex items-center space-x-2 mt-1"},pc={key:0,class:"flex items-center text-xs text-emerald-500"},fc=Oa((()=>eo("span",{class:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-1 animate-pulse"},null,-1))),mc={class:"flex items-center space-x-2"},yc=["disabled"],vc=Oa((()=>eo("svg",{class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1))),wc=["disabled"],bc=Oa((()=>eo("svg",{class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1))),kc=["disabled"],_c=Oa((()=>eo("svg",{class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1))),xc={key:0,class:"p-3 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-700 shadow-inner"},Sc={class:"space-y-3"},Cc=Oa((()=>eo("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Description",-1))),Tc={class:"text-sm text-gray-800 dark:text-gray-200 mt-1 whitespace-pre-line"},Ec={class:"grid grid-cols-2 gap-3"},Ic=Oa((()=>eo("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Customer",-1))),Oc={class:"text-sm text-gray-800 dark:text-gray-200 flex items-center"},Pc=Oa((()=>eo("svg",{class:"h-4 w-4 mr-1 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[eo("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1))),Ac=Oa((()=>eo("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Created",-1))),Dc={class:"text-sm text-gray-800 dark:text-gray-200"},Mc={key:0},Wc=Oa((()=>eo("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Assigned To",-1))),Uc={class:"text-sm text-gray-800 dark:text-gray-200"};const Lc=Gr(Ia,[["render",function(e,t,n,i,o,s){var r,a,l,c;return Gi(),Xi(Hi,null,[so(" Add mode-specific classes to main container "),eo("div",{class:K(["chat-embedded-widget h-full",{"chat-only-mode":i.isChatOnlyMode,"full-mode":i.isFullMode}])},[so(" CHAT-ONLY MODE: Single Chat Panel "),i.isChatOnlyMode?(Gi(),Xi("div",Pa,[so(" Loading State for Chat-Only Mode "),i.isLoadingTicket||!i.selectedTicket?(Gi(),Xi("div",Aa,[...Da])):i.selectedTicket?(Gi(),Xi(Hi,{key:1},[so(" Chat Interface for Chat-Only Mode "),eo("div",Ma,[so(" Chat Header (Simplified for Chat-Only Mode) "),eo("div",Wa,[eo("div",Ua,[eo("div",La,[eo("h2",Fa,ee(i.chatHeaderTitle),1),i.selectedTicket.ticket_number&&!(null==(r=i.props.chatOnly)?void 0:r.hideTicketInfo)?(Gi(),Xi("span",{key:0,onClick:i.toggleTicketDrawer,class:"ml-2 px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"}," #"+ee(i.selectedTicket.ticket_number),1)):so("v-if",!0)]),eo("div",ja,[(null==(a=i.props.chatOnly)?void 0:a.hideTicketInfo)?so("v-if",!0):(Gi(),Xi("span",{key:0,class:K(["px-2 py-0.5 rounded-full text-xs font-medium",i.getStatusStyle(i.selectedTicket.status)])},ee(i.selectedTicket.status.charAt(0).toUpperCase()+i.selectedTicket.status.slice(1)),3)),i.isConnected?(Gi(),Xi("span",Ha,[Ra,io(" Live Chat ")])):so("v-if",!0)])]),so(" Action Buttons (if not hidden) "),(null==(l=i.props.chatOnly)?void 0:l.hideActions)?so("v-if",!0):(Gi(),Xi("div",Na,[so(" Theme Toggle "),eo("button",{onClick:i.toggleDarkMode,class:"p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:i.isDark?"Switch to Light Mode":"Switch to Dark Mode"},[i.isDark?(Gi(),Xi("svg",Ba,[...$a])):(Gi(),Xi("svg",Ga,[...Va]))],8,za),so(" Action Buttons for Ticket Status "),"active"===i.selectedTicket.status?(Gi(),Xi("button",{key:0,onClick:i.handleResolve,disabled:i.isUpdating,class:"px-3 py-1.5 text-sm font-medium rounded bg-green-500 text-white hover:bg-green-600 disabled:opacity-50 shadow-sm flex items-center transition-colors"},[Ka,io(" Resolve ")],8,qa)):so("v-if",!0),"resolved"===i.selectedTicket.status?(Gi(),Xi("button",{key:1,onClick:i.handleClose,disabled:i.isUpdating,class:"px-3 py-1.5 text-sm font-medium rounded bg-gray-500 text-white hover:bg-gray-600 disabled:opacity-50 shadow-sm flex items-center transition-colors"},[Ja,io(" Close ")],8,Xa)):so("v-if",!0),"closed"===i.selectedTicket.status?(Gi(),Xi("button",{key:2,onClick:i.handleReopen,disabled:i.isUpdating,class:"px-3 py-1.5 text-sm font-medium rounded bg-amber-500 text-white hover:bg-amber-600 disabled:opacity-50 shadow-sm flex items-center transition-colors"},[Za,io(" Reopen ")],8,Ya)):so("v-if",!0)]))]),so(" Ticket Details Drawer (if not hidden) "),i.showTicketDrawer&&i.selectedTicket&&!(null==(c=i.props.chatOnly)?void 0:c.hideTicketInfo)?(Gi(),Xi("div",Qa,[eo("div",el,[eo("div",null,[tl,eo("p",nl,ee(i.selectedTicket.description),1)]),eo("div",il,[eo("div",null,[ol,eo("p",sl,[rl,io(" "+ee(i.selectedTicket.customer_name),1)])]),eo("div",null,[al,eo("p",ll,ee(i.formatDate(i.selectedTicket.created_at)),1)])]),i.selectedTicket.cs_user?(Gi(),Xi("div",cl,[dl,eo("p",ul,ee(i.selectedTicket.cs_user.full_name),1)])):so("v-if",!0)])])):so("v-if",!0),so(" Chat Component "),i.selectedTicket?(Gi(),Ji(i.TicketChat,{key:1,ticket:i.selectedTicket,onSendMessage:i.handleSendMessage,class:"flex-1 flex flex-col"},null,8,["ticket"])):so("v-if",!0)])],2112)):so("v-if",!0)])):(Gi(),Xi(Hi,{key:1},[so(" FULL MODE: Original Layout with Tickets + Chat "),eo("div",hl,[so(" Left Side: Tickets List Panel "),eo("div",{class:K(["chat-tickets-panel w-1/3 border-r border-gray-200 dark:border-gray-700 flex flex-col",{"hidden md:flex":i.displayingTicketDetail}])},[so(" Tickets Header "),eo("div",gl,[eo("div",pl,[fl,eo("div",ml,[so(" Theme Toggle "),eo("button",{onClick:i.toggleDarkMode,class:"p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:i.isDark?"Switch to Light Mode":"Switch to Dark Mode"},[i.isDark?(Gi(),Xi("svg",vl,[...wl])):(Gi(),Xi("svg",bl,[...kl]))],8,yl),eo("button",{onClick:t[0]||(t[0]=(...e)=>i.fetchTickets&&i.fetchTickets(...e)),class:"p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Refresh Tickets"},[..._l]),i.isDevelopment?(Gi(),Xi("button",{key:0,onClick:i.debugTheme,class:"p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Debug Theme"},[...xl])):so("v-if",!0)])]),so(" Search and Filters "),eo("div",Sl,[eo("div",Cl,[Tl,eo("input",{type:"text",placeholder:"Search tickets...",onInput:i.handleSearchChange,class:"w-full pl-10 pr-4 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500"},null,32)]),eo("div",El,[sn(eo("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.ticketsStore.filters.status=e),onChange:i.handleStatusChange,class:"w-full pl-3 pr-8 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500"},[(Gi(),Xi(Hi,null,In(i.statusOptions,(e=>eo("option",{key:e.value,value:e.value},ee(e.label),9,Il))),64))],544),[[es,i.ticketsStore.filters.status]]),sn(eo("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>i.ticketsStore.filters.priority=e),onChange:i.handlePriorityChange,class:"w-full pl-3 pr-8 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500"},[(Gi(),Xi(Hi,null,In(i.priorityOptions,(e=>eo("option",{key:e.value,value:e.value},ee(e.label),9,Ol))),64))],544),[[es,i.ticketsStore.filters.priority]])])])]),so(" Tickets List "),eo("div",Pl,[so(" Loading State "),i.ticketsStore.isLoading?(Gi(),Xi("div",Al,[...Dl])):i.ticketsStore.error?(Gi(),Xi(Hi,{key:1},[so(" Error State "),eo("div",Ml,[eo("div",Wl,[Ul,eo("span",null,ee(i.ticketsStore.error),1)])])],2112)):i.tickets&&i.tickets.length>0?(Gi(),Xi(Hi,{key:2},[so(" Tickets List "),eo("div",Ll,[(Gi(!0),Xi(Hi,null,In(i.tickets,(e=>(Gi(),Xi("div",{key:e._id,onClick:t=>i.goToTicketDetail(e._id,t),class:"chat-ticket-card p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-blue-400 dark:hover:border-blue-500 bg-white dark:bg-gray-800 shadow-sm cursor-pointer transition-all"},[so(" Ticket Content (Same as before) "),eo("div",jl,[eo("div",Hl,[eo("div",Rl,[eo("h3",Nl,ee(e.title),1)]),eo("span",{class:K(["block h-2 w-2 rounded-full flex-shrink-0 ml-1",{"bg-red-500":"urgent"===e.priority,"bg-amber-500":"high"===e.priority,"bg-blue-500":"medium"===e.priority,"bg-gray-400":"low"===e.priority}])},null,2)]),eo("div",zl,[eo("span",{class:K(["px-2 py-0.5 rounded-full text-xs font-medium",i.getStatusStyle(e.status)])},ee(e.status.charAt(0).toUpperCase()+e.status.slice(1)),3),eo("span",{class:K(["px-2 py-0.5 rounded-full text-xs font-medium",i.getPriorityStyle(e.priority)])},ee(e.priority.charAt(0).toUpperCase()+e.priority.slice(1)),3),e.ticket_number?(Gi(),Xi("span",Bl," #"+ee(e.ticket_number),1)):so("v-if",!0)]),eo("p",$l,ee(e.description),1),eo("div",Gl,[eo("span",Vl,[ql,io(" "+ee(e.customer_name),1)]),eo("span",Kl,[Xl,io(" "+ee(i.formatDate(e.created_at||"").split(",")[0]),1)])])])],8,Fl)))),128))])],2112)):(Gi(),Xi(Hi,{key:3},[so(" Empty State "),Jl],2112))]),so(" Pagination "),i.ticketMeta&&i.ticketMeta.total_pages>1?(Gi(),Xi("div",Yl,[eo("div",Zl,[eo("button",{onClick:t[3]||(t[3]=e=>i.handlePageChange(i.ticketMeta.current_page-1)),disabled:!i.ticketMeta.has_previous,class:"px-3 py-1 text-sm font-medium rounded-l-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...ec],8,Ql),(Gi(!0),Xi(Hi,null,In(i.ticketMeta.total_pages,(e=>(Gi(),Xi("button",{key:e,onClick:t=>i.handlePageChange(e),class:K(["px-3 py-1 text-sm font-medium border-y border-r focus:ring-2 focus:ring-blue-500 focus:z-10 transition-colors",[e===i.currentPage?"bg-blue-500 text-white border-blue-500 dark:bg-blue-600 dark:border-blue-600 z-10":"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600"]])},ee(e),11,tc)))),128)),eo("button",{onClick:t[4]||(t[4]=e=>i.handlePageChange(i.ticketMeta.current_page+1)),disabled:!i.ticketMeta.has_next,class:"px-3 py-1 text-sm font-medium rounded-r-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...ic],8,nc)])])):so("v-if",!0)],2),so(" Right Side: Chat Panel "),eo("div",{class:K(["chat-panel flex-1 flex flex-col h-full",{"hidden md:flex":!i.displayingTicketDetail&&i.tickets.length>0,"w-full md:w-2/3":i.displayingTicketDetail}])},[so(" Empty State when no ticket is selected "),i.displayingTicketDetail&&i.selectedTicket?i.displayingTicketDetail&&i.selectedTicket?(Gi(),Xi(Hi,{key:1},[so(" Chat Interface "),eo("div",ac,[so(" Chat Header "),eo("div",lc,[so(" Back Button (Mobile) "),eo("button",{onClick:i.goBackToTickets,class:"md:hidden p-2 mr-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[...cc]),eo("div",dc,[eo("div",uc,[eo("h2",hc,ee(i.selectedTicket.title),1),i.selectedTicket.ticket_number?(Gi(),Xi("span",{key:0,onClick:i.toggleTicketDrawer,class:"ml-2 px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"}," #"+ee(i.selectedTicket.ticket_number),1)):so("v-if",!0)]),eo("div",gc,[eo("span",{class:K(["px-2 py-0.5 rounded-full text-xs font-medium",i.getStatusStyle(i.selectedTicket.status)])},ee(i.selectedTicket.status.charAt(0).toUpperCase()+i.selectedTicket.status.slice(1)),3),i.isConnected?(Gi(),Xi("span",pc,[fc,io(" Live Chat ")])):so("v-if",!0)])]),so(" Action Buttons "),eo("div",mc,["active"===i.selectedTicket.status?(Gi(),Xi("button",{key:0,onClick:i.handleResolve,disabled:i.isUpdating,class:"px-3 py-1.5 text-sm font-medium rounded bg-green-500 text-white hover:bg-green-600 disabled:opacity-50 shadow-sm flex items-center transition-colors"},[vc,io(" Resolve ")],8,yc)):so("v-if",!0),"resolved"===i.selectedTicket.status?(Gi(),Xi("button",{key:1,onClick:i.handleClose,disabled:i.isUpdating,class:"px-3 py-1.5 text-sm font-medium rounded bg-gray-500 text-white hover:bg-gray-600 disabled:opacity-50 shadow-sm flex items-center transition-colors"},[bc,io(" Close ")],8,wc)):so("v-if",!0),"closed"===i.selectedTicket.status?(Gi(),Xi("button",{key:2,onClick:i.handleReopen,disabled:i.isUpdating,class:"px-3 py-1.5 text-sm font-medium rounded bg-amber-500 text-white hover:bg-amber-600 disabled:opacity-50 shadow-sm flex items-center transition-colors"},[_c,io(" Reopen ")],8,kc)):so("v-if",!0)])]),so(" Ticket Details Drawer "),i.showTicketDrawer&&i.selectedTicket?(Gi(),Xi("div",xc,[eo("div",Sc,[eo("div",null,[Cc,eo("p",Tc,ee(i.selectedTicket.description),1)]),eo("div",Ec,[eo("div",null,[Ic,eo("p",Oc,[Pc,io(" "+ee(i.selectedTicket.customer_name),1)])]),eo("div",null,[Ac,eo("p",Dc,ee(i.formatDate(i.selectedTicket.created_at)),1)])]),i.selectedTicket.cs_user?(Gi(),Xi("div",Mc,[Wc,eo("p",Uc,ee(i.selectedTicket.cs_user.full_name),1)])):so("v-if",!0)])])):so("v-if",!0),so(" Chat Component "),i.selectedTicket?(Gi(),Ji(i.TicketChat,{key:1,ticket:i.selectedTicket,onSendMessage:i.handleSendMessage,class:"flex-1 flex flex-col"},null,8,["ticket"])):so("v-if",!0)])],2112)):so("v-if",!0):(Gi(),Xi("div",oc,[sc,so(" Mobile Back Button "),eo("button",{onClick:t[5]||(t[5]=e=>i.displayingTicketDetail=!1),class:"md:hidden mt-4 inline-flex items-center px-4 py-2 text-sm bg-blue-500 text-white rounded-md hover:bg-blue-600 shadow-sm transition-colors"},[rc,io(" Back to Tickets ")])]))],2)])],2112))],2)],2112)}],["__scopeId","data-v-ef3fe763"],["__file","D:/nuxtjs/cappuccino-fe/widget/chat-box/components/ChatEmbeddedWidget.vue"]]);!function(){if("undefined"!=typeof window){const e={widgetDomains:["cappuccino-api.bsa.id","cappucino-api.bsa.id","cappuccino.bsa.id","cappucino.bsa.id"],isWidgetDomain:t=>e.widgetDomains.some((e=>t.includes(e))),isSecureContext:()=>"https:"===window.location.protocol||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,addCSPMeta:(e=[])=>{try{const t=document.querySelector('meta[http-equiv="Content-Security-Policy"]'),n=[...["upgrade-insecure-requests"],...e].join("; ");if(t){const e=t.getAttribute("content")||"";if(!e.includes("upgrade-insecure-requests")){const i=e?`${e}; ${n}`:n;return t.setAttribute("content",i),console.log("[Cappuccino Widget] Updated existing CSP:",i),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"csp_updated",data:{content:i}}})),!0}}else{const e=document.createElement("meta");e.setAttribute("http-equiv","Content-Security-Policy"),e.setAttribute("content",n);const t=document.head||document.getElementsByTagName("head")[0];if(t)return t.appendChild(e),console.log("[Cappuccino Widget] Auto-added CSP meta tag:",n),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"csp_added",data:{content:n}}})),!0}return!1}catch(t){return console.warn("[Cappuccino Widget] Failed to manage CSP meta tag:",t),!1}},sanitizeURL:(t,n=!0)=>{if(!t||"string"!=typeof t)return t;if(t.startsWith("data:")||t.startsWith("blob:")||t.startsWith("javascript:")||t.startsWith("//"))return t;if(!e.isWidgetDomain(t))return t;let i=t;return n&&t.startsWith("http://")&&(i=t.replace("http://","https://"),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"https_enforced",data:{original:t,sanitized:i,reason:"widget_domain"}}}))),i},checkMixedContent:()=>{if(!e.isSecureContext())return console.warn("[Cappuccino Widget] Page is not served over HTTPS - mixed content issues may occur"),void window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"insecure_context",data:{protocol:window.location.protocol}}}));if("undefined"!=typeof window&&window.WIDGET_CONFIG){const t=window.WIDGET_CONFIG;t.baseUrlApi&&t.baseUrlApi.startsWith("http://")&&e.isWidgetDomain(t.baseUrlApi)&&(console.warn("[Cappuccino Widget] Widget API URL uses HTTP - this may cause mixed content issues"),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"mixed_content_detected",data:{type:"api",url:t.baseUrlApi}}}))),t.baseUrlWs&&t.baseUrlWs.startsWith("ws://")&&e.isWidgetDomain(t.baseUrlWs)&&(console.warn("[Cappuccino Widget] Widget WebSocket URL uses WS - this may cause mixed content issues"),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"mixed_content_detected",data:{type:"websocket",url:t.baseUrlWs}}})))}},testSecureConnection:async t=>{const n=[];let i,o=!1,s=!1;if(!e.isWidgetDomain(t))return{success:!1,httpsSupported:!1,error:"Not a widget domain - skipping security test",recommendations:["Security tests only apply to widget domains"]};try{const e=t.replace(/^http:\/\//i,"https://");await fetch(e,{method:"HEAD",mode:"no-cors"});o=!0,s=!0,t.startsWith("http://")&&n.push("Consider updating your widget API to use HTTPS by default")}catch(r){i=r.message,t.startsWith("http://")&&(n.push("Your widget API uses HTTP. Widget will auto-upgrade to HTTPS"),n.push("Ensure your server supports HTTPS connections")),"undefined"!=typeof window&&"https:"===window.location.protocol&&n.push("Page is HTTPS but widget API might be HTTP - widget will handle upgrade automatically")}return{success:s,httpsSupported:o,error:i,recommendations:n}}},t=()=>{try{e.addCSPMeta()}catch(t){console.warn("[Cappuccino Widget] Failed to add CSP meta tag:",t)}},n=window.fetch,i=()=>function(t,i){let o;if(o=t instanceof Request?t.url:t instanceof URL?t.toString():t,e.isWidgetDomain(o)){o=(e=>{if(e.startsWith("data:")||e.startsWith("blob:")||e.startsWith("javascript:")||e.startsWith("//"))return e;if(e.match(/^https?:\/\//)){let t=e.replace(/^http:\/\//i,"https://");return t!==e&&(console.log("[Cappuccino Widget] Forced HTTPS for widget domain:",e,"->",t),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"fetch_https_enforced",data:{original:e,converted:t,domain:"widget"}}}))),t}return e})(o),t=t instanceof Request?new Request(o,t):o}return n.apply(window,[t,i])},o=i(),s=XMLHttpRequest.prototype.open,r=()=>function(t,n,i,o,r){if("string"==typeof n&&e.isWidgetDomain(n)&&n.startsWith("http://")){const e=n;n=n.replace("http://","https://"),console.log("[Cappuccino Widget] XHR forced HTTPS for widget domain:",e,"->",n),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"xhr_https_enforced",data:{original:e,converted:n,domain:"widget"}}}))}const a=void 0===i||i;return s.call(this,t,n,a,o,r)};let a=!1;const l=()=>{a||(window.fetch=i(),XMLHttpRequest.prototype.open=r(),a=!0,console.log("[Cappuccino Widget] Global security override enabled (scoped to widget domains)"))},c=()=>{a&&(window.fetch=n,XMLHttpRequest.prototype.open=s,a=!1,console.log("[Cappuccino Widget] Global security override disabled"))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t();const d={...e,widgetFetch:o,enableGlobalOverride:l,disableGlobalOverride:c,isGlobalOverrideEnabled:()=>a,getWidgetDomains:()=>[...e.widgetDomains],addWidgetDomain:t=>{e.widgetDomains.includes(t)||(e.widgetDomains.push(t),console.log("[Cappuccino Widget] Added widget domain:",t))},removeWidgetDomain:t=>{const n=e.widgetDomains.indexOf(t);n>-1&&(e.widgetDomains.splice(n,1),console.log("[Cappuccino Widget] Removed widget domain:",t))}};window.CappuccinoSecurityHelpers=d,console.log("[Cappuccino Widget] Safe scoped security measures initialized"),console.log("[Cappuccino Widget] Protected domains:",e.widgetDomains),console.log("[Cappuccino Widget] Global override:",a?"Enabled":"Disabled (Safe Mode)")}}();const Fc=(e,t,n,i)=>{var o;if("undefined"!=typeof window&&window.WIDGET_DEBUG){const n=(null==(o=window.CappuccinoSecurityHelpers)?void 0:o.isSecureContext())?"[SECURE]":"[INSECURE]";console.log(`[EmbeddedWidget] ${n} ${e}`,t||"")}},jc=(e,t)=>{var n;const i=(null==(n=window.CappuccinoSecurityHelpers)?void 0:n.isSecureContext())?"[SECURE]":"[INSECURE]";console.error(`[EmbeddedWidget] ${i} ${e}`,t||"")},Hc=(e,t)=>{Fc(`Applying theme: ${t} to container`),e.classList.remove("dark","light"),e.classList.add(t),e.setAttribute("data-theme",t),e.style.colorScheme=t,e.offsetHeight,Fc("Theme applied successfully:",{theme:t,classes:e.className,dataTheme:e.getAttribute("data-theme"),colorScheme:e.style.colorScheme})};function Rc(e){var t;const n={autoAddCSP:!1!==e.autoAddCSP,enforceHTTPS:!1!==e.enforceHTTPS,enableGlobalOverride:!0===e.enableGlobalOverride,...e};n.debug&&(window.WIDGET_DEBUG=!0),Fc("Creating embedded chat widget with safe scoped security...",n);const i=window.CappuccinoSecurityHelpers;if(i&&n.securityDomains&&(n.securityDomains.forEach((e=>{i.addWidgetDomain(e)})),Fc("Additional security domains added:",n.securityDomains)),n.autoAddCSP&&i){Fc("Auto-adding CSP meta tag...");i.addCSPMeta([])&&Fc("CSP meta tag added successfully")}if(n.enableGlobalOverride&&i?(Fc("Enabling global security override (scoped to widget domains)..."),i.enableGlobalOverride()):Fc("Global override disabled - using safe scoped mode"),n.enforceHTTPS&&i){if(n.baseUrlApi){const e=n.baseUrlApi;n.baseUrlApi=i.sanitizeURL(n.baseUrlApi),e!==n.baseUrlApi&&Fc("API URL sanitized:",e,0,n.baseUrlApi)}if(n.baseUrlWs){const e=n.baseUrlWs;n.baseUrlWs=i.sanitizeURL(n.baseUrlWs).replace("http://","wss://").replace("https://","wss://"),e!==n.baseUrlWs&&Fc("WebSocket URL sanitized:",e,0,n.baseUrlWs)}}if(!n.apiKey)throw new Error("API Key is required for CS/Admin chat widget initialization");if(!n.baseUrlApi)throw new Error("Base URL API is required for CS/Admin chat widget initialization");if(!n.baseUrlWs)throw new Error("Base URL WebSocket is required for CS/Admin chat widget initialization");if(!n.containerId)throw new Error("Container ID is required for embedded CS/Admin chat widget");if("chat-only"===n.mode){if(!(null==(t=n.chatOnly)?void 0:t.ticketId)&&!n.ticketId)throw new Error("ticketId is required for chat-only mode");n.chatOnly||(n.chatOnly={ticketId:n.ticketId,autoConnect:!0}),Fc("Chat-only mode configuration:",n.chatOnly)}const o=document.getElementById(n.containerId);if(!o)throw new Error(`Container element with ID "${n.containerId}" not found`);Fc("Container found:",o),window.WIDGET_CONFIG={apiKey:n.apiKey,baseUrlApi:n.baseUrlApi,baseUrlWs:n.baseUrlWs,isProduction:n.isProduction};const s=function(){const e=re(!0),t=e.run((()=>Ct({})));let n=[],i=[];const o=vt({install(e){ls(o),o._a=e,e.provide(cs,o),e.config.globalProperties.$pinia=o,i.forEach((e=>n.push(e))),i=[]},use(e){return this._a||rs?n.push(e):i.push(e),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return o}();let r=null,a=null,l=!1,c=null;((e,t)=>{Fc("Preparing container with configuration",t),e.className="cappuccino-chat-embedded-widget";const n=window.CappuccinoSecurityHelpers;(null==n?void 0:n.isSecureContext())?e.classList.add("secure-context"):e.classList.add("insecure-context"),"chat-only"===t.mode?e.classList.add("chat-only-mode"):e.classList.add("full-mode"),t.height?e.style.height=t.height:"chat-only"===t.mode&&(e.style.height="400px"),t.width&&(e.style.width=t.width);const i=t.theme||"light";Hc(e,i),t.debug&&(window.WIDGET_DEBUG=!0,e.setAttribute("data-debug","true")),Fc("Container prepared successfully")})(o,n),n.onSecurityEvent&&window.addEventListener("widget-security-event",(e=>{n.onSecurityEvent(e.detail)}));const d=async()=>{if(l)Fc("Widget already initialized, skipping...");else try{Fc("Initializing Embedded Chat Widget with safe security..."),c=((e,t)=>{Fc("Initializing stores...");try{const n=window.CappuccinoSecurityHelpers;n&&n.checkMixedContent();const i=Ns(e);i.initializeFromStorage(),t.theme&&(Fc(`Setting theme from config: ${t.theme}`),i.setTheme(t.theme)),Fc("Theme store initialized:",{currentTheme:i.currentTheme,isDark:i.isDark,isInitialized:i.isInitialized}),t.agentId&&(Fc("Initializing profile store..."),Us(e).setProfile({_id:t.agentId,full_name:t.agentName||"CS Agent",avatar:t.agentAvatar,email:"",status:"online",company_id:t.companyId||""}),Fc("Profile store initialized"));let o=null;return(t.companyId||"chat-only"===t.mode)&&(Fc("Initializing tickets store..."),o=Fs(e),t.companyId&&o.setFilters({companyId:t.companyId,...t.filterDefaults}),Fc("Tickets store initialized")),{themeStore:i,profileStore:t.agentId?Us(e):null,ticketsStore:o}}catch(n){throw jc("Failed to initialize stores:",n),n}})(s,n),await(async(e,t)=>{var n,i;if("chat-only"===t.mode&&(null==(n=t.chatOnly)?void 0:n.ticketId)){Fc("Initializing chat-only mode for ticket:",t.chatOnly.ticketId);try{const n=e.ticketsStore;if(!n)throw new Error("Tickets store not available for chat-only mode");if(await n.getTicketById(t.chatOnly.ticketId),Fc("Ticket loaded for chat-only mode:",null==(i=n.selectedTicket)?void 0:i.title),!1!==t.chatOnly.autoConnect&&e.profileStore){const e=js();await e.initializeChat(),Fc("Chat connection initialized for chat-only mode")}}catch(o){throw jc("Failed to initialize chat-only mode:",o),o}}})(c,n),r=ss(Lc,{agentName:n.agentName||"CS Agent",agentAvatar:n.agentAvatar,initialTheme:n.theme||"light",showNotifications:void 0===n.showNotifications||n.showNotifications,chatLimit:n.chatLimit||10,initialView:"chat-only"===n.mode?"chat":n.initialView||"tickets",filterDefaults:n.filterDefaults||{},companyId:n.companyId,mode:n.mode||"full",chatOnly:n.chatOnly}),r.use(s),r.mount(o),Fc("Embedded Chat Widget mounted successfully"),((e,t)=>{setTimeout((()=>{Fc("Performing post-mount theme verification...");const n=t.themeStore.currentTheme,i=e.classList.contains(n),o=e.getAttribute("data-theme"),s=e.style.colorScheme;if(Fc("Theme verification results:",{expectedTheme:n,hasCorrectClass:i,dataTheme:o,colorScheme:s,containerClasses:e.className}),i&&o===n&&s===n)Fc("Theme verification passed");else{Fc("Theme mismatch detected, fixing..."),Hc(e,n);const t=new CustomEvent("widget-theme-force-update",{detail:{theme:n}});e.dispatchEvent(t)}}),100)})(o,c),"chat-only"!==n.mode&&c.ticketsStore&&(await c.ticketsStore.fetchTickets(),Fc("Initial tickets fetched:",c.ticketsStore.tickets.length)),l=!0,window.addEventListener("widget-theme-change",(e=>{Fc("Theme change event received:",e.detail),e.detail.theme&&Hc(o,e.detail.theme)})),Fc("Widget initialization completed successfully")}catch(e){throw Fc("Failed to initialize Embedded Chat Widget:",e),e}};return a={destroy:()=>{Fc("Destroying widget..."),r&&(r.unmount(),o.innerHTML="",l=!1,c=null,n.enableGlobalOverride&&i&&(i.disableGlobalOverride(),Fc("Global security override disabled on widget destroy")),window.removeEventListener("widget-theme-change",(()=>{})),window.removeEventListener("widget-security-event",(()=>{})),Fc("Embedded widget destroyed"))},initialize:async()=>{l||await d()},setTheme:e=>{Fc(`Widget setTheme called with: ${e}`),(null==c?void 0:c.themeStore)?(c.themeStore.setTheme(e),Hc(o,e)):(Fc("Theme store not available, applying directly to container"),Hc(o,e))},getTheme:()=>(null==c?void 0:c.themeStore)?c.themeStore.currentTheme:o.getAttribute("data-theme")||"light",toggleTheme:()=>{const e=a.getTheme(),t="light"===e?"dark":"light";Fc(`Toggling theme from ${e} to ${t}`),a.setTheme(t)},loadTicket:async e=>{if(Fc("Loading ticket:",e),l||await d(),null==c?void 0:c.ticketsStore)return await c.ticketsStore.getTicketById(e),Fc("Ticket loaded:",c.ticketsStore.selectedTicket),c.ticketsStore.selectedTicket},sendMessage:async e=>{var t;Fc("Sending message:",e),l||await d();const n=null==(t=null==c?void 0:c.ticketsStore)?void 0:t.selectedTicket;if(!(null==n?void 0:n.chat_code))throw new Error("No active ticket or chat code available");const i=js();await i.sendMessage(e,n.chat_code)},getCurrentTicket:()=>{var e;return(null==(e=null==c?void 0:c.ticketsStore)?void 0:e.selectedTicket)||null},refreshTickets:async()=>{Fc("Refreshing tickets..."),l||await d(),(null==c?void 0:c.ticketsStore)&&(await c.ticketsStore.fetchTickets(),Fc("Tickets refreshed:",c.ticketsStore.tickets.length))},showTickets:async()=>{"chat-only"!==n.mode?(Fc("showTickets called"),l||await d(),(null==c?void 0:c.ticketsStore)&&(await c.ticketsStore.fetchTickets(),Fc("Tickets loaded:",c.ticketsStore.tickets.length))):Fc("showTickets called in chat-only mode - ignoring")},showChat:async e=>{Fc("showChat called",e),l||await d(),e&&(null==c?void 0:c.ticketsStore)&&(await c.ticketsStore.getTicketById(e),Fc("Ticket loaded:",c.ticketsStore.selectedTicket))},setFilters:async e=>{"chat-only"!==n.mode?(Fc("Setting filters:",e),l||await d(),(null==c?void 0:c.ticketsStore)&&(c.ticketsStore.setFilters(e),await c.ticketsStore.fetchTickets(),Fc("Filters applied, tickets:",c.ticketsStore.tickets.length))):Fc("setFilters called in chat-only mode - ignoring")},getConfig:()=>({...n}),updateChatOnlyConfig:e=>{"chat-only"===n.mode?(n.chatOnly={...n.chatOnly,...e},Fc("Chat-only config updated:",n.chatOnly)):Fc("updateChatOnlyConfig called in non-chat-only mode - ignoring")},checkSecurityStatus:()=>{var e,t;const i=window.CappuccinoSecurityHelpers;return{isSecureContext:(null==i?void 0:i.isSecureContext())||!1,hasCSP:!!document.querySelector('meta[http-equiv="Content-Security-Policy"]'),protocol:window.location.protocol,apiUrl:null==(e=window.WIDGET_CONFIG)?void 0:e.baseUrlApi,wsUrl:null==(t=window.WIDGET_CONFIG)?void 0:t.baseUrlWs,configSecurity:{autoAddCSP:n.autoAddCSP,enforceHTTPS:n.enforceHTTPS,enableGlobalOverride:n.enableGlobalOverride,debug:n.debug},globalOverrideStatus:(null==i?void 0:i.isGlobalOverrideEnabled())||!1,protectedDomains:(null==i?void 0:i.getWidgetDomains())||[]}},addCSP:(e=[])=>{const t=window.CappuccinoSecurityHelpers;return!!t&&t.addCSPMeta(e)},forceHTTPS:()=>{const e=window.CappuccinoSecurityHelpers;if(e){const t=a.getConfig();let n=!1;if(t.baseUrlApi&&t.baseUrlApi.startsWith("http://")){const i=e.sanitizeURL(t.baseUrlApi);a.updateConfig({baseUrlApi:i}),n=!0}if(t.baseUrlWs&&t.baseUrlWs.startsWith("ws://")){const e=t.baseUrlWs.replace("ws://","wss://");a.updateConfig({baseUrlWs:e}),n=!0}return n&&Fc("HTTPS enforcement applied to widget configuration"),n}return!1},testSecureConnection:async()=>{const e=window.CappuccinoSecurityHelpers;return e&&n.baseUrlApi?await e.testSecureConnection(n.baseUrlApi):{success:!1,httpsSupported:!1,error:"Security helpers not available",recommendations:["Ensure widget is properly loaded"]}},toggleGlobalOverride:()=>{const e=window.CappuccinoSecurityHelpers;return!!e&&(e.isGlobalOverrideEnabled()?(e.disableGlobalOverride(),Fc("Global security override disabled"),!1):(e.enableGlobalOverride(),Fc("Global security override enabled (scoped to widget domains)"),!0))},getProtectedDomains:()=>{const e=window.CappuccinoSecurityHelpers;return(null==e?void 0:e.getWidgetDomains())||[]},addProtectedDomain:e=>{const t=window.CappuccinoSecurityHelpers;return!!t&&(t.addWidgetDomain(e),Fc("Added protected domain:",e),!0)},widgetFetch:async(e,t)=>{const n=window.CappuccinoSecurityHelpers;return(null==n?void 0:n.widgetFetch)?await n.widgetFetch(e,t):await fetch(e,t)},debugTheme:()=>{var e;const t=a.getTheme(),n=null==(e=null==c?void 0:c.themeStore)?void 0:e.currentTheme;Fc("=== WIDGET THEME DEBUG ==="),Fc("Widget theme:",t),Fc("Store theme:",n),Fc("Container classes:",o.className),Fc("Container data-theme:",o.getAttribute("data-theme")),Fc("Container color-scheme:",o.style.colorScheme),(null==c?void 0:c.themeStore)&&c.themeStore.debug();const i=window.getComputedStyle(o);Fc("Computed background-color:",i.backgroundColor),Fc("Computed color:",i.color);const s=o.className.split(" ");return Fc("All container classes:",s),Fc("========================"),{widgetTheme:t,storeTheme:n,containerClasses:o.className,dataTheme:o.getAttribute("data-theme"),colorScheme:o.style.colorScheme,computedBackground:i.backgroundColor,computedColor:i.color}},debugSecurity:()=>{const e=a.checkSecurityStatus(),t=window.CappuccinoSecurityHelpers;return Fc("=== WIDGET SECURITY DEBUG ==="),Fc("Security Status:",e),Fc("Security Helpers Available:",!!t),Fc("CSP Meta Tag:",document.querySelector('meta[http-equiv="Content-Security-Policy"]')),Fc("Widget Config:",n),Fc("Protected Domains:",(null==t?void 0:t.getWidgetDomains())||[]),Fc("Global Override Enabled:",(null==t?void 0:t.isGlobalOverrideEnabled())||!1),Fc("Window Location:",{protocol:window.location.protocol,hostname:window.location.hostname,href:window.location.href}),Fc("=============================="),{securityStatus:e,securityHelpersAvailable:!!t,cspMetaTag:document.querySelector('meta[http-equiv="Content-Security-Policy"]'),widgetConfig:n,protectedDomains:(null==t?void 0:t.getWidgetDomains())||[],globalOverrideEnabled:(null==t?void 0:t.isGlobalOverrideEnabled())||!1,windowLocation:{protocol:window.location.protocol,hostname:window.location.hostname,href:window.location.href}}},forceTheme:e=>{const t=e||a.getTheme();Fc(`Force applying theme: ${t}`),Hc(o,t),(null==c?void 0:c.themeStore)&&c.themeStore.setTheme(t);const n=new CustomEvent("widget-theme-force-update",{detail:{theme:t}});return o.dispatchEvent(n),a.debugTheme()},getState:()=>{var e;return{isInitialized:l,theme:a.getTheme(),hasStores:!!c,containerElement:o,config:{...n},mode:n.mode,currentTicket:(null==(e=null==c?void 0:c.ticketsStore)?void 0:e.selectedTicket)||null,security:a.checkSecurityStatus()}},updateConfig:e=>{if(Fc("Updating configuration:",e),Object.assign(n,e),e.theme&&a.setTheme(e.theme),e.height&&(o.style.height=e.height),e.width&&(o.style.width=e.width),e.baseUrlApi||e.baseUrlWs||e.apiKey){const t=window.WIDGET_CONFIG;e.baseUrlApi&&(t.baseUrlApi=e.baseUrlApi),e.baseUrlWs&&(t.baseUrlWs=e.baseUrlWs),e.apiKey&&(t.apiKey=e.apiKey)}}},d().catch((e=>{jc("Failed to initialize widget:",e)})),n.debug&&(window.debugEmbeddedWidget=a.debugTheme,window.debugEmbeddedWidgetSecurity=a.debugSecurity,window.forceEmbeddedWidgetTheme=a.forceTheme,window.getEmbeddedWidgetState=a.getState,window.checkEmbeddedWidgetSecurity=a.checkSecurityStatus),a}window.CappuccinoChatEmbeddedWidget=Rc,e.createEmbeddedChatWidget=Rc,e.default=Rc,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
