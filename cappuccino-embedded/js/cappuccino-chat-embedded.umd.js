!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CappuccinoChatEmbeddedWidget={})}(this,(function(e){"use strict";var t=Object.defineProperty,i=(e,i,n)=>((e,i,n)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[i]=n)(e,"symbol"!=typeof i?i+"":i,n);function n(e,t){for(var i=0;i<t.length;i++){const n=t[i];if("string"!=typeof n&&!Array.isArray(n))for(const t in n)if("default"!==t&&!(t in e)){const i=Object.getOwnPropertyDescriptor(n,t);i&&Object.defineProperty(e,t,i.get?i:{enumerable:!0,get:()=>n[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}
/**
  * @vue/shared v3.4.38
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **/
/*! #__NO_SIDE_EFFECTS__ */function s(e,t){const i=new Set(e.split(","));return e=>i.has(e)}const o={},r=[],a=()=>{},l=()=>!1,c=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),d=e=>e.startsWith("onUpdate:"),u=Object.assign,h=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},g=Object.prototype.hasOwnProperty,p=(e,t)=>g.call(e,t),f=Array.isArray,m=e=>"[object Map]"===S(e),y=e=>"[object Set]"===S(e),v=e=>"[object Date]"===S(e),w=e=>"function"==typeof e,k=e=>"string"==typeof e,b=e=>"symbol"==typeof e,T=e=>null!==e&&"object"==typeof e,x=e=>(T(e)||w(e))&&w(e.then)&&w(e.catch),C=Object.prototype.toString,S=e=>C.call(e),_=e=>S(e).slice(8,-1),E=e=>"[object Object]"===S(e),A=e=>k(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,I=s(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),O=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},D=/-(\w)/g,P=O((e=>e.replace(D,((e,t)=>t?t.toUpperCase():"")))),M=/\B([A-Z])/g,W=O((e=>e.replace(M,"-$1").toLowerCase())),U=O((e=>e.charAt(0).toUpperCase()+e.slice(1))),L=O((e=>e?`on${U(e)}`:"")),R=(e,t)=>!Object.is(e,t),F=(e,...t)=>{for(let i=0;i<e.length;i++)e[i](...t)},j=(e,t,i,n=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:n,value:i})},H=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let $;const B=()=>$||($="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});function z(e){if(f(e)){const t={};for(let i=0;i<e.length;i++){const n=e[i],s=k(n)?q(n):z(n);if(s)for(const e in s)t[e]=s[e]}return t}if(k(e)||T(e))return e}const N=/;(?![^(]*\))/g,G=/:([^]+)/,V=/\/\*[^]*?\*\//g;function q(e){const t={};return e.replace(V,"").split(N).forEach((e=>{if(e){const i=e.split(G);i.length>1&&(t[i[0].trim()]=i[1].trim())}})),t}function K(e){let t="";if(k(e))t=e;else if(f(e))for(let i=0;i<e.length;i++){const n=K(e[i]);n&&(t+=n+" ")}else if(T(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}const Z=s("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function J(e){return!!e||""===e}function X(e,t){if(e===t)return!0;let i=v(e),n=v(t);if(i||n)return!(!i||!n)&&e.getTime()===t.getTime();if(i=b(e),n=b(t),i||n)return e===t;if(i=f(e),n=f(t),i||n)return!(!i||!n)&&function(e,t){if(e.length!==t.length)return!1;let i=!0;for(let n=0;i&&n<e.length;n++)i=X(e[n],t[n]);return i}(e,t);if(i=T(e),n=T(t),i||n){if(!i||!n)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e){const n=e.hasOwnProperty(i),s=t.hasOwnProperty(i);if(n&&!s||!n&&s||!X(e[i],t[i]))return!1}}return String(e)===String(t)}function Y(e,t){return e.findIndex((e=>X(e,t)))}const Q=e=>!(!e||!0!==e.__v_isRef),ee=e=>k(e)?e:null==e?"":f(e)||T(e)&&(e.toString===C||!w(e.toString))?Q(e)?ee(e.value):JSON.stringify(e,te,2):String(e),te=(e,t)=>Q(t)?te(e,t.value):m(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,i],n)=>(e[ie(t,n)+" =>"]=i,e)),{})}:y(t)?{[`Set(${t.size})`]:[...t.values()].map((e=>ie(e)))}:b(t)?ie(t):!T(t)||f(t)||E(t)?t:String(t),ie=(e,t="")=>{var i;return b(e)?`Symbol(${null!=(i=e.description)?i:t})`:e};
/**
  * @vue/reactivity v3.4.38
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **/
let ne,se;class oe{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ne,!e&&ne&&(this.index=(ne.scopes||(ne.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=ne;try{return ne=this,e()}finally{ne=t}}}on(){ne=this}off(){ne=this.parent}stop(e){if(this._active){let t,i;for(t=0,i=this.effects.length;t<i;t++)this.effects[t].stop();for(t=0,i=this.cleanups.length;t<i;t++)this.cleanups[t]();if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0,this._active=!1}}}function re(e){return new oe(e)}function ae(){return ne}class le{constructor(e,t,i,n){this.fn=e,this.trigger=t,this.scheduler=i,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,function(e,t=ne){t&&t.active&&t.effects.push(e)}(this,n)}get dirty(){if(2===this._dirtyLevel||3===this._dirtyLevel){this._dirtyLevel=1,fe();for(let e=0;e<this._depsLength;e++){const t=this.deps[e];if(t.computed&&(t.computed.value,this._dirtyLevel>=4))break}1===this._dirtyLevel&&(this._dirtyLevel=0),me()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=he,t=se;try{return he=!0,se=this,this._runnings++,ce(this),this.fn()}finally{de(this),this._runnings--,se=t,he=e}}stop(){this.active&&(ce(this),de(this),this.onStop&&this.onStop(),this.active=!1)}}function ce(e){e._trackId++,e._depsLength=0}function de(e){if(e.deps.length>e._depsLength){for(let t=e._depsLength;t<e.deps.length;t++)ue(e.deps[t],e);e.deps.length=e._depsLength}}function ue(e,t){const i=e.get(t);void 0!==i&&t._trackId!==i&&(e.delete(t),0===e.size&&e.cleanup())}let he=!0,ge=0;const pe=[];function fe(){pe.push(he),he=!1}function me(){const e=pe.pop();he=void 0===e||e}function ye(){ge++}function ve(){for(ge--;!ge&&ke.length;)ke.shift()()}function we(e,t,i){if(t.get(e)!==e._trackId){t.set(e,e._trackId);const i=e.deps[e._depsLength];i!==t?(i&&ue(i,e),e.deps[e._depsLength++]=t):e._depsLength++}}const ke=[];function be(e,t,i){ye();for(const n of e.keys()){let i;n._dirtyLevel<t&&(null!=i?i:i=e.get(n)===n._trackId)&&(n._shouldSchedule||(n._shouldSchedule=0===n._dirtyLevel),n._dirtyLevel=t),n._shouldSchedule&&(null!=i?i:i=e.get(n)===n._trackId)&&(n.trigger(),n._runnings&&!n.allowRecurse||2===n._dirtyLevel||(n._shouldSchedule=!1,n.scheduler&&ke.push(n.scheduler)))}ve()}const Te=(e,t)=>{const i=new Map;return i.cleanup=e,i.computed=t,i},xe=new WeakMap,Ce=Symbol(""),Se=Symbol("");function _e(e,t,i){if(he&&se){let t=xe.get(e);t||xe.set(e,t=new Map);let n=t.get(i);n||t.set(i,n=Te((()=>t.delete(i)))),we(se,n)}}function Ee(e,t,i,n,s,o){const r=xe.get(e);if(!r)return;let a=[];if("clear"===t)a=[...r.values()];else if("length"===i&&f(e)){const e=Number(n);r.forEach(((t,i)=>{("length"===i||!b(i)&&i>=e)&&a.push(t)}))}else switch(void 0!==i&&a.push(r.get(i)),t){case"add":f(e)?A(i)&&a.push(r.get("length")):(a.push(r.get(Ce)),m(e)&&a.push(r.get(Se)));break;case"delete":f(e)||(a.push(r.get(Ce)),m(e)&&a.push(r.get(Se)));break;case"set":m(e)&&a.push(r.get(Ce))}ye();for(const l of a)l&&be(l,4);ve()}const Ae=s("__proto__,__v_isRef,__isVue"),Ie=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(b)),Oe=De();function De(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const i=yt(this);for(let t=0,s=this.length;t<s;t++)_e(i,0,t+"");const n=i[t](...e);return-1===n||!1===n?i[t](...e.map(yt)):n}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){fe(),ye();const i=yt(this)[t].apply(this,e);return ve(),me(),i}})),e}function Pe(e){b(e)||(e=String(e));const t=yt(this);return _e(t,0,e),t.hasOwnProperty(e)}class Me{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,i){const n=this._isReadonly,s=this._isShallow;if("__v_isReactive"===t)return!n;if("__v_isReadonly"===t)return n;if("__v_isShallow"===t)return s;if("__v_raw"===t)return i===(n?s?ct:lt:s?at:rt).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=f(e);if(!n){if(o&&p(Oe,t))return Reflect.get(Oe,t,i);if("hasOwnProperty"===t)return Pe}const r=Reflect.get(e,t,i);return(b(t)?Ie.has(t):Ae(t))?r:(n||_e(e,0,t),s?r:Ct(r)?o&&A(t)?r:r.value:T(r)?n?ut(r):dt(r):r)}}class We extends Me{constructor(e=!1){super(!1,e)}set(e,t,i,n){let s=e[t];if(!this._isShallow){const t=pt(s);if(ft(i)||pt(i)||(s=yt(s),i=yt(i)),!f(e)&&Ct(s)&&!Ct(i))return!t&&(s.value=i,!0)}const o=f(e)&&A(t)?Number(t)<e.length:p(e,t),r=Reflect.set(e,t,i,n);return e===yt(n)&&(o?R(i,s)&&Ee(e,"set",t,i):Ee(e,"add",t,i)),r}deleteProperty(e,t){const i=p(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&i&&Ee(e,"delete",t,void 0),n}has(e,t){const i=Reflect.has(e,t);return b(t)&&Ie.has(t)||_e(e,0,t),i}ownKeys(e){return _e(e,0,f(e)?"length":Ce),Reflect.ownKeys(e)}}class Ue extends Me{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const Le=new We,Re=new Ue,Fe=new We(!0),je=e=>e,He=e=>Reflect.getPrototypeOf(e);function $e(e,t,i=!1,n=!1){const s=yt(e=e.__v_raw),o=yt(t);i||(R(t,o)&&_e(s,0,t),_e(s,0,o));const{has:r}=He(s),a=n?je:i?kt:wt;return r.call(s,t)?a(e.get(t)):r.call(s,o)?a(e.get(o)):void(e!==s&&e.get(t))}function Be(e,t=!1){const i=this.__v_raw,n=yt(i),s=yt(e);return t||(R(e,s)&&_e(n,0,e),_e(n,0,s)),e===s?i.has(e):i.has(e)||i.has(s)}function ze(e,t=!1){return e=e.__v_raw,!t&&_e(yt(e),0,Ce),Reflect.get(e,"size",e)}function Ne(e,t=!1){t||ft(e)||pt(e)||(e=yt(e));const i=yt(this);return He(i).has.call(i,e)||(i.add(e),Ee(i,"add",e,e)),this}function Ge(e,t,i=!1){i||ft(t)||pt(t)||(t=yt(t));const n=yt(this),{has:s,get:o}=He(n);let r=s.call(n,e);r||(e=yt(e),r=s.call(n,e));const a=o.call(n,e);return n.set(e,t),r?R(t,a)&&Ee(n,"set",e,t):Ee(n,"add",e,t),this}function Ve(e){const t=yt(this),{has:i,get:n}=He(t);let s=i.call(t,e);s||(e=yt(e),s=i.call(t,e)),n&&n.call(t,e);const o=t.delete(e);return s&&Ee(t,"delete",e,void 0),o}function qe(){const e=yt(this),t=0!==e.size,i=e.clear();return t&&Ee(e,"clear",void 0,void 0),i}function Ke(e,t){return function(i,n){const s=this,o=s.__v_raw,r=yt(o),a=t?je:e?kt:wt;return!e&&_e(r,0,Ce),o.forEach(((e,t)=>i.call(n,a(e),a(t),s)))}}function Ze(e,t,i){return function(...n){const s=this.__v_raw,o=yt(s),r=m(o),a="entries"===e||e===Symbol.iterator&&r,l="keys"===e&&r,c=s[e](...n),d=i?je:t?kt:wt;return!t&&_e(o,0,l?Se:Ce),{next(){const{value:e,done:t}=c.next();return t?{value:e,done:t}:{value:a?[d(e[0]),d(e[1])]:d(e),done:t}},[Symbol.iterator](){return this}}}}function Je(e){return function(...t){return"delete"!==e&&("clear"===e?void 0:this)}}function Xe(){const e={get(e){return $e(this,e)},get size(){return ze(this)},has:Be,add:Ne,set:Ge,delete:Ve,clear:qe,forEach:Ke(!1,!1)},t={get(e){return $e(this,e,!1,!0)},get size(){return ze(this)},has:Be,add(e){return Ne.call(this,e,!0)},set(e,t){return Ge.call(this,e,t,!0)},delete:Ve,clear:qe,forEach:Ke(!1,!0)},i={get(e){return $e(this,e,!0)},get size(){return ze(this,!0)},has(e){return Be.call(this,e,!0)},add:Je("add"),set:Je("set"),delete:Je("delete"),clear:Je("clear"),forEach:Ke(!0,!1)},n={get(e){return $e(this,e,!0,!0)},get size(){return ze(this,!0)},has(e){return Be.call(this,e,!0)},add:Je("add"),set:Je("set"),delete:Je("delete"),clear:Je("clear"),forEach:Ke(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((s=>{e[s]=Ze(s,!1,!1),i[s]=Ze(s,!0,!1),t[s]=Ze(s,!1,!0),n[s]=Ze(s,!0,!0)})),[e,i,t,n]}const[Ye,Qe,et,tt]=Xe();function it(e,t){const i=t?e?tt:et:e?Qe:Ye;return(t,n,s)=>"__v_isReactive"===n?!e:"__v_isReadonly"===n?e:"__v_raw"===n?t:Reflect.get(p(i,n)&&n in t?i:t,n,s)}const nt={get:it(!1,!1)},st={get:it(!1,!0)},ot={get:it(!0,!1)},rt=new WeakMap,at=new WeakMap,lt=new WeakMap,ct=new WeakMap;function dt(e){return pt(e)?e:ht(e,!1,Le,nt,rt)}function ut(e){return ht(e,!0,Re,ot,lt)}function ht(e,t,i,n,s){if(!T(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const o=s.get(e);if(o)return o;const r=(a=e).__v_skip||!Object.isExtensible(a)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}(_(a));var a;if(0===r)return e;const l=new Proxy(e,2===r?n:i);return s.set(e,l),l}function gt(e){return pt(e)?gt(e.__v_raw):!(!e||!e.__v_isReactive)}function pt(e){return!(!e||!e.__v_isReadonly)}function ft(e){return!(!e||!e.__v_isShallow)}function mt(e){return!!e&&!!e.__v_raw}function yt(e){const t=e&&e.__v_raw;return t?yt(t):e}function vt(e){return Object.isExtensible(e)&&j(e,"__v_skip",!0),e}const wt=e=>T(e)?dt(e):e,kt=e=>T(e)?ut(e):e;class bt{constructor(e,t,i,n){this.getter=e,this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new le((()=>e(this._value)),(()=>xt(this,2===this.effect._dirtyLevel?2:3))),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=i}get value(){const e=yt(this);return e._cacheable&&!e.effect.dirty||!R(e._value,e._value=e.effect.run())||xt(e,4),Tt(e),e.effect._dirtyLevel>=2&&xt(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function Tt(e){var t;he&&se&&(e=yt(e),we(se,null!=(t=e.dep)?t:e.dep=Te((()=>e.dep=void 0),e instanceof bt?e:void 0)))}function xt(e,t=4,i,n){const s=(e=yt(e)).dep;s&&be(s,t)}function Ct(e){return!(!e||!0!==e.__v_isRef)}function St(e){return function(e,t){if(Ct(e))return e;return new _t(e,t)}(e,!1)}class _t{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:yt(e),this._value=t?e:wt(e)}get value(){return Tt(this),this._value}set value(e){const t=this.__v_isShallow||ft(e)||pt(e);e=t?e:yt(e),R(e,this._rawValue)&&(this._rawValue,this._rawValue=e,this._value=t?e:wt(e),xt(this,4))}}const Et={get:(e,t,i)=>{return Ct(n=Reflect.get(e,t,i))?n.value:n;var n},set:(e,t,i,n)=>{const s=e[t];return Ct(s)&&!Ct(i)?(s.value=i,!0):Reflect.set(e,t,i,n)}};function At(e){return gt(e)?e:new Proxy(e,Et)}class It{constructor(e,t,i){this._object=e,this._key=t,this._defaultValue=i,this.__v_isRef=!0}get value(){const e=this._object[this._key];return void 0===e?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return function(e,t){const i=xe.get(e);return i&&i.get(t)}(yt(this._object),this._key)}}class Ot{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function Dt(e,t,i){return Ct(e)?e:w(e)?new Ot(e):T(e)&&arguments.length>1?Pt(e,t,i):St(e)}function Pt(e,t,i){const n=e[t];return Ct(n)?n:new It(e,t,i)}
/**
  * @vue/runtime-core v3.4.38
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **/function Mt(e,t,i,n){try{return n?e(...n):e()}catch(s){Ut(s,t,i)}}function Wt(e,t,i,n){if(w(e)){const s=Mt(e,t,i,n);return s&&x(s)&&s.catch((e=>{Ut(e,t,i)})),s}if(f(e)){const s=[];for(let o=0;o<e.length;o++)s.push(Wt(e[o],t,i,n));return s}}function Ut(e,t,i,n=!0){t&&t.vnode;if(t){let n=t.parent;const s=t.proxy,o=`https://vuejs.org/error-reference/#runtime-${i}`;for(;n;){const t=n.ec;if(t)for(let i=0;i<t.length;i++)if(!1===t[i](e,s,o))return;n=n.parent}const r=t.appContext.config.errorHandler;if(r)return fe(),Mt(r,null,10,[e,s,o]),void me()}!function(e){console.error(e)}(e,0,0,n)}let Lt=!1,Rt=!1;const Ft=[];let jt=0;const Ht=[];let $t=null,Bt=0;const zt=Promise.resolve();let Nt=null;function Gt(e){const t=Nt||zt;return e?t.then(this?e.bind(this):e):t}function Vt(e){Ft.length&&Ft.includes(e,Lt&&e.allowRecurse?jt+1:jt)||(null==e.id?Ft.push(e):Ft.splice(function(e){let t=jt+1,i=Ft.length;for(;t<i;){const n=t+i>>>1,s=Ft[n],o=Jt(s);o<e||o===e&&s.pre?t=n+1:i=n}return t}(e.id),0,e),qt())}function qt(){Lt||Rt||(Rt=!0,Nt=zt.then(Yt))}function Kt(e,t,i=(Lt?jt+1:0)){for(;i<Ft.length;i++){const t=Ft[i];if(t&&t.pre){if(e&&t.id!==e.uid)continue;Ft.splice(i,1),i--,t()}}}function Zt(e){if(Ht.length){const e=[...new Set(Ht)].sort(((e,t)=>Jt(e)-Jt(t)));if(Ht.length=0,$t)return void $t.push(...e);for($t=e,Bt=0;Bt<$t.length;Bt++){const e=$t[Bt];!1!==e.active&&e()}$t=null,Bt=0}}const Jt=e=>null==e.id?1/0:e.id,Xt=(e,t)=>{const i=Jt(e)-Jt(t);if(0===i){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return i};function Yt(e){Rt=!1,Lt=!0,Ft.sort(Xt);try{for(jt=0;jt<Ft.length;jt++){const e=Ft[jt];e&&!1!==e.active&&Mt(e,e.i,e.i?15:14)}}finally{jt=0,Ft.length=0,Zt(),Lt=!1,Nt=null,(Ft.length||Ht.length)&&Yt()}}let Qt=null,ei=null;function ti(e){const t=Qt;return Qt=e,ei=e&&e.type.__scopeId||null,t}function ii(e){ei=e}function ni(){ei=null}function si(e,t){if(null===Qt)return e;const i=xs(Qt),n=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[e,r,a,l=o]=t[s];e&&(w(e)&&(e={mounted:e,updated:e}),e.deep&&On(r),n.push({dir:e,instance:i,value:r,oldValue:void 0,arg:a,modifiers:l}))}return e}function oi(e,t,i,n){const s=e.dirs,o=t&&t.dirs;for(let r=0;r<s.length;r++){const a=s[r];o&&(a.oldValue=o[r].value);let l=a.dir[n];l&&(fe(),Wt(l,i,8,[e.el,a,e,t]),me())}}function ri(e,t){6&e.shapeFlag&&e.component?ri(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}
/*! #__NO_SIDE_EFFECTS__ */function ai(e,t){return w(e)?(()=>u({name:e.name},t,{setup:e}))():e}const li=e=>!!e.type.__asyncLoader,ci=e=>e.type.__isKeepAlive;function di(e,t){hi(e,"a",t)}function ui(e,t){hi(e,"da",t)}function hi(e,t,i=ps){const n=e.__wdc||(e.__wdc=()=>{let t=i;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(pi(t,n,i),i){let e=i.parent;for(;e&&e.parent;)ci(e.parent.vnode)&&gi(n,t,i,e),e=e.parent}}function gi(e,t,i,n){const s=pi(t,e,n,!0);bi((()=>{h(n[t],s)}),i)}function pi(e,t,i=ps,n=!1){if(i){const s=i[e]||(i[e]=[]),o=t.__weh||(t.__weh=(...n)=>{fe();const s=fs(i),o=Wt(t,i,e,n);return s(),me(),o});return n?s.unshift(o):s.push(o),o}}const fi=e=>(t,i=ps)=>{ws&&"sp"!==e||pi(e,((...e)=>t(...e)),i)},mi=fi("bm"),yi=fi("m"),vi=fi("bu"),wi=fi("u"),ki=fi("bum"),bi=fi("um"),Ti=fi("sp"),xi=fi("rtg"),Ci=fi("rtc");function Si(e,t=ps){pi("ec",e,t)}const _i=Symbol.for("v-ndc");function Ei(e,t,i,n){let s;const o=i;if(f(e)||k(e)){s=new Array(e.length);for(let i=0,n=e.length;i<n;i++)s[i]=t(e[i],i,void 0,o)}else if("number"==typeof e){s=new Array(e);for(let i=0;i<e;i++)s[i]=t(i+1,i,void 0,o)}else if(T(e))if(e[Symbol.iterator])s=Array.from(e,((e,i)=>t(e,i,void 0,o)));else{const i=Object.keys(e);s=new Array(i.length);for(let n=0,r=i.length;n<r;n++){const r=i[n];s[n]=t(e[r],r,n,o)}}else s=[];return s}const Ai=e=>e?ys(e)?xs(e):Ai(e.parent):null,Ii=u(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ai(e.parent),$root:e=>Ai(e.root),$emit:e=>e.emit,$options:e=>Ri(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,Vt(e.update)}),$nextTick:e=>e.n||(e.n=Gt.bind(e.proxy)),$watch:e=>An.bind(e)}),Oi=(e,t)=>e!==o&&!e.__isScriptSetup&&p(e,t),Di={get({_:e},t){if("__v_skip"===t)return!0;const{ctx:i,setupState:n,data:s,props:r,accessCache:a,type:l,appContext:c}=e;let d;if("$"!==t[0]){const l=a[t];if(void 0!==l)switch(l){case 1:return n[t];case 2:return s[t];case 4:return i[t];case 3:return r[t]}else{if(Oi(n,t))return a[t]=1,n[t];if(s!==o&&p(s,t))return a[t]=2,s[t];if((d=e.propsOptions[0])&&p(d,t))return a[t]=3,r[t];if(i!==o&&p(i,t))return a[t]=4,i[t];Mi&&(a[t]=0)}}const u=Ii[t];let h,g;return u?("$attrs"===t&&_e(e.attrs,0,""),u(e)):(h=l.__cssModules)&&(h=h[t])?h:i!==o&&p(i,t)?(a[t]=4,i[t]):(g=c.config.globalProperties,p(g,t)?g[t]:void 0)},set({_:e},t,i){const{data:n,setupState:s,ctx:r}=e;return Oi(s,t)?(s[t]=i,!0):n!==o&&p(n,t)?(n[t]=i,!0):!p(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(r[t]=i,!0))},has({_:{data:e,setupState:t,accessCache:i,ctx:n,appContext:s,propsOptions:r}},a){let l;return!!i[a]||e!==o&&p(e,a)||Oi(t,a)||(l=r[0])&&p(l,a)||p(n,a)||p(Ii,a)||p(s.config.globalProperties,a)},defineProperty(e,t,i){return null!=i.get?e._.accessCache[t]=0:p(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};function Pi(e){return f(e)?e.reduce(((e,t)=>(e[t]=null,e)),{}):e}let Mi=!0;function Wi(e){const t=Ri(e),i=e.proxy,n=e.ctx;Mi=!1,t.beforeCreate&&Ui(t.beforeCreate,e,"bc");const{data:s,computed:o,methods:r,watch:l,provide:c,inject:d,created:u,beforeMount:h,mounted:g,beforeUpdate:p,updated:m,activated:y,deactivated:v,beforeDestroy:k,beforeUnmount:b,destroyed:x,unmounted:C,render:S,renderTracked:_,renderTriggered:E,errorCaptured:A,serverPrefetch:I,expose:O,inheritAttrs:D,components:P,directives:M,filters:W}=t;if(d&&function(e,t){f(e)&&(e=$i(e));for(const i in e){const n=e[i];let s;s=T(n)?"default"in n?Zi(n.from||i,n.default,!0):Zi(n.from||i):Zi(n),Ct(s)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:e=>s.value=e}):t[i]=s}}(d,n,null),r)for(const a in r){const e=r[a];w(e)&&(n[a]=e.bind(i))}if(s){const t=s.call(i,i);T(t)&&(e.data=dt(t))}if(Mi=!0,o)for(const f in o){const e=o[f],t=w(e)?e.bind(i,i):w(e.get)?e.get.bind(i,i):a,s=!w(e)&&w(e.set)?e.set.bind(i):a,r=Cs({get:t,set:s});Object.defineProperty(n,f,{enumerable:!0,configurable:!0,get:()=>r.value,set:e=>r.value=e})}if(l)for(const a in l)Li(l[a],n,i,a);if(c){const e=w(c)?c.call(i):c;Reflect.ownKeys(e).forEach((t=>{!function(e,t){if(ps){let i=ps.provides;const n=ps.parent&&ps.parent.provides;n===i&&(i=ps.provides=Object.create(n)),i[e]=t}else;}(t,e[t])}))}function U(e,t){f(t)?t.forEach((t=>e(t.bind(i)))):t&&e(t.bind(i))}if(u&&Ui(u,e,"c"),U(mi,h),U(yi,g),U(vi,p),U(wi,m),U(di,y),U(ui,v),U(Si,A),U(Ci,_),U(xi,E),U(ki,b),U(bi,C),U(Ti,I),f(O))if(O.length){const t=e.exposed||(e.exposed={});O.forEach((e=>{Object.defineProperty(t,e,{get:()=>i[e],set:t=>i[e]=t})}))}else e.exposed||(e.exposed={});S&&e.render===a&&(e.render=S),null!=D&&(e.inheritAttrs=D),P&&(e.components=P),M&&(e.directives=M)}function Ui(e,t,i){Wt(f(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,i)}function Li(e,t,i,n){const s=n.includes(".")?In(i,n):()=>i[n];if(k(e)){const i=t[e];w(i)&&_n(s,i)}else if(w(e))_n(s,e.bind(i));else if(T(e))if(f(e))e.forEach((e=>Li(e,t,i,n)));else{const n=w(e.handler)?e.handler.bind(i):t[e.handler];w(n)&&_n(s,n,e)}}function Ri(e){const t=e.type,{mixins:i,extends:n}=t,{mixins:s,optionsCache:o,config:{optionMergeStrategies:r}}=e.appContext,a=o.get(t);let l;return a?l=a:s.length||i||n?(l={},s.length&&s.forEach((e=>Fi(l,e,r,!0))),Fi(l,t,r)):l=t,T(t)&&o.set(t,l),l}function Fi(e,t,i,n=!1){const{mixins:s,extends:o}=t;o&&Fi(e,o,i,!0),s&&s.forEach((t=>Fi(e,t,i,!0)));for(const r in t)if(n&&"expose"===r);else{const n=ji[r]||i&&i[r];e[r]=n?n(e[r],t[r]):t[r]}return e}const ji={data:Hi,props:Ni,emits:Ni,methods:zi,computed:zi,beforeCreate:Bi,created:Bi,beforeMount:Bi,mounted:Bi,beforeUpdate:Bi,updated:Bi,beforeDestroy:Bi,beforeUnmount:Bi,destroyed:Bi,unmounted:Bi,activated:Bi,deactivated:Bi,errorCaptured:Bi,serverPrefetch:Bi,components:zi,directives:zi,watch:function(e,t){if(!e)return t;if(!t)return e;const i=u(Object.create(null),e);for(const n in t)i[n]=Bi(e[n],t[n]);return i},provide:Hi,inject:function(e,t){return zi($i(e),$i(t))}};function Hi(e,t){return t?e?function(){return u(w(e)?e.call(this,this):e,w(t)?t.call(this,this):t)}:t:e}function $i(e){if(f(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function Bi(e,t){return e?[...new Set([].concat(e,t))]:t}function zi(e,t){return e?u(Object.create(null),e,t):t}function Ni(e,t){return e?f(e)&&f(t)?[...new Set([...e,...t])]:u(Object.create(null),Pi(e),Pi(null!=t?t:{})):t}function Gi(){return{app:null,config:{isNativeTag:l,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Vi=0;function qi(e,t){return function(i,n=null){w(i)||(i=u({},i)),null==n||T(n)||(n=null);const s=Gi(),o=new WeakSet;let r=!1;const a=s.app={_uid:Vi++,_component:i,_props:n,_container:null,_context:s,_instance:null,version:Ss,get config(){return s.config},set config(e){},use:(e,...t)=>(o.has(e)||(e&&w(e.install)?(o.add(e),e.install(a,...t)):w(e)&&(o.add(e),e(a,...t))),a),mixin:e=>(s.mixins.includes(e)||s.mixins.push(e),a),component:(e,t)=>t?(s.components[e]=t,a):s.components[e],directive:(e,t)=>t?(s.directives[e]=t,a):s.directives[e],mount(o,l,c){if(!r){const d=ts(i,n);return d.appContext=s,!0===c?c="svg":!1===c&&(c=void 0),l&&t?t(d,o):e(d,o,c),r=!0,a._container=o,o.__vue_app__=a,xs(d.component)}},unmount(){r&&(e(null,a._container),delete a._container.__vue_app__)},provide:(e,t)=>(s.provides[e]=t,a),runWithContext(e){const t=Ki;Ki=a;try{return e()}finally{Ki=t}}};return a}}let Ki=null;function Zi(e,t,i=!1){const n=ps||Qt;if(n||Ki){const s=Ki?Ki._context.provides:n?null==n.parent?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return i&&w(t)?t.call(n&&n.proxy):t}}const Ji={},Xi=()=>Object.create(Ji),Yi=e=>Object.getPrototypeOf(e)===Ji;function Qi(e,t,i,n=!1){const s={},o=Xi();e.propsDefaults=Object.create(null),en(e,t,s,o);for(const r in e.propsOptions[0])r in s||(s[r]=void 0);i?e.props=n?s:ht(s,!1,Fe,st,at):e.type.props?e.props=s:e.props=o,e.attrs=o}function en(e,t,i,n){const[s,r]=e.propsOptions;let a,l=!1;if(t)for(let o in t){if(I(o))continue;const c=t[o];let d;s&&p(s,d=P(o))?r&&r.includes(d)?(a||(a={}))[d]=c:i[d]=c:Wn(e.emitsOptions,o)||o in n&&c===n[o]||(n[o]=c,l=!0)}if(r){const t=yt(i),n=a||o;for(let o=0;o<r.length;o++){const a=r[o];i[a]=tn(s,t,a,n[a],e,!p(n,a))}}return l}function tn(e,t,i,n,s,o){const r=e[i];if(null!=r){const e=p(r,"default");if(e&&void 0===n){const e=r.default;if(r.type!==Function&&!r.skipFactory&&w(e)){const{propsDefaults:o}=s;if(i in o)n=o[i];else{const r=fs(s);n=o[i]=e.call(null,t),r()}}else n=e}r[0]&&(o&&!e?n=!1:!r[1]||""!==n&&n!==W(i)||(n=!0))}return n}const nn=new WeakMap;function sn(e,t,i=!1){const n=i?nn:t.propsCache,s=n.get(e);if(s)return s;const a=e.props,l={},c=[];let d=!1;if(!w(e)){const n=e=>{d=!0;const[i,n]=sn(e,t,!0);u(l,i),n&&c.push(...n)};!i&&t.mixins.length&&t.mixins.forEach(n),e.extends&&n(e.extends),e.mixins&&e.mixins.forEach(n)}if(!a&&!d)return T(e)&&n.set(e,r),r;if(f(a))for(let r=0;r<a.length;r++){const e=P(a[r]);on(e)&&(l[e]=o)}else if(a)for(const o in a){const e=P(o);if(on(e)){const t=a[o],i=l[e]=f(t)||w(t)?{type:t}:u({},t),n=i.type;let s=!1,r=!0;if(f(n))for(let e=0;e<n.length;++e){const t=n[e],i=w(t)&&t.name;if("Boolean"===i){s=!0;break}"String"===i&&(r=!1)}else s=w(n)&&"Boolean"===n.name;i[0]=s,i[1]=r,(s||p(i,"default"))&&c.push(e)}}const h=[l,c];return T(e)&&n.set(e,h),h}function on(e){return"$"!==e[0]&&!I(e)}const rn=e=>"_"===e[0]||"$stable"===e,an=e=>f(e)?e.map(rs):[rs(e)],ln=(e,t,i)=>{if(t._n)return t;const n=function(e,t=Qt){if(!t)return e;if(e._n)return e;const i=(...n)=>{i._d&&qn(-1);const s=ti(t);let o;try{o=e(...n)}finally{ti(s),i._d&&qn(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}(((...e)=>an(t(...e))),i);return n._c=!1,n},cn=(e,t,i)=>{const n=e._ctx;for(const s in e){if(rn(s))continue;const i=e[s];if(w(i))t[s]=ln(0,i,n);else if(null!=i){const e=an(i);t[s]=()=>e}}},dn=(e,t)=>{const i=an(t);e.slots.default=()=>i},un=(e,t,i)=>{for(const n in t)(i||"_"!==n)&&(e[n]=t[n])},hn=(e,t,i)=>{const n=e.slots=Xi();if(32&e.vnode.shapeFlag){const e=t._;e?(un(n,t,i),i&&j(n,"_",e,!0)):cn(t,n)}else t&&dn(e,t)},gn=(e,t,i)=>{const{vnode:n,slots:s}=e;let r=!0,a=o;if(32&n.shapeFlag){const e=t._;e?i&&1===e?r=!1:un(s,t,i):(r=!t.$stable,cn(t,s)),a=t}else t&&(dn(e,t),a={default:1});if(r)for(const o in s)rn(o)||null!=a[o]||delete s[o]};function pn(e,t,i,n,s=!1){if(f(e))return void e.forEach(((e,o)=>pn(e,t&&(f(t)?t[o]:t),i,n,s)));if(li(n)&&!s)return;const r=4&n.shapeFlag?xs(n.component):n.el,a=s?null:r,{i:l,r:c}=e,d=t&&t.r,u=l.refs===o?l.refs={}:l.refs,g=l.setupState;if(null!=d&&d!==c&&(k(d)?(u[d]=null,p(g,d)&&(g[d]=null)):Ct(d)&&(d.value=null)),w(c))Mt(c,l,12,[a,u]);else{const t=k(c),n=Ct(c);if(t||n){const o=()=>{if(e.f){const i=t?p(g,c)?g[c]:u[c]:c.value;s?f(i)&&h(i,r):f(i)?i.includes(r)||i.push(r):t?(u[c]=[r],p(g,c)&&(g[c]=u[c])):(c.value=[r],e.k&&(u[e.k]=c.value))}else t?(u[c]=a,p(g,c)&&(g[c]=a)):n&&(c.value=a,e.k&&(u[e.k]=a))};a?(o.id=-1,mn(o,i)):o()}}}const fn=Symbol("_vte"),mn=function(e,t){t&&t.pendingBranch?f(e)?t.effects.push(...e):t.effects.push(e):(f(i=e)?Ht.push(...i):$t&&$t.includes(i,i.allowRecurse?Bt+1:Bt)||Ht.push(i),qt());var i};function yn(e){return function(e){B().__VUE__=!0;const{insert:t,remove:i,patchProp:n,createElement:s,createText:l,createComment:c,setText:d,setElementText:u,parentNode:h,nextSibling:g,setScopeId:f=a,insertStaticContent:m}=e,y=(e,t,i,n=null,s=null,o=null,r=void 0,a=null,l=!!t.dynamicChildren)=>{if(e===t)return;e&&!Xn(e,t)&&(n=X(e),V(e,s,o,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:c,ref:d,shapeFlag:u}=t;switch(c){case Hn:v(e,t,i,n);break;case $n:w(e,t,i,n);break;case Bn:null==e&&k(t,i,n,r);break;case jn:M(e,t,i,n,s,o,r,a,l);break;default:1&u?C(e,t,i,n,s,o,r,a,l):6&u?U(e,t,i,n,s,o,r,a,l):(64&u||128&u)&&c.process(e,t,i,n,s,o,r,a,l,ee)}null!=d&&s&&pn(d,e&&e.ref,o,t||e,!t)},v=(e,i,n,s)=>{if(null==e)t(i.el=l(i.children),n,s);else{const t=i.el=e.el;i.children!==e.children&&d(t,i.children)}},w=(e,i,n,s)=>{null==e?t(i.el=c(i.children||""),n,s):i.el=e.el},k=(e,t,i,n)=>{[e.el,e.anchor]=m(e.children,t,i,n,e.el,e.anchor)},b=({el:e,anchor:i},n,s)=>{let o;for(;e&&e!==i;)o=g(e),t(e,n,s),e=o;t(i,n,s)},T=({el:e,anchor:t})=>{let n;for(;e&&e!==t;)n=g(e),i(e),e=n;i(t)},C=(e,t,i,n,s,o,r,a,l)=>{"svg"===t.type?r="svg":"math"===t.type&&(r="mathml"),null==e?S(t,i,n,s,o,r,a,l):A(e,t,s,o,r,a,l)},S=(e,i,o,r,a,l,c,d)=>{let h,g;const{props:p,shapeFlag:f,transition:m,dirs:y}=e;if(h=e.el=s(e.type,l,p&&p.is,p),8&f?u(h,e.children):16&f&&E(e.children,h,null,r,a,vn(e,l),c,d),y&&oi(e,null,r,"created"),_(h,e,e.scopeId,c,r),p){for(const e in p)"value"===e||I(e)||n(h,e,null,p[e],l,r);"value"in p&&n(h,"value",null,p.value,l),(g=p.onVnodeBeforeMount)&&cs(g,r,e)}y&&oi(e,null,r,"beforeMount");const v=function(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}(a,m);v&&m.beforeEnter(h),t(h,i,o),((g=p&&p.onVnodeMounted)||v||y)&&mn((()=>{g&&cs(g,r,e),v&&m.enter(h),y&&oi(e,null,r,"mounted")}),a)},_=(e,t,i,n,s)=>{if(i&&f(e,i),n)for(let o=0;o<n.length;o++)f(e,n[o]);if(s){if(t===s.subTree){const t=s.vnode;_(e,t,t.scopeId,t.slotScopeIds,s.parent)}}},E=(e,t,i,n,s,o,r,a,l=0)=>{for(let c=l;c<e.length;c++){const l=e[c]=a?as(e[c]):rs(e[c]);y(null,l,t,i,n,s,o,r,a)}},A=(e,t,i,s,r,a,l)=>{const c=t.el=e.el;let{patchFlag:d,dynamicChildren:h,dirs:g}=t;d|=16&e.patchFlag;const p=e.props||o,f=t.props||o;let m;if(i&&wn(i,!1),(m=f.onVnodeBeforeUpdate)&&cs(m,i,t,e),g&&oi(t,e,i,"beforeUpdate"),i&&wn(i,!0),(p.innerHTML&&null==f.innerHTML||p.textContent&&null==f.textContent)&&u(c,""),h?O(e.dynamicChildren,h,c,i,s,vn(t,r),a):l||$(e,t,c,null,i,s,vn(t,r),a,!1),d>0){if(16&d)D(c,p,f,i,r);else if(2&d&&p.class!==f.class&&n(c,"class",null,f.class,r),4&d&&n(c,"style",p.style,f.style,r),8&d){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const s=e[t],o=p[s],a=f[s];a===o&&"value"!==s||n(c,s,o,a,r,i)}}1&d&&e.children!==t.children&&u(c,t.children)}else l||null!=h||D(c,p,f,i,r);((m=f.onVnodeUpdated)||g)&&mn((()=>{m&&cs(m,i,t,e),g&&oi(t,e,i,"updated")}),s)},O=(e,t,i,n,s,o,r)=>{for(let a=0;a<t.length;a++){const l=e[a],c=t[a],d=l.el&&(l.type===jn||!Xn(l,c)||70&l.shapeFlag)?h(l.el):i;y(l,c,d,null,n,s,o,r,!0)}},D=(e,t,i,s,r)=>{if(t!==i){if(t!==o)for(const o in t)I(o)||o in i||n(e,o,t[o],null,r,s);for(const o in i){if(I(o))continue;const a=i[o],l=t[o];a!==l&&"value"!==o&&n(e,o,l,a,r,s)}"value"in i&&n(e,"value",t.value,i.value,r)}},M=(e,i,n,s,o,r,a,c,d)=>{const u=i.el=e?e.el:l(""),h=i.anchor=e?e.anchor:l("");let{patchFlag:g,dynamicChildren:p,slotScopeIds:f}=i;f&&(c=c?c.concat(f):f),null==e?(t(u,n,s),t(h,n,s),E(i.children||[],n,h,o,r,a,c,d)):g>0&&64&g&&p&&e.dynamicChildren?(O(e.dynamicChildren,p,n,o,r,a,c),(null!=i.key||o&&i===o.subTree)&&kn(e,i,!0)):$(e,i,n,h,o,r,a,c,d)},U=(e,t,i,n,s,o,r,a,l)=>{t.slotScopeIds=a,null==e?512&t.shapeFlag?s.ctx.activate(t,i,n,r,l):L(t,i,n,s,o,r,l):R(e,t,l)},L=(e,t,i,n,s,r,a)=>{const l=e.component=function(e,t,i){const n=e.type,s=(t?t.appContext:e.appContext)||ds,r={uid:us++,vnode:e,type:n,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new oe(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:sn(n,s),emitsOptions:Mn(n,s),emit:null,emitted:null,propsDefaults:o,inheritAttrs:n.inheritAttrs,ctx:o,data:o,props:o,attrs:o,slots:o,refs:o,setupState:o,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};r.ctx={_:r},r.root=t?t.root:r,r.emit=Pn.bind(null,r),e.ce&&e.ce(r);return r}(e,n,s);if(ci(e)&&(l.ctx.renderer=ee),function(e,t=!1,i=!1){t&&gs(t);const{props:n,children:s}=e.vnode,o=ys(e);Qi(e,n,o,t),hn(e,s,i);const r=o?function(e,t){const i=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Di);const{setup:n}=i;if(n){const i=e.setupContext=n.length>1?function(e){const t=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,Ts),slots:e.slots,emit:e.emit,expose:t}}(e):null,s=fs(e);fe();const o=Mt(n,e,0,[e.props,i]);if(me(),s(),x(o)){if(o.then(ms,ms),t)return o.then((i=>{ks(e,i,t)})).catch((t=>{Ut(t,e,0)}));e.asyncDep=o}else ks(e,o,t)}else bs(e,t)}(e,t):void 0;t&&gs(!1)}(l,!1,a),l.asyncDep){if(s&&s.registerDep(l,j,a),!e.el){const e=l.subTree=ts($n);w(null,e,t,i)}}else j(l,e,t,i,s,r,a)},R=(e,t,i)=>{const n=t.component=e.component;if(function(e,t,i){const{props:n,children:s,component:o}=e,{props:r,children:a,patchFlag:l}=t,c=o.emitsOptions;if(t.dirs||t.transition)return!0;if(!(i&&l>=0))return!(!s&&!a||a&&a.$stable)||n!==r&&(n?!r||Fn(n,r,c):!!r);if(1024&l)return!0;if(16&l)return n?Fn(n,r,c):!!r;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const i=e[t];if(r[i]!==n[i]&&!Wn(c,i))return!0}}return!1}(e,t,i)){if(n.asyncDep&&!n.asyncResolved)return void H(n,t,i);n.next=t,function(e){const t=Ft.indexOf(e);t>jt&&Ft.splice(t,1)}(n.update),n.effect.dirty=!0,n.update()}else t.el=e.el,n.vnode=t},j=(e,t,i,n,s,o,r)=>{const l=()=>{if(e.isMounted){let{next:t,bu:i,u:n,parent:a,vnode:c}=e;{const i=bn(e);if(i)return t&&(t.el=c.el,H(e,t,r)),void i.asyncDep.then((()=>{e.isUnmounted||l()}))}let d,u=t;wn(e,!1),t?(t.el=c.el,H(e,t,r)):t=c,i&&F(i),(d=t.props&&t.props.onVnodeBeforeUpdate)&&cs(d,a,t,c),wn(e,!0);const g=Un(e),p=e.subTree;e.subTree=g,y(p,g,h(p.el),X(p),e,s,o),t.el=g.el,null===u&&function({vnode:e,parent:t},i){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n!==e)break;(e=t.vnode).el=i,t=t.parent}}(e,g.el),n&&mn(n,s),(d=t.props&&t.props.onVnodeUpdated)&&mn((()=>cs(d,a,t,c)),s)}else{let r;const{el:a,props:l}=t,{bm:c,m:d,parent:u}=e,h=li(t);if(wn(e,!1),c&&F(c),!h&&(r=l&&l.onVnodeBeforeMount)&&cs(r,u,t),wn(e,!0),a&&ie){const i=()=>{e.subTree=Un(e),ie(a,e.subTree,e,s,null)};h?t.type.__asyncLoader().then((()=>!e.isUnmounted&&i())):i()}else{const r=e.subTree=Un(e);y(null,r,i,n,e,s,o),t.el=r.el}if(d&&mn(d,s),!h&&(r=l&&l.onVnodeMounted)){const e=t;mn((()=>cs(r,u,e)),s)}(256&t.shapeFlag||u&&li(u.vnode)&&256&u.vnode.shapeFlag)&&e.a&&mn(e.a,s),e.isMounted=!0,t=i=n=null}},c=e.effect=new le(l,a,(()=>Vt(d)),e.scope),d=e.update=()=>{c.dirty&&c.run()};d.i=e,d.id=e.uid,wn(e,!0),d()},H=(e,t,i)=>{t.component=e;const n=e.vnode.props;e.vnode=t,e.next=null,function(e,t,i,n){const{props:s,attrs:o,vnode:{patchFlag:r}}=e,a=yt(s),[l]=e.propsOptions;let c=!1;if(!(n||r>0)||16&r){let n;en(e,t,s,o)&&(c=!0);for(const o in a)t&&(p(t,o)||(n=W(o))!==o&&p(t,n))||(l?!i||void 0===i[o]&&void 0===i[n]||(s[o]=tn(l,a,o,void 0,e,!0)):delete s[o]);if(o!==a)for(const e in o)t&&p(t,e)||(delete o[e],c=!0)}else if(8&r){const i=e.vnode.dynamicProps;for(let n=0;n<i.length;n++){let r=i[n];if(Wn(e.emitsOptions,r))continue;const d=t[r];if(l)if(p(o,r))d!==o[r]&&(o[r]=d,c=!0);else{const t=P(r);s[t]=tn(l,a,t,d,e,!1)}else d!==o[r]&&(o[r]=d,c=!0)}}c&&Ee(e.attrs,"set","")}(e,t.props,n,i),gn(e,t.children,i),fe(),Kt(e),me()},$=(e,t,i,n,s,o,r,a,l=!1)=>{const c=e&&e.children,d=e?e.shapeFlag:0,h=t.children,{patchFlag:g,shapeFlag:p}=t;if(g>0){if(128&g)return void N(c,h,i,n,s,o,r,a,l);if(256&g)return void z(c,h,i,n,s,o,r,a,l)}8&p?(16&d&&J(c,s,o),h!==c&&u(i,h)):16&d?16&p?N(c,h,i,n,s,o,r,a,l):J(c,s,o,!0):(8&d&&u(i,""),16&p&&E(h,i,n,s,o,r,a,l))},z=(e,t,i,n,s,o,a,l,c)=>{t=t||r;const d=(e=e||r).length,u=t.length,h=Math.min(d,u);let g;for(g=0;g<h;g++){const n=t[g]=c?as(t[g]):rs(t[g]);y(e[g],n,i,null,s,o,a,l,c)}d>u?J(e,s,o,!0,!1,h):E(t,i,n,s,o,a,l,c,h)},N=(e,t,i,n,s,o,a,l,c)=>{let d=0;const u=t.length;let h=e.length-1,g=u-1;for(;d<=h&&d<=g;){const n=e[d],r=t[d]=c?as(t[d]):rs(t[d]);if(!Xn(n,r))break;y(n,r,i,null,s,o,a,l,c),d++}for(;d<=h&&d<=g;){const n=e[h],r=t[g]=c?as(t[g]):rs(t[g]);if(!Xn(n,r))break;y(n,r,i,null,s,o,a,l,c),h--,g--}if(d>h){if(d<=g){const e=g+1,r=e<u?t[e].el:n;for(;d<=g;)y(null,t[d]=c?as(t[d]):rs(t[d]),i,r,s,o,a,l,c),d++}}else if(d>g)for(;d<=h;)V(e[d],s,o,!0),d++;else{const p=d,f=d,m=new Map;for(d=f;d<=g;d++){const e=t[d]=c?as(t[d]):rs(t[d]);null!=e.key&&m.set(e.key,d)}let v,w=0;const k=g-f+1;let b=!1,T=0;const x=new Array(k);for(d=0;d<k;d++)x[d]=0;for(d=p;d<=h;d++){const n=e[d];if(w>=k){V(n,s,o,!0);continue}let r;if(null!=n.key)r=m.get(n.key);else for(v=f;v<=g;v++)if(0===x[v-f]&&Xn(n,t[v])){r=v;break}void 0===r?V(n,s,o,!0):(x[r-f]=d+1,r>=T?T=r:b=!0,y(n,t[r],i,null,s,o,a,l,c),w++)}const C=b?function(e){const t=e.slice(),i=[0];let n,s,o,r,a;const l=e.length;for(n=0;n<l;n++){const l=e[n];if(0!==l){if(s=i[i.length-1],e[s]<l){t[n]=s,i.push(n);continue}for(o=0,r=i.length-1;o<r;)a=o+r>>1,e[i[a]]<l?o=a+1:r=a;l<e[i[o]]&&(o>0&&(t[n]=i[o-1]),i[o]=n)}}o=i.length,r=i[o-1];for(;o-- >0;)i[o]=r,r=t[r];return i}(x):r;for(v=C.length-1,d=k-1;d>=0;d--){const e=f+d,r=t[e],h=e+1<u?t[e+1].el:n;0===x[d]?y(null,r,i,h,s,o,a,l,c):b&&(v<0||d!==C[v]?G(r,i,h,2):v--)}}},G=(e,i,n,s,o=null)=>{const{el:r,type:a,transition:l,children:c,shapeFlag:d}=e;if(6&d)return void G(e.component.subTree,i,n,s);if(128&d)return void e.suspense.move(i,n,s);if(64&d)return void a.move(e,i,n,ee);if(a===jn){t(r,i,n);for(let e=0;e<c.length;e++)G(c[e],i,n,s);return void t(e.anchor,i,n)}if(a===Bn)return void b(e,i,n);if(2!==s&&1&d&&l)if(0===s)l.beforeEnter(r),t(r,i,n),mn((()=>l.enter(r)),o);else{const{leave:e,delayLeave:s,afterLeave:o}=l,a=()=>t(r,i,n),c=()=>{e(r,(()=>{a(),o&&o()}))};s?s(r,a,c):c()}else t(r,i,n)},V=(e,t,i,n=!1,s=!1)=>{const{type:o,props:r,ref:a,children:l,dynamicChildren:c,shapeFlag:d,patchFlag:u,dirs:h,cacheIndex:g}=e;if(-2===u&&(s=!1),null!=a&&pn(a,null,i,e,!0),null!=g&&(t.renderCache[g]=void 0),256&d)return void t.ctx.deactivate(e);const p=1&d&&h,f=!li(e);let m;if(f&&(m=r&&r.onVnodeBeforeUnmount)&&cs(m,t,e),6&d)Z(e.component,i,n);else{if(128&d)return void e.suspense.unmount(i,n);p&&oi(e,null,t,"beforeUnmount"),64&d?e.type.remove(e,t,i,ee,n):c&&!c.hasOnce&&(o!==jn||u>0&&64&u)?J(c,t,i,!1,!0):(o===jn&&384&u||!s&&16&d)&&J(l,t,i),n&&q(e)}(f&&(m=r&&r.onVnodeUnmounted)||p)&&mn((()=>{m&&cs(m,t,e),p&&oi(e,null,t,"unmounted")}),i)},q=e=>{const{type:t,el:n,anchor:s,transition:o}=e;if(t===jn)return void K(n,s);if(t===Bn)return void T(e);const r=()=>{i(n),o&&!o.persisted&&o.afterLeave&&o.afterLeave()};if(1&e.shapeFlag&&o&&!o.persisted){const{leave:t,delayLeave:i}=o,s=()=>t(n,r);i?i(e.el,r,s):s()}else r()},K=(e,t)=>{let n;for(;e!==t;)n=g(e),i(e),e=n;i(t)},Z=(e,t,i)=>{const{bum:n,scope:s,update:o,subTree:r,um:a,m:l,a:c}=e;Tn(l),Tn(c),n&&F(n),s.stop(),o&&(o.active=!1,V(r,e,t,i)),a&&mn(a,t),mn((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},J=(e,t,i,n=!1,s=!1,o=0)=>{for(let r=o;r<e.length;r++)V(e[r],t,i,n,s)},X=e=>{if(6&e.shapeFlag)return X(e.component.subTree);if(128&e.shapeFlag)return e.suspense.next();const t=g(e.anchor||e.el),i=t&&t[fn];return i?g(i):t};let Y=!1;const Q=(e,t,i)=>{null==e?t._vnode&&V(t._vnode,null,null,!0):y(t._vnode||null,e,t,null,null,null,i),t._vnode=e,Y||(Y=!0,Kt(),Zt(),Y=!1)},ee={p:y,um:V,m:G,r:q,mt:L,mc:E,pc:$,pbc:O,n:X,o:e};let te,ie;return{render:Q,hydrate:te,createApp:qi(Q,te)}}(e)}function vn({type:e,props:t},i){return"svg"===i&&"foreignObject"===e||"mathml"===i&&"annotation-xml"===e&&t&&t.encoding&&t.encoding.includes("html")?void 0:i}function wn({effect:e,update:t},i){e.allowRecurse=t.allowRecurse=i}function kn(e,t,i=!1){const n=e.children,s=t.children;if(f(n)&&f(s))for(let o=0;o<n.length;o++){const e=n[o];let t=s[o];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=s[o]=as(s[o]),t.el=e.el),i||-2===t.patchFlag||kn(e,t)),t.type===Hn&&(t.el=e.el)}}function bn(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:bn(t)}function Tn(e){if(e)for(let t=0;t<e.length;t++)e[t].active=!1}const xn=Symbol.for("v-scx"),Cn=()=>Zi(xn),Sn={};function _n(e,t,i){return En(e,t,i)}function En(e,t,{immediate:i,deep:n,flush:s,once:r,onTrack:l,onTrigger:c}=o){if(t&&r){const e=t;t=(...t)=>{e(...t),_()}}const d=ps,u=e=>!0===n?e:On(e,!1===n?1:void 0);let g,p,m=!1,y=!1;if(Ct(e)?(g=()=>e.value,m=ft(e)):gt(e)?(g=()=>u(e),m=!0):f(e)?(y=!0,m=e.some((e=>gt(e)||ft(e))),g=()=>e.map((e=>Ct(e)?e.value:gt(e)?u(e):w(e)?Mt(e,d,2):void 0))):g=w(e)?t?()=>Mt(e,d,2):()=>(p&&p(),Wt(e,d,3,[k])):a,t&&n){const e=g;g=()=>On(e())}let v,k=e=>{p=C.onStop=()=>{Mt(e,d,4),p=C.onStop=void 0}};if(ws){if(k=a,t?i&&Wt(t,d,3,[g(),y?[]:void 0,k]):g(),"sync"!==s)return a;{const e=Cn();v=e.__watcherHandles||(e.__watcherHandles=[])}}let b=y?new Array(e.length).fill(Sn):Sn;const T=()=>{if(C.active&&C.dirty)if(t){const e=C.run();(n||m||(y?e.some(((e,t)=>R(e,b[t]))):R(e,b)))&&(p&&p(),Wt(t,d,3,[e,b===Sn?void 0:y&&b[0]===Sn?[]:b,k]),b=e)}else C.run()};let x;T.allowRecurse=!!t,"sync"===s?x=T:"post"===s?x=()=>mn(T,d&&d.suspense):(T.pre=!0,d&&(T.id=d.uid),x=()=>Vt(T));const C=new le(g,a,x),S=ae(),_=()=>{C.stop(),S&&h(S.effects,C)};return t?i?T():b=C.run():"post"===s?mn(C.run.bind(C),d&&d.suspense):C.run(),v&&v.push(_),_}function An(e,t,i){const n=this.proxy,s=k(e)?e.includes(".")?In(n,e):()=>n[e]:e.bind(n,n);let o;w(t)?o=t:(o=t.handler,i=t);const r=fs(this),a=En(s,o.bind(n),i);return r(),a}function In(e,t){const i=t.split(".");return()=>{let t=e;for(let e=0;e<i.length&&t;e++)t=t[i[e]];return t}}function On(e,t=1/0,i){if(t<=0||!T(e)||e.__v_skip)return e;if((i=i||new Set).has(e))return e;if(i.add(e),t--,Ct(e))On(e.value,t,i);else if(f(e))for(let n=0;n<e.length;n++)On(e[n],t,i);else if(y(e)||m(e))e.forEach((e=>{On(e,t,i)}));else if(E(e)){for(const n in e)On(e[n],t,i);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&On(e[n],t,i)}return e}const Dn=(e,t)=>"modelValue"===t||"model-value"===t?e.modelModifiers:e[`${t}Modifiers`]||e[`${P(t)}Modifiers`]||e[`${W(t)}Modifiers`];function Pn(e,t,...i){if(e.isUnmounted)return;const n=e.vnode.props||o;let s=i;const r=t.startsWith("update:"),a=r&&Dn(n,t.slice(7));let l;a&&(a.trim&&(s=i.map((e=>k(e)?e.trim():e))),a.number&&(s=i.map(H)));let c=n[l=L(t)]||n[l=L(P(t))];!c&&r&&(c=n[l=L(W(t))]),c&&Wt(c,e,6,s);const d=n[l+"Once"];if(d){if(e.emitted){if(e.emitted[l])return}else e.emitted={};e.emitted[l]=!0,Wt(d,e,6,s)}}function Mn(e,t,i=!1){const n=t.emitsCache,s=n.get(e);if(void 0!==s)return s;const o=e.emits;let r={},a=!1;if(!w(e)){const n=e=>{const i=Mn(e,t,!0);i&&(a=!0,u(r,i))};!i&&t.mixins.length&&t.mixins.forEach(n),e.extends&&n(e.extends),e.mixins&&e.mixins.forEach(n)}return o||a?(f(o)?o.forEach((e=>r[e]=null)):u(r,o),T(e)&&n.set(e,r),r):(T(e)&&n.set(e,null),null)}function Wn(e,t){return!(!e||!c(t))&&(t=t.slice(2).replace(/Once$/,""),p(e,t[0].toLowerCase()+t.slice(1))||p(e,W(t))||p(e,t))}function Un(e){const{type:t,vnode:i,proxy:n,withProxy:s,propsOptions:[o],slots:r,attrs:a,emit:l,render:c,renderCache:u,props:h,data:g,setupState:p,ctx:f,inheritAttrs:m}=e,y=ti(e);let v,w;try{if(4&i.shapeFlag){const e=s||n,t=e;v=rs(c.call(t,e,u,h,p,g,f)),w=a}else{const e=t;0,v=rs(e.length>1?e(h,{attrs:a,slots:r,emit:l}):e(h,null)),w=t.props?a:Ln(a)}}catch(b){zn.length=0,Ut(b,e,1),v=ts($n)}let k=v;if(w&&!1!==m){const e=Object.keys(w),{shapeFlag:t}=k;e.length&&7&t&&(o&&e.some(d)&&(w=Rn(w,o)),k=is(k,w,!1,!0))}return i.dirs&&(k=is(k,null,!1,!0),k.dirs=k.dirs?k.dirs.concat(i.dirs):i.dirs),i.transition&&(k.transition=i.transition),v=k,ti(y),v}const Ln=e=>{let t;for(const i in e)("class"===i||"style"===i||c(i))&&((t||(t={}))[i]=e[i]);return t},Rn=(e,t)=>{const i={};for(const n in e)d(n)&&n.slice(9)in t||(i[n]=e[n]);return i};function Fn(e,t,i){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let s=0;s<n.length;s++){const o=n[s];if(t[o]!==e[o]&&!Wn(i,o))return!0}return!1}const jn=Symbol.for("v-fgt"),Hn=Symbol.for("v-txt"),$n=Symbol.for("v-cmt"),Bn=Symbol.for("v-stc"),zn=[];let Nn=null;function Gn(e=!1){zn.push(Nn=e?null:[])}let Vn=1;function qn(e){Vn+=e,e<0&&Nn&&(Nn.hasOnce=!0)}function Kn(e){return e.dynamicChildren=Vn>0?Nn||r:null,zn.pop(),Nn=zn[zn.length-1]||null,Vn>0&&Nn&&Nn.push(e),e}function Zn(e,t,i,n,s,o){return Kn(es(e,t,i,n,s,o,!0))}function Jn(e,t,i,n,s){return Kn(ts(e,t,i,n,s,!0))}function Xn(e,t){return e.type===t.type&&e.key===t.key}const Yn=({key:e})=>null!=e?e:null,Qn=({ref:e,ref_key:t,ref_for:i})=>("number"==typeof e&&(e=""+e),null!=e?k(e)||Ct(e)||w(e)?{i:Qt,r:e,k:t,f:!!i}:e:null);function es(e,t=null,i=null,n=0,s=null,o=(e===jn?0:1),r=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Yn(t),ref:t&&Qn(t),scopeId:ei,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Qt};return a?(ls(l,i),128&o&&e.normalize(l)):i&&(l.shapeFlag|=k(i)?8:16),Vn>0&&!r&&Nn&&(l.patchFlag>0||6&o)&&32!==l.patchFlag&&Nn.push(l),l}const ts=function(e,t=null,i=null,n=0,s=null,o=!1){e&&e!==_i||(e=$n);if(r=e,r&&!0===r.__v_isVNode){const n=is(e,t,!0);return i&&ls(n,i),Vn>0&&!o&&Nn&&(6&n.shapeFlag?Nn[Nn.indexOf(e)]=n:Nn.push(n)),n.patchFlag=-2,n}var r;(function(e){return w(e)&&"__vccOpts"in e})(e)&&(e=e.__vccOpts);if(t){t=function(e){return e?mt(e)||Yi(e)?u({},e):e:null}(t);let{class:e,style:i}=t;e&&!k(e)&&(t.class=K(e)),T(i)&&(mt(i)&&!f(i)&&(i=u({},i)),t.style=z(i))}const a=k(e)?1:(e=>e.__isSuspense)(e)?128:(e=>e.__isTeleport)(e)?64:T(e)?4:w(e)?2:0;return es(e,t,i,n,s,a,o,!0)};function is(e,t,i=!1,n=!1){const{props:s,ref:o,patchFlag:r,children:a,transition:l}=e,d=t?function(...e){const t={};for(let i=0;i<e.length;i++){const n=e[i];for(const e in n)if("class"===e)t.class!==n.class&&(t.class=K([t.class,n.class]));else if("style"===e)t.style=z([t.style,n.style]);else if(c(e)){const i=t[e],s=n[e];!s||i===s||f(i)&&i.includes(s)||(t[e]=i?[].concat(i,s):s)}else""!==e&&(t[e]=n[e])}return t}(s||{},t):s,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:d,key:d&&Yn(d),ref:t&&t.ref?i&&o?f(o)?o.concat(Qn(t)):[o,Qn(t)]:Qn(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==jn?-1===r?16:16|r:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&is(e.ssContent),ssFallback:e.ssFallback&&is(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&n&&ri(u,l.clone(u)),u}function ns(e=" ",t=0){return ts(Hn,null,e,t)}function ss(e,t){const i=ts(Bn,null,e);return i.staticCount=t,i}function os(e="",t=!1){return t?(Gn(),Jn($n,null,e)):ts($n,null,e)}function rs(e){return null==e||"boolean"==typeof e?ts($n):f(e)?ts(jn,null,e.slice()):"object"==typeof e?as(e):ts(Hn,null,String(e))}function as(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:is(e)}function ls(e,t){let i=0;const{shapeFlag:n}=e;if(null==t)t=null;else if(f(t))i=16;else if("object"==typeof t){if(65&n){const i=t.default;return void(i&&(i._c&&(i._d=!1),ls(e,i()),i._c&&(i._d=!0)))}{i=32;const n=t._;n||Yi(t)?3===n&&Qt&&(1===Qt.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=Qt}}else w(t)?(t={default:t,_ctx:Qt},i=32):(t=String(t),64&n?(i=16,t=[ns(t)]):i=8);e.children=t,e.shapeFlag|=i}function cs(e,t,i,n=null){Wt(e,t,7,[i,n])}const ds=Gi();let us=0;let hs,gs,ps=null;{const e=B(),t=(t,i)=>{let n;return(n=e[t])||(n=e[t]=[]),n.push(i),e=>{n.length>1?n.forEach((t=>t(e))):n[0](e)}};hs=t("__VUE_INSTANCE_SETTERS__",(e=>ps=e)),gs=t("__VUE_SSR_SETTERS__",(e=>ws=e))}const fs=e=>{const t=ps;return hs(e),e.scope.on(),()=>{e.scope.off(),hs(t)}},ms=()=>{ps&&ps.scope.off(),hs(null)};function ys(e){return 4&e.vnode.shapeFlag}let vs,ws=!1;function ks(e,t,i){w(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:T(t)&&(e.setupState=At(t)),bs(e,i)}function bs(e,t,i){const n=e.type;if(!e.render){if(!t&&vs&&!n.render){const t=n.template||Ri(e).template;if(t){const{isCustomElement:i,compilerOptions:s}=e.appContext.config,{delimiters:o,compilerOptions:r}=n,a=u(u({isCustomElement:i,delimiters:o},s),r);n.render=vs(t,a)}}e.render=n.render||a}{const t=fs(e);fe();try{Wi(e)}finally{me(),t()}}}const Ts={get:(e,t)=>(_e(e,0,""),e[t])};function xs(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(At(vt(e.exposed)),{get:(t,i)=>i in t?t[i]:i in Ii?Ii[i](e):void 0,has:(e,t)=>t in e||t in Ii})):e.proxy}const Cs=(e,t)=>{const i=function(e,t,i=!1){let n,s;const o=w(e);return o?(n=e,s=a):(n=e.get,s=e.set),new bt(n,s,o||!s,i)}(e,0,ws);return i},Ss="3.4.38",_s="undefined"!=typeof document?document:null,Es=_s&&_s.createElement("template"),As={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,n)=>{const s="svg"===t?_s.createElementNS("http://www.w3.org/2000/svg",e):"mathml"===t?_s.createElementNS("http://www.w3.org/1998/Math/MathML",e):i?_s.createElement(e,{is:i}):_s.createElement(e);return"select"===e&&n&&null!=n.multiple&&s.setAttribute("multiple",n.multiple),s},createText:e=>_s.createTextNode(e),createComment:e=>_s.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>_s.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,n,s,o){const r=i?i.previousSibling:t.lastChild;if(s&&(s===o||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),i),s!==o&&(s=s.nextSibling););else{Es.innerHTML="svg"===n?`<svg>${e}</svg>`:"mathml"===n?`<math>${e}</math>`:e;const s=Es.content;if("svg"===n||"mathml"===n){const e=s.firstChild;for(;e.firstChild;)s.appendChild(e.firstChild);s.removeChild(e)}t.insertBefore(s,i)}return[r?r.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}},Is=Symbol("_vtc");const Os=Symbol("_vod"),Ds=Symbol("_vsh"),Ps=Symbol(""),Ms=/(^|;)\s*display\s*:/;const Ws=/\s*!important$/;function Us(e,t,i){if(f(i))i.forEach((i=>Us(e,t,i)));else if(null==i&&(i=""),t.startsWith("--"))e.setProperty(t,i);else{const n=function(e,t){const i=Rs[t];if(i)return i;let n=P(t);if("filter"!==n&&n in e)return Rs[t]=n;n=U(n);for(let s=0;s<Ls.length;s++){const i=Ls[s]+n;if(i in e)return Rs[t]=i}return t}(e,t);Ws.test(i)?e.setProperty(W(n),i.replace(Ws,""),"important"):e[n]=i}}const Ls=["Webkit","Moz","ms"],Rs={};const Fs="http://www.w3.org/1999/xlink";function js(e,t,i,n,s,o=Z(t)){n&&t.startsWith("xlink:")?null==i?e.removeAttributeNS(Fs,t.slice(6,t.length)):e.setAttributeNS(Fs,t,i):null==i||o&&!J(i)?e.removeAttribute(t):e.setAttribute(t,o?"":b(i)?String(i):i)}function Hs(e,t,i,n){e.addEventListener(t,i,n)}const $s=Symbol("_vei");function Bs(e,t,i,n,s=null){const o=e[$s]||(e[$s]={}),r=o[t];if(n&&r)r.value=n;else{const[i,a]=function(e){let t;if(zs.test(e)){let i;for(t={};i=e.match(zs);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}const i=":"===e[2]?e.slice(3):W(e.slice(2));return[i,t]}(t);if(n){const r=o[t]=function(e,t){const i=e=>{if(e._vts){if(e._vts<=i.attached)return}else e._vts=Date.now();Wt(function(e,t){if(f(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}(e,i.value),t,5,[e])};return i.value=e,i.attached=Vs(),i}(n,s);Hs(e,i,r,a)}else r&&(!function(e,t,i,n){e.removeEventListener(t,i,n)}(e,i,r,a),o[t]=void 0)}}const zs=/(?:Once|Passive|Capture)$/;let Ns=0;const Gs=Promise.resolve(),Vs=()=>Ns||(Gs.then((()=>Ns=0)),Ns=Date.now());const qs=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123;const Ks=e=>{const t=e.props["onUpdate:modelValue"]||!1;return f(t)?e=>F(t,e):t};function Zs(e){e.target.composing=!0}function Js(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Xs=Symbol("_assign"),Ys={created(e,{modifiers:{lazy:t,trim:i,number:n}},s){e[Xs]=Ks(s);const o=n||s.props&&"number"===s.props.type;Hs(e,t?"change":"input",(t=>{if(t.target.composing)return;let n=e.value;i&&(n=n.trim()),o&&(n=H(n)),e[Xs](n)})),i&&Hs(e,"change",(()=>{e.value=e.value.trim()})),t||(Hs(e,"compositionstart",Zs),Hs(e,"compositionend",Js),Hs(e,"change",Js))},mounted(e,{value:t}){e.value=null==t?"":t},beforeUpdate(e,{value:t,oldValue:i,modifiers:{lazy:n,trim:s,number:o}},r){if(e[Xs]=Ks(r),e.composing)return;const a=null==t?"":t;if((!o&&"number"!==e.type||/^0\d/.test(e.value)?e.value:H(e.value))!==a){if(document.activeElement===e&&"range"!==e.type){if(n&&t===i)return;if(s&&e.value.trim()===a)return}e.value=a}}},Qs={deep:!0,created(e,{value:t,modifiers:{number:i}},n){const s=y(t);Hs(e,"change",(()=>{const t=Array.prototype.filter.call(e.options,(e=>e.selected)).map((e=>i?H(to(e)):to(e)));e[Xs](e.multiple?s?new Set(t):t:t[0]),e._assigning=!0,Gt((()=>{e._assigning=!1}))})),e[Xs]=Ks(n)},mounted(e,{value:t,modifiers:{number:i}}){eo(e,t)},beforeUpdate(e,t,i){e[Xs]=Ks(i)},updated(e,{value:t,modifiers:{number:i}}){e._assigning||eo(e,t)}};function eo(e,t,i){const n=e.multiple,s=f(t);if(!n||s||y(t)){for(let i=0,o=e.options.length;i<o;i++){const o=e.options[i],r=to(o);if(n)if(s){const e=typeof r;o.selected="string"===e||"number"===e?t.some((e=>String(e)===String(r))):Y(t,r)>-1}else o.selected=t.has(r);else if(X(to(o),t))return void(e.selectedIndex!==i&&(e.selectedIndex=i))}n||-1===e.selectedIndex||(e.selectedIndex=-1)}}function to(e){return"_value"in e?e._value:e.value}const io=u({patchProp:(e,t,i,n,s,o)=>{const r="svg"===s;"class"===t?function(e,t,i){const n=e[Is];n&&(t=(t?[t,...n]:[...n]).join(" ")),null==t?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}(e,n,r):"style"===t?function(e,t,i){const n=e.style,s=k(i);let o=!1;if(i&&!s){if(t)if(k(t))for(const e of t.split(";")){const t=e.slice(0,e.indexOf(":")).trim();null==i[t]&&Us(n,t,"")}else for(const e in t)null==i[e]&&Us(n,e,"");for(const e in i)"display"===e&&(o=!0),Us(n,e,i[e])}else if(s){if(t!==i){const e=n[Ps];e&&(i+=";"+e),n.cssText=i,o=Ms.test(i)}}else t&&e.removeAttribute("style");Os in e&&(e[Os]=o?n.display:"",e[Ds]&&(n.display="none"))}(e,i,n):c(t)?d(t)||Bs(e,t,0,n,o):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,i,n){if(n)return"innerHTML"===t||"textContent"===t||!!(t in e&&qs(t)&&w(i));if("spellcheck"===t||"draggable"===t||"translate"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if("width"===t||"height"===t){const t=e.tagName;if("IMG"===t||"VIDEO"===t||"CANVAS"===t||"SOURCE"===t)return!1}if(qs(t)&&k(i))return!1;return t in e}(e,t,n,r))?(!function(e,t,i){if("innerHTML"===t||"textContent"===t){if(null==i)return;return void(e[t]=i)}const n=e.tagName;if("value"===t&&"PROGRESS"!==n&&!n.includes("-")){const s="OPTION"===n?e.getAttribute("value")||"":e.value,o=null==i?"":String(i);return s===o&&"_value"in e||(e.value=o),null==i&&e.removeAttribute(t),void(e._value=i)}let s=!1;if(""===i||null==i){const n=typeof e[t];"boolean"===n?i=J(i):null==i&&"string"===n?(i="",s=!0):"number"===n&&(i=0,s=!0)}try{e[t]=i}catch(o){}s&&e.removeAttribute(t)}(e,t,n),e.tagName.includes("-")||"value"!==t&&"checked"!==t&&"selected"!==t||js(e,t,n,r,0,"value"!==t)):("true-value"===t?e._trueValue=n:"false-value"===t&&(e._falseValue=n),js(e,t,n,r))}},As);let no;const so=(...e)=>{const t=(no||(no=yn(io))).createApp(...e),{mount:i}=t;return t.mount=e=>{const n=function(e){if(k(e)){return document.querySelector(e)}return e}(e);if(!n)return;const s=t._component;w(s)||s.render||s.template||(s.template=n.innerHTML),n.innerHTML="";const o=i(n,!1,function(e){if(e instanceof SVGElement)return"svg";if("function"==typeof MathMLElement&&e instanceof MathMLElement)return"mathml"}(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},t};var oo=!1;
/*!
   * pinia v2.3.1
   * (c) 2025 Eduardo San Martin Morote
   * @license MIT
   */let ro;const ao=e=>ro=e,lo=Symbol();function co(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var uo,ho;(ho=uo||(uo={})).direct="direct",ho.patchObject="patch object",ho.patchFunction="patch function";const go=()=>{};function po(e,t,i,n=go){e.push(t);const s=()=>{const i=e.indexOf(t);i>-1&&(e.splice(i,1),n())};var o;return!i&&ae()&&(o=s,ne&&ne.cleanups.push(o)),s}function fo(e,...t){e.slice().forEach((e=>{e(...t)}))}const mo=e=>e(),yo=Symbol(),vo=Symbol();function wo(e,t){e instanceof Map&&t instanceof Map?t.forEach(((t,i)=>e.set(i,t))):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const i in t){if(!t.hasOwnProperty(i))continue;const n=t[i],s=e[i];co(s)&&co(n)&&e.hasOwnProperty(i)&&!Ct(n)&&!gt(n)?e[i]=wo(s,n):e[i]=n}return e}const ko=Symbol();const{assign:bo}=Object;function To(e,t,i,n){const{state:s,actions:o,getters:r}=t,a=i.state.value[e];let l;return l=xo(e,(function(){a||(i.state.value[e]=s?s():{});const t=function(e){const t=f(e)?new Array(e.length):{};for(const i in e)t[i]=Pt(e,i);return t}(i.state.value[e]);return bo(t,o,Object.keys(r||{}).reduce(((t,n)=>(t[n]=vt(Cs((()=>{ao(i);const t=i._s.get(e);return r[n].call(t,t)}))),t)),{}))}),t,i,n,!0),l}function xo(e,t,i={},n,s,o){let r;const a=bo({actions:{}},i),l={deep:!0};let c,d,u,h=[],g=[];const p=n.state.value[e];let f;function m(t){let i;c=d=!1,"function"==typeof t?(t(n.state.value[e]),i={type:uo.patchFunction,storeId:e,events:u}):(wo(n.state.value[e],t),i={type:uo.patchObject,payload:t,storeId:e,events:u});const s=f=Symbol();Gt().then((()=>{f===s&&(c=!0)})),d=!0,fo(h,i,n.state.value[e])}o||p||(n.state.value[e]={}),St({});const y=o?function(){const{state:e}=i,t=e?e():{};this.$patch((e=>{bo(e,t)}))}:go;const v=(t,i="")=>{if(yo in t)return t[vo]=i,t;const s=function(){ao(n);const i=Array.from(arguments),o=[],r=[];let a;fo(g,{args:i,name:s[vo],store:w,after:function(e){o.push(e)},onError:function(e){r.push(e)}});try{a=t.apply(this&&this.$id===e?this:w,i)}catch(l){throw fo(r,l),l}return a instanceof Promise?a.then((e=>(fo(o,e),e))).catch((e=>(fo(r,e),Promise.reject(e)))):(fo(o,a),a)};return s[yo]=!0,s[vo]=i,s},w=dt({_p:n,$id:e,$onAction:po.bind(null,g),$patch:m,$reset:y,$subscribe(t,i={}){const s=po(h,t,i.detached,(()=>o())),o=r.run((()=>_n((()=>n.state.value[e]),(n=>{("sync"===i.flush?d:c)&&t({storeId:e,type:uo.direct,events:u},n)}),bo({},l,i))));return s},$dispose:function(){r.stop(),h=[],g=[],n._s.delete(e)}});n._s.set(e,w);const k=(n._a&&n._a.runWithContext||mo)((()=>n._e.run((()=>(r=re()).run((()=>t({action:v})))))));for(const x in k){const t=k[x];if(Ct(t)&&(!Ct(T=t)||!T.effect)||gt(t))o||(!p||co(b=t)&&b.hasOwnProperty(ko)||(Ct(t)?t.value=p[x]:wo(t,p[x])),n.state.value[e][x]=t);else if("function"==typeof t){const e=v(t,x);k[x]=e,a.actions[x]=t}}var b,T;return bo(w,k),bo(yt(w),k),Object.defineProperty(w,"$state",{get:()=>n.state.value[e],set:e=>{m((t=>{bo(t,e)}))}}),n._p.forEach((e=>{bo(w,r.run((()=>e({store:w,app:n._a,pinia:n,options:a}))))})),p&&o&&i.hydrate&&i.hydrate(w.$state,p),c=!0,d=!0,w}
/*! #__NO_SIDE_EFFECTS__ */function Co(e,t,i){let n,s;const o="function"==typeof t;function r(e,i){(e=e||(!!(ps||Qt||Ki)?Zi(lo,null):null))&&ao(e),(e=ro)._s.has(n)||(o?xo(n,t,s,e):To(n,s,e));return e._s.get(n)}return"string"==typeof e?(n=e,s=o?i:t):(s=e,n=e.id),r.$id=n,r}function So(e){{const t=yt(e),i={};for(const n in t){const s=t[n];s.effect?i[n]=Cs({get:()=>e[n],set(t){e[n]=t}}):(Ct(s)||gt(s))&&(i[n]=Dt(e,n))}return i}}class _o{constructor(){i(this,"apiKey",""),i(this,"baseUrl",""),i(this,"isProduction",!1),i(this,"configInitialized",!1)}initializeConfig(){if(!this.configInitialized){if(!window.WIDGET_CONFIG)throw new Error("Chat Widget configuration not found");if(this.apiKey=window.WIDGET_CONFIG.apiKey,this.baseUrl=window.WIDGET_CONFIG.baseUrlWs,this.isProduction=window.WIDGET_CONFIG.isProduction,this.isProduction&&(console.log("IS PRODUCTION!!!"),this.baseUrl=this.baseUrl.replace("ws://","wss://"),console.log("BASE URL WS : ",this.baseUrl)),!this.apiKey)throw new Error("API key is required");this.configInitialized=!0}}getHeaders(){return this.initializeConfig(),{"X-Api-Key":this.apiKey,"Content-Type":"application/json",Accept:"application/json"}}getBaseUrl(){return this.initializeConfig(),this.baseUrl}getApiKeyHeader(){return this.initializeConfig(),this.apiKey}getMultipartHeaders(){return this.initializeConfig(),{"X-Api-Key":this.apiKey}}handleError(e,t){var i,n;console.error("WS Error:",e);const s=(null==(n=null==(i=null==e?void 0:e.response)?void 0:i.data)?void 0:n.message)??(null==e?void 0:e.message)??t;throw new Error(s)}}var Eo=(e=>(e.CHAT="chat_message",e.TYPING="typing_indicator",e.NOTIFICATION="notification",e.TICKET_UPDATE="ticket_update",e.NOTIFICATION_COUNT="notification_count",e.SYSTEM="system",e.USER_STATUS="user_status",e))(Eo||{});const Ao=class e extends _o{constructor(){super(),i(this,"ws",null),i(this,"messageCallbacks",new Map),i(this,"statusCallbacks",[]),i(this,"reconnectAttempts",0),i(this,"maxReconnectAttempts",5),i(this,"reconnectTimeout",null),this.messageCallbacks.set("chat_message",[]),this.messageCallbacks.set("typing_indicator",[]),this.messageCallbacks.set("notification",[]),this.messageCallbacks.set("ticket_update",[]),this.messageCallbacks.set("system",[]),this.messageCallbacks.set("notification_count",[])}static getInstance(){return e.instance||(e.instance=new e),e.instance}initializeConnection(){return new Promise(((e,t)=>{var i;if((null==(i=this.ws)?void 0:i.readyState)===WebSocket.OPEN)return console.log("WebSocket already connected"),void e();const n=this.getApiKeyHeader(),s=`${this.getBaseUrl()}/ws/admin?api_key=${n}`;this.ws=new WebSocket(s),this.ws.onopen=()=>{console.log("WebSocket connected for admin interface"),this.reconnectAttempts=0,this.notifyStatusChange(!0),e()},this.ws.onerror=e=>{console.error("WebSocket error:",e),this.notifyStatusChange(!1),t(e)},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);if(console.log("[WS] Received WebSocket message:",t),t.type&&this.messageCallbacks.has(t.type)){(this.messageCallbacks.get(t.type)||[]).forEach((e=>e(t)))}else this.notifyMessageCallbacks("system",t)}catch(t){console.error("Error parsing WebSocket message:",t)}},this.ws.onclose=()=>{console.log("WebSocket disconnected"),this.notifyStatusChange(!1),this.attemptReconnect()}}))}attemptReconnect(){if(this.reconnectAttempts<this.maxReconnectAttempts){this.reconnectAttempts++;const e=Math.min(1e3*Math.pow(2,this.reconnectAttempts),3e4);this.reconnectTimeout=window.setTimeout((()=>{console.log(`Attempting to reconnect (${this.reconnectAttempts}/${this.maxReconnectAttempts})`),this.initializeConnection().catch(console.error)}),e)}}sendMessage(e){return this.sendWebSocketMessage(e)}sendTypingIndicator(e){return this.sendWebSocketMessage(e)}sendUserStatus(e){return this.sendWebSocketMessage(e)}sendHeartbeat(e){return this.sendWebSocketMessage(e)}sendWebSocketMessage(e){return new Promise(((t,i)=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN)try{this.ws.send(JSON.stringify({...e,timestamp:(new Date).toISOString()})),t()}catch(n){i(n)}else i(new Error("WebSocket is not connected"))}))}onMessage(e,t){this.messageCallbacks.has(e)||this.messageCallbacks.set(e,[]);const i=this.messageCallbacks.get(e)||[];i.push(t),this.messageCallbacks.set(e,i)}onStatusChange(e){this.statusCallbacks.push(e)}notifyMessageCallbacks(e,t){(this.messageCallbacks.get(e)||[]).forEach((e=>e(t)))}notifyStatusChange(e){this.statusCallbacks.forEach((t=>t(e)))}sendTypingStatus(e,t){return this.sendWebSocketMessage({type:"typing_indicator",code:t,is_typing:e,role:"cs",sender_id:""})}disconnect(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.ws&&(this.ws.close(),this.ws=null),this.statusCallbacks=[],this.reconnectAttempts=0}};i(Ao,"instance",null);let Io=Ao;class Oo{constructor(){i(this,"apiKey",""),i(this,"baseUrl",""),i(this,"isProduction",!1),i(this,"configInitialized",!1)}initializeConfig(){if(!this.configInitialized){if(!window.WIDGET_CONFIG)throw new Error("Chat Widget configuration not found");if(this.apiKey=window.WIDGET_CONFIG.apiKey,this.baseUrl=window.WIDGET_CONFIG.baseUrlApi,this.isProduction=window.WIDGET_CONFIG.isProduction,this.isProduction&&(console.log("IS PRODUCTION!!!"),this.baseUrl=this.baseUrl.replace("http://","https://"),console.log("BASE URL API : ",this.baseUrl)),!this.apiKey)throw new Error("API key is required");this.configInitialized=!0}}getHeaders(){return this.initializeConfig(),{"X-Api-Key":this.apiKey,"Content-Type":"application/json",Accept:"application/json"}}getMultipartHeaders(){return this.initializeConfig(),{"X-Api-Key":this.apiKey}}getBaseUrl(){return this.initializeConfig(),this.baseUrl}handleError(e,t){var i,n;console.error("API Error:",e);const s=(null==(n=null==(i=null==e?void 0:e.response)?void 0:i.data)?void 0:n.message)??(null==e?void 0:e.message)??t;throw new Error(s)}}const Do=class e{static setSecurityConfig(t){e.securityConfig={...e.securityConfig,...t}}static getSecurityConfig(){return{...e.securityConfig}}static getWidgetDomains(){return[...e.widgetDomains]}static addWidgetDomain(t){e.widgetDomains.includes(t)||(e.widgetDomains.push(t),this.log(`Added widget domain: ${t}`))}static removeWidgetDomain(t){const i=e.widgetDomains.indexOf(t);i>-1&&(e.widgetDomains.splice(i,1),this.log(`Removed widget domain: ${t}`))}static isWidgetDomain(t){return!(!t||"string"!=typeof t)&&e.widgetDomains.some((e=>t.includes(e)))}static log(e,t){this.securityConfig.logSecurityEvents&&console.log(`[SafeSecureFetch] ${e}`,t||"")}static error(e,t){console.error(`[SafeSecureFetch] ${e}`,t||"")}static emitSecurityEvent(e,t,i){const n={type:e,data:t,timestamp:(new Date).toISOString(),domain:i||"unknown"};"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("fetch-security-event",{detail:n})),this.log(`Security Event: ${e}`,{...t,domain:i})}static sanitizeURL(e){if(!e||"string"!=typeof e)return e;let t=e.trim();if(t.startsWith("data:")||t.startsWith("blob:")||t.startsWith("javascript:")||t.startsWith("//"))return t;if(this.securityConfig.widgetDomainsOnly&&!this.isWidgetDomain(t))return t;if(this.securityConfig.enforceHTTPS){if(t.match(/^http:\/\//i)){const i=t.replace(/^http:\/\//i,"https://");return this.log("URL upgraded to HTTPS:",{original:e,sanitized:i}),this.emitSecurityEvent("url_https_upgrade",{original:e,sanitized:i,reason:this.isWidgetDomain(e)?"widget_domain":"global_policy"},this.extractDomain(e)),i}const i=t.replace(/([^s])http:\/\//gi,"$1https://");if(i!==t)return this.log("Embedded HTTP URLs upgraded:",{original:t,processed:i}),this.emitSecurityEvent("embedded_http_upgrade",{original:t,processed:i},this.extractDomain(t)),i}return t}static extractDomain(e){try{return new URL(e).hostname}catch{return"invalid-url"}}static async validateSecureContext(e){if((!this.securityConfig.widgetDomainsOnly||this.isWidgetDomain(e))&&"undefined"!=typeof window){if(("https:"===window.location.protocol||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname)&&e.startsWith("http://")){const t=this.extractDomain(e),i=this.isWidgetDomain(e);if(this.error(`Potential mixed content: HTTPS page requesting HTTP resource: ${e}`),this.emitSecurityEvent("mixed_content_warning",{pageProtocol:window.location.protocol,requestUrl:e,hostname:window.location.hostname,isWidgetDomain:i},t),!this.securityConfig.enforceHTTPS)throw new Error(`Mixed content blocked: Cannot load HTTP resource from HTTPS page: ${e}`)}if(this.isWidgetDomain(e)){e.startsWith("https://")||this.emitSecurityEvent("widget_insecure_request",{url:e,protocol:e.startsWith("http://")?"http":"unknown"},this.extractDomain(e))}}}static isSecurityError(e){var t,i,n;if(!e)return!1;const s=(e.message||"").toLowerCase(),o=["mixed content","blocked by cors","insecure","ssl","tls","certificate","https required","upgrade required","security policy","net::err_ssl","net::err_cert","refused to connect"],r=o.some((e=>s.includes(e)))||426===(null==(t=e.response)?void 0:t.status)||400===(null==(i=e.response)?void 0:i.status)&&s.includes("mixed");return r&&this.emitSecurityEvent("security_error_detected",{error:e.message,status:null==(n=e.response)?void 0:n.status,keywords:o.filter((e=>s.includes(e)))}),r}static async customFetch(e,t={}){var i,n,s,o,r;try{const r="undefined"==typeof window||((null==(i=window.WIDGET_CONFIG)?void 0:i.isProduction)??!0),l="undefined"!=typeof window&&("https:"===window.location.protocol||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname),c=this.isWidgetDomain(e),d=this.extractDomain(e);this.log("Fetch request initiated:",{originalUrl:e,isProduction:r,isSecureContext:l,method:t.method||"GET",isWidgetDomain:c,domain:d});const u=this.sanitizeURL(e);await this.validateSecureContext(u);let h=u;if(r&&c){const t=h;h=h.replace(/^http:\/\//i,"https://"),h=h.replace(/([^s])http:\/\//gi,"$1https://"),t!==h&&(this.log("Production URL processing (widget domain):",{original:e,sanitized:u,final:h}),this.emitSecurityEvent("production_url_processing",{original:e,before:t,final:h,reason:"widget_domain_production"},d))}const g=!this.securityConfig.widgetDomainsOnly||c,p={...t,headers:{"Content-Type":"application/json",...g?{"X-Requested-With":"XMLHttpRequest","Cache-Control":"no-cache","X-CSRF-Protection":"1"}:{},...t.headers||{}},credentials:t.credentials||"same-origin",...t.integrity?{integrity:t.integrity}:{},signal:t.signal||(c&&AbortSignal.timeout?AbortSignal.timeout(3e4):void 0)};this.log("Making secure fetch request:",{url:h,method:p.method||"GET",hasAuth:!!(null==(n=p.headers)?void 0:n.Authorization)||!!(null==(s=p.headers)?void 0:s["X-Api-Key"]),isWidgetDomain:c,securityApplied:g});const f=await fetch(h,p);if(!f.ok){let t={};try{t=await f.json()}catch(a){t={message:`HTTP ${f.status}: ${f.statusText}`,status:f.status,statusText:f.statusText}}!c&&this.securityConfig.widgetDomainsOnly||(426===f.status?(this.error("Upgrade Required - Server requires HTTPS"),this.emitSecurityEvent("server_requires_https",{url:h,status:f.status,isWidgetDomain:c},d)):400===f.status&&(null==(o=t.message)?void 0:o.includes("mixed content"))?(this.error("Mixed content error detected"),this.emitSecurityEvent("mixed_content_error",{url:h,error:t.message,isWidgetDomain:c},d)):403===f.status?this.emitSecurityEvent("forbidden_access",{url:h,status:f.status,isWidgetDomain:c},d):f.status>=500&&this.emitSecurityEvent("server_error",{url:h,status:f.status,statusText:f.statusText,isWidgetDomain:c},d));throw{response:{_data:t,status:f.status,statusText:f.statusText,headers:Object.fromEntries(f.headers.entries())},message:t.message||`Request failed with status ${f.status}`,url:h,originalUrl:e,isWidgetDomain:c,securityRelated:this.isSecurityError(t)}}const m=f.headers.get("content-type"),y=f.headers.get("content-length");return this.log("Fetch request successful:",{url:h,status:f.status,contentType:m,contentLength:y?parseInt(y):void 0,isSecure:h.startsWith("https://"),isWidgetDomain:c}),this.emitSecurityEvent("fetch_success",{url:h,originalUrl:e,status:f.status,isSecure:h.startsWith("https://"),isWidgetDomain:c,contentType:m},d),await f.json()}catch(l){const t=this.isSecurityError(l),i=this.isWidgetDomain(e),n=this.extractDomain(e);throw this.error("Request failed:",{originalUrl:e,finalUrl:this.sanitizeURL(e),error:l.message||l,isSecurityRelated:t,isWidgetDomain:i,timestamp:(new Date).toISOString(),stack:null==(r=l.stack)?void 0:r.split("\n").slice(0,3)}),t&&(this.error("Security Error Detected - Recommended Actions:"),i?(this.error("1. Ensure widget API URLs use HTTPS"),this.error("2. Check widget server CORS configuration"),this.error("3. Verify SSL certificate validity for widget domain")):(this.error("1. Check third-party service configuration"),this.error("2. Verify external API security requirements")),this.error('4. Consider adding CSP meta tag: <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">'),this.emitSecurityEvent("security_error_with_guidance",{originalUrl:e,error:l.message,isWidgetDomain:i,recommendations:i?["Ensure widget API URLs use HTTPS","Check widget server CORS configuration","Verify SSL certificate validity for widget domain","Add CSP meta tag for automatic HTTPS upgrade"]:["Check third-party service configuration","Verify external API security requirements","Review CORS and SSL settings"]},n)),l}}static async testSecureConnection(e){const t=[];let i,n=!1,s=!1;const o=this.isWidgetDomain(e),r=this.extractDomain(e);try{const i=e.replace(/^http:\/\//i,"https://");this.log("Testing secure connection:",{baseUrl:e,httpsUrl:i,isWidgetDomain:o});const a=await fetch(i,{method:"HEAD",mode:"no-cors",cache:"no-cache",signal:AbortSignal.timeout?AbortSignal.timeout(1e4):void 0});n=!0,s=!0,this.log("HTTPS connection test successful:",{url:i,status:a.status,isWidgetDomain:o}),this.emitSecurityEvent("connection_test_success",{baseUrl:e,httpsUrl:i,status:a.status,isWidgetDomain:o},r),e.startsWith("http://")?o?(t.push(" HTTPS is supported for widget - consider updating default URLs to use HTTPS"),t.push(" Widget server accepts secure connections")):(t.push(" HTTPS is supported - this third-party service can use secure connections"),t.push(" Note: This is not a widget domain - security policies may differ")):t.push(" Already using HTTPS - excellent security posture")}catch(l){i=l.message,n=!1,s=!1,this.error("Connection test failed:",{baseUrl:e,error:l.message,isWidgetDomain:o}),this.emitSecurityEvent("connection_test_failed",{baseUrl:e,error:l.message,errorType:l.name,isWidgetDomain:o},r),e.startsWith("http://")&&(o?(t.push(" HTTP detected for widget domain - this may cause mixed content issues"),t.push(" Widget will auto-upgrade HTTP to HTTPS"),t.push(" Or update widget API endpoints to use HTTPS"),t.push(" Contact widget server administrator to enable HTTPS support")):(t.push(" HTTP detected for third-party service"),t.push(" Note: Widget security policies don't apply to this domain"),t.push(" Check third-party service security requirements"))),"undefined"!=typeof window&&"https:"===window.location.protocol&&(t.push(" Page is HTTPS but requested URL is HTTP - this causes mixed content blocking"),o?t.push(" Widget will handle HTTPS upgrade automatically"):t.push(" Third-party service may need manual HTTPS configuration"),t.push(" Long-term fix: Update all APIs to support HTTPS")),l.message.includes("net::ERR_SSL")?(t.push(" SSL certificate issue detected"),t.push(" Check certificate validity and configuration")):l.message.includes("CORS")&&(t.push(" CORS configuration may need adjustment"),o?t.push(" Ensure widget server allows cross-origin HTTPS requests"):t.push(" Check third-party service CORS settings"))}const a={success:s,httpsSupported:n,error:i,recommendations:t,isWidgetDomain:o};return this.log("Connection test completed:",a),a}static getSecurityStatus(){const e="undefined"!=typeof window&&("https:"===window.location.protocol||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname),t="undefined"!=typeof window?window.location.protocol:"unknown",i=[];if(e||(i.push(" Page is not served over HTTPS"),i.push(" Consider enabling HTTPS for better security")),"undefined"!=typeof window){!!document.querySelector('meta[http-equiv="Content-Security-Policy"]')||i.push(" Consider adding CSP meta tag for enhanced security")}return this.securityConfig.widgetDomainsOnly?(i.push(" Safe mode enabled - security measures only apply to widget domains"),i.push(` Protected domains: ${this.widgetDomains.join(", ")}`)):(i.push(" Global mode enabled - security measures apply to all requests"),i.push(" Consider enabling widgetDomainsOnly for safer operation")),{isSecureContext:e,protocol:t,securityConfig:this.getSecurityConfig(),widgetDomains:this.getWidgetDomains(),recommendations:i}}static setSecurityLogging(e){this.securityConfig.logSecurityEvents=e,this.log("Security logging "+(e?"enabled":"disabled"))}static setWidgetDomainsOnly(e){this.securityConfig.widgetDomainsOnly=e,this.log("Widget domains only mode "+(e?"enabled":"disabled")),e?this.log("Safe mode: Security measures will only apply to widget domains:",this.widgetDomains):this.log("Global mode: Security measures will apply to all requests")}static getSecurityEventHistory(){return[]}};i(Do,"securityConfig",{enforceHTTPS:!0,logSecurityEvents:!0,validateCertificates:!0,widgetDomainsOnly:!0}),i(Do,"widgetDomains",["cappuccino-api.bsa.id","cappucino-api.bsa.id","cappuccino.bsa.id","cappucino.bsa.id"]);let Po=Do;const Mo=Po.customFetch.bind(Po);Po.testSecureConnection.bind(Po),Po.getSecurityStatus.bind(Po),Po.setSecurityConfig.bind(Po),Po.setSecurityLogging.bind(Po),Po.setWidgetDomainsOnly.bind(Po),Po.addWidgetDomain.bind(Po),Po.removeWidgetDomain.bind(Po),Po.isWidgetDomain.bind(Po),Po.getWidgetDomains.bind(Po);const Wo=new class extends Oo{async getProfile(){var e,t;try{return await Mo(`${this.getBaseUrl()}/api/v1/profile/`,{method:"GET",headers:this.getHeaders()})}catch(i){throw console.error("Error fetching profile:",i),(null==(t=null==(e=null==i?void 0:i.response)?void 0:e._data)?void 0:t.message)??"Failed to fetch profile"}}async updateProfile(e){var t,i;try{return await Mo(`${this.getBaseUrl()}/api/v1/profile/`,{method:"PUT",body:JSON.stringify(e),headers:this.getHeaders()})}catch(n){throw console.error("Error updating profile:",n),(null==(i=null==(t=null==n?void 0:n.response)?void 0:t._data)?void 0:i.message)??"Failed to update profile"}}async updateStatus(e){var t,i;try{return await Mo(`${this.getBaseUrl()}/api/v1/profile/status`,{method:"PUT",body:JSON.stringify(e),headers:this.getHeaders()})}catch(n){throw console.error("Error updating status:",n),(null==(i=null==(t=null==n?void 0:n.response)?void 0:t._data)?void 0:i.message)??"Failed to update status"}}async uploadAvatar(e){var t,i;try{const t=this.getMultipartHeaders();return await fetch(`${this.getBaseUrl()}/api/v1/profile/avatar`,{method:"POST",body:e,headers:t}).then((e=>{if(!e.ok)throw new Error("Failed to upload avatar");return e.json()}))}catch(n){throw console.error("Error uploading avatar:",n),(null==(i=null==(t=null==n?void 0:n.response)?void 0:t._data)?void 0:i.message)??"Failed to upload avatar"}}async removeAvatar(){var e,t;try{return await Mo(`${this.getBaseUrl()}/api/v1/profile/avatar`,{method:"DELETE",headers:this.getHeaders()})}catch(i){throw console.error("Error removing avatar:",i),(null==(t=null==(e=null==i?void 0:i.response)?void 0:e._data)?void 0:t.message)??"Failed to remove avatar"}}},Uo=Co("profile",{state:()=>({user:null,isLoading:!1,error:null}),getters:{getUser:e=>e.user},actions:{async fetchProfile(){this.isLoading=!0,this.error=null;try{const e=await Wo.getProfile();if(!e._id||!e.email)throw new Error("Invalid user data received");return this.setProfile(e),this.user}catch(e){throw console.error("Error fetching user profile:",e),this.error=(null==e?void 0:e.message)||"Failed to fetch profile",e}finally{this.isLoading=!1}},async updateProfile(e){this.isLoading=!0,this.error=null;try{const t=await Wo.updateProfile(e);return this.setProfile(t),this.user}catch(t){throw console.error("Error updating user profile:",t),this.error=(null==t?void 0:t.message)||"Failed to update profile",t}finally{this.isLoading=!1}},async updateStatus(e,t){this.isLoading=!0,this.error=null;try{const i=await Wo.updateStatus({status:e,status_note:t});return this.setProfile(i),this.user}catch(i){throw console.error("Error updating user status:",i),this.error=(null==i?void 0:i.message)||"Failed to update status",i}finally{this.isLoading=!1}},async uploadAvatar(e){this.isLoading=!0,this.error=null;try{const t=await Wo.uploadAvatar(e);return this.setProfile(t),this.user}catch(t){throw console.error("Error uploading avatar:",t),this.error=(null==t?void 0:t.message)||"Failed to upload avatar",t}finally{this.isLoading=!1}},async removeAvatar(){this.isLoading=!0,this.error=null;try{const e=await Wo.removeAvatar();return this.setProfile(e),this.user}catch(e){throw console.error("Error removing avatar:",e),this.error=(null==e?void 0:e.message)||"Failed to remove avatar",e}finally{this.isLoading=!1}},setProfile(e){this.user=e;try{localStorage.setItem("user",JSON.stringify(e))}catch(t){console.error("Error saving user to localStorage:",t)}},clearProfile(){this.user=null;try{localStorage.removeItem("user")}catch(e){console.error("Error removing user from localStorage:",e)}},loadProfile(){try{const e=localStorage.getItem("user");if(e)return this.user=JSON.parse(e),!0}catch(e){console.error("Error loading user from localStorage:",e),this.clearProfile()}return!1}}});const Lo=new class extends Oo{async fetchTickets(e){var t,i;try{const t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.pageSize&&t.append("page_size",e.pageSize.toString()),e.filters&&(e.filters.companyId&&t.append("company_id",e.filters.companyId),e.filters.status&&"all"!==e.filters.status&&t.append("status",e.filters.status),e.filters.priority&&"all"!==e.filters.priority&&t.append("priority",e.filters.priority),e.filters.type&&"all"!==e.filters.type&&t.append("type",e.filters.type),e.filters.cs_id&&t.append("cs_id",e.filters.cs_id),e.filters.search&&t.append("search",e.filters.search)),await Mo(`${this.getBaseUrl()}/api/v1/tickets?${t.toString()}`,{headers:this.getHeaders()})}catch(n){throw console.error("Error fetching tickets:",n),(null==(i=null==(t=null==n?void 0:n.response)?void 0:t._data)?void 0:i.message)??"Failed to fetch tickets"}}async getTicketById(e){var t,i;try{return await Mo(`${this.getBaseUrl()}/api/v1/tickets/${e}`,{headers:this.getHeaders()})}catch(n){throw console.error("Error fetching ticket:",n),(null==(i=null==(t=null==n?void 0:n.response)?void 0:t._data)?void 0:i.message)??"Failed to fetch ticket"}}async createTicket(e,t){var i,n;try{return await Mo(`${this.getBaseUrl()}/api/v1/tickets?chat_id=${t}`,{method:"POST",body:JSON.stringify(e),headers:this.getHeaders()})}catch(s){throw console.error("Error creating ticket:",s),(null==(n=null==(i=null==s?void 0:s.response)?void 0:i._data)?void 0:n.message)??"Failed to create ticket"}}async updateTicket(e,t){var i,n;try{return await Mo(`${this.getBaseUrl()}/api/v1/tickets/${e}`,{method:"PUT",body:JSON.stringify(t),headers:this.getHeaders()})}catch(s){throw console.error("Error updating ticket:",s),(null==(n=null==(i=null==s?void 0:s.response)?void 0:i._data)?void 0:n.message)??"Failed to update ticket"}}async assignTicket(e,t){var i,n;try{return await Mo(`${this.getBaseUrl()}/api/v1/tickets/${e}/assign`,{method:"PUT",body:JSON.stringify({cs_id:t}),headers:this.getHeaders()})}catch(s){throw console.error("Error assigning ticket:",s),(null==(n=null==(i=null==s?void 0:s.response)?void 0:i._data)?void 0:n.message)??"Failed to assign ticket"}}async resolveTicket(e){var t,i;try{return await Mo(`${this.getBaseUrl()}/api/v1/tickets/${e}/resolve`,{method:"PUT",headers:this.getHeaders()})}catch(n){throw console.error("Error resolving ticket:",n),(null==(i=null==(t=null==n?void 0:n.response)?void 0:t._data)?void 0:i.message)??"Failed to resolve ticket"}}async closeTicket(e){var t,i;try{return await Mo(`${this.getBaseUrl()}/api/v1/tickets/${e}/close`,{method:"PUT",headers:this.getHeaders()})}catch(n){throw console.error("Error closing ticket:",n),(null==(i=null==(t=null==n?void 0:n.response)?void 0:t._data)?void 0:i.message)??"Failed to close ticket"}}async reopenTicket(e){var t,i;try{return await Mo(`${this.getBaseUrl()}/api/v1/tickets/${e}/reopen`,{method:"PUT",headers:this.getHeaders()})}catch(n){throw console.error("Error reopening ticket:",n),(null==(i=null==(t=null==n?void 0:n.response)?void 0:t._data)?void 0:i.message)??"Failed to reopen ticket"}}},Ro=Co("tickets",{state:()=>({tickets:[],selectedTicket:null,meta:null,isLoading:!1,error:null,isResolving:!1,isClosing:!1,isReopening:!1,isAssigning:!1,lastActionResult:null,filters:{companyId:void 0,status:"all",priority:"all",type:"all",search:"",cs_id:void 0}}),getters:{isAnyActionLoading:e=>e.isResolving||e.isClosing||e.isReopening||e.isAssigning,openTickets:e=>e.tickets.filter((e=>"open"===e.status)),activeTickets:e=>e.tickets.filter((e=>"active"===e.status)),resolvedTickets:e=>e.tickets.filter((e=>"resolved"===e.status)),closedTickets:e=>e.tickets.filter((e=>"closed"===e.status)),canResolveSelected(e){var t;const i=e.isResolving||e.isClosing||e.isReopening||e.isAssigning;return"active"===(null==(t=e.selectedTicket)?void 0:t.status)&&!i},canCloseSelected(e){var t;const i=e.isResolving||e.isClosing||e.isReopening||e.isAssigning;return"resolved"===(null==(t=e.selectedTicket)?void 0:t.status)&&!i},canReopenSelected(e){var t;const i=e.isResolving||e.isClosing||e.isReopening||e.isAssigning;return"closed"===(null==(t=e.selectedTicket)?void 0:t.status)&&!i},availableActions(e){if(!e.selectedTicket)return[];const t=e.isResolving||e.isClosing||e.isReopening||e.isAssigning,i=[];return"active"!==e.selectedTicket.status||t||i.push({type:"resolve",label:"Mark as Resolved",icon:"check-circle",color:"green",description:"Mark this ticket as resolved"}),"resolved"!==e.selectedTicket.status||t||i.push({type:"close",label:"Close Ticket",icon:"x-circle",color:"gray",description:"Close this ticket permanently"}),"closed"!==e.selectedTicket.status||t||i.push({type:"reopen",label:"Reopen Ticket",icon:"refresh",color:"amber",description:"Reopen this ticket for further assistance"}),i}},actions:{clearActionResult(){this.lastActionResult=null},setActionResult(e,t=5e3){this.lastActionResult=e,t>0&&setTimeout((()=>{this.lastActionResult===e&&(this.lastActionResult=null)}),t)},async fetchTickets(e=1,t=10){this.isLoading=!0,this.error=null;try{const i=await Lo.fetchTickets({page:e,pageSize:t,filters:this.filters});this.tickets=i.data,this.meta=i.meta}catch(i){throw this.error=i.message??"Failed to fetch tickets",i}finally{this.isLoading=!1}},async getTicketById(e){this.isLoading=!0,this.error=null;try{const t=await Lo.getTicketById(e);return this.selectedTicket=t,t}catch(t){throw this.error=t.message??"Failed to fetch ticket",t}finally{this.isLoading=!1}},async createTicket(e,t){try{return await Lo.createTicket(e,t)}catch(i){throw this.error=i.message??"Failed to create ticket",i}},async updateTicket(e,t){var i;try{const n=await Lo.updateTicket(e,t);(null==(i=this.selectedTicket)?void 0:i._id)===e&&(this.selectedTicket=n);const s=this.tickets.findIndex((t=>t._id===e));return-1!==s&&(this.tickets[s]=n),n}catch(n){throw this.error=n.message??"Failed to update ticket",n}},async assignTicket(e,t){var i,n;this.isAssigning=!0,this.error=null,this.clearActionResult();try{const s=await Lo.assignTicket(e,t);(null==(i=this.selectedTicket)?void 0:i._id)===e&&(this.selectedTicket=s);const o=this.tickets.findIndex((t=>t._id===e));return-1!==o&&(this.tickets[o]=s),this.setActionResult({success:!0,message:`Ticket successfully assigned to ${(null==(n=s.cs_user)?void 0:n.full_name)||"CS agent"}`,ticket:s}),s}catch(s){const e=s.message??"Failed to assign ticket";throw this.error=e,this.setActionResult({success:!1,message:"Failed to assign ticket",error:e}),s}finally{this.isAssigning=!1}},async resolveTicket(e){var t;this.isResolving=!0,this.error=null,this.clearActionResult();try{console.log(`[TicketsStore] Resolving ticket: ${e}`);const i=await Lo.resolveTicket(e);(null==(t=this.selectedTicket)?void 0:t._id)===e&&(this.selectedTicket=i,console.log(`[TicketsStore] Updated selected ticket status to: ${i.status}`));const n=this.tickets.findIndex((t=>t._id===e));return-1!==n&&(this.tickets[n]=i,console.log(`[TicketsStore] Updated ticket in list at index: ${n}`)),this.setActionResult({success:!0,message:`Ticket "${i.title}" has been marked as resolved`,ticket:i}),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("ticket-resolved",{detail:{ticket:i}})),console.log("[TicketsStore] Ticket resolved successfully"),i}catch(i){const e=i.message??"Failed to resolve ticket";throw this.error=e,this.setActionResult({success:!1,message:"Failed to resolve ticket",error:e}),console.error("[TicketsStore] Error resolving ticket:",i),i}finally{this.isResolving=!1}},async closeTicket(e){var t;this.isClosing=!0,this.error=null,this.clearActionResult();try{console.log(`[TicketsStore] Closing ticket: ${e}`);const i=await Lo.closeTicket(e);(null==(t=this.selectedTicket)?void 0:t._id)===e&&(this.selectedTicket=i,console.log(`[TicketsStore] Updated selected ticket status to: ${i.status}`));const n=this.tickets.findIndex((t=>t._id===e));return-1!==n&&(this.tickets[n]=i,console.log(`[TicketsStore] Updated ticket in list at index: ${n}`)),this.setActionResult({success:!0,message:`Ticket "${i.title}" has been closed`,ticket:i}),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("ticket-closed",{detail:{ticket:i}})),console.log("[TicketsStore] Ticket closed successfully"),i}catch(i){const e=i.message??"Failed to close ticket";throw this.error=e,this.setActionResult({success:!1,message:"Failed to close ticket",error:e}),console.error("[TicketsStore] Error closing ticket:",i),i}finally{this.isClosing=!1}},async reopenTicket(e){var t;this.isReopening=!0,this.error=null,this.clearActionResult();try{console.log(`[TicketsStore] Reopening ticket: ${e}`);const i=await Lo.reopenTicket(e);(null==(t=this.selectedTicket)?void 0:t._id)===e&&(this.selectedTicket=i,console.log(`[TicketsStore] Updated selected ticket status to: ${i.status}`));const n=this.tickets.findIndex((t=>t._id===e));return-1!==n&&(this.tickets[n]=i,console.log(`[TicketsStore] Updated ticket in list at index: ${n}`)),this.setActionResult({success:!0,message:`Ticket "${i.title}" has been reopened`,ticket:i}),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("ticket-reopened",{detail:{ticket:i}})),console.log("[TicketsStore] Ticket reopened successfully"),i}catch(i){const e=i.message??"Failed to reopen ticket";throw this.error=e,this.setActionResult({success:!1,message:"Failed to reopen ticket",error:e}),console.error("[TicketsStore] Error reopening ticket:",i),i}finally{this.isReopening=!1}},async bulkResolveTickets(e){this.isResolving=!0,this.error=null;const t=[];let i=0,n=0;try{for(const o of e)try{const e=await this.resolveTicket(o);t.push({id:o,success:!0,ticket:e}),i++}catch(s){t.push({id:o,success:!1,error:s.message}),n++}return this.setActionResult({success:0===n,message:`Bulk resolve completed: ${i} successful, ${n} failed`}),t}finally{this.isResolving=!1}},async bulkCloseTickets(e){this.isClosing=!0,this.error=null;const t=[];let i=0,n=0;try{for(const o of e)try{const e=await this.closeTicket(o);t.push({id:o,success:!0,ticket:e}),i++}catch(s){t.push({id:o,success:!1,error:s.message}),n++}return this.setActionResult({success:0===n,message:`Bulk close completed: ${i} successful, ${n} failed`}),t}finally{this.isClosing=!1}},setFilters(e){this.filters={...this.filters,...e}},resetFilters(){this.filters={companyId:void 0,status:"all",priority:"all",type:"all",search:"",cs_id:void 0}},getTicketFromList(e){return this.tickets.find((t=>t._id===e))},updateTicketStatusLocally(e,t){var i;(null==(i=this.selectedTicket)?void 0:i._id)===e&&(this.selectedTicket.status=t);const n=this.tickets.findIndex((t=>t._id===e));-1!==n&&(this.tickets[n].status=t)},canPerformAction(e,t){const i=t||this.selectedTicket;if(!i)return!1;const n=this.isResolving||this.isClosing||this.isReopening||this.isAssigning;switch(e){case"resolve":return"active"===i.status&&!n;case"close":return"resolved"===i.status&&!n;case"reopen":return"closed"===i.status&&!n;default:return!1}},getActionButtons(e){const t=e||this.selectedTicket;if(!t)return[];const i=[];return this.canPerformAction("resolve",t)&&i.push({type:"resolve",label:"Resolve",icon:"check",color:"green",action:()=>this.resolveTicket(t._id),loading:this.isResolving,description:"Mark as resolved"}),this.canPerformAction("close",t)&&i.push({type:"close",label:"Close",icon:"x",color:"gray",action:()=>this.closeTicket(t._id),loading:this.isClosing,description:"Close ticket"}),this.canPerformAction("reopen",t)&&i.push({type:"reopen",label:"Reopen",icon:"refresh",color:"amber",action:()=>this.reopenTicket(t._id),loading:this.isReopening,description:"Reopen ticket"}),i}}}),Fo=Co("ticket-chat",{state:()=>({isConnected:!1,messages:[],isCustomerTyping:!1}),actions:{async initializeChat(){try{const e=Io.getInstance();await e.initializeConnection(),this.isConnected=!0,e.onMessage(Eo.CHAT,(e=>{console.log("[Store] Received chat message:",e),this.isCustomerTyping=!1;const t={_id:e._id||Date.now().toString(),created_at:e.timestamp||(new Date).toISOString(),updated_at:null,deleted_at:null,code:e.code,user_id:e.sender_id||"",avatar:e.avatar||null,cs_id:null,role:e.role,content:e.content};this.messages.push(t);const i=Ro();i.selectedTicket&&(Array.isArray(i.selectedTicket.chat_history)||(i.selectedTicket.chat_history=[]),i.selectedTicket.chat_history.push(t))})),e.onMessage(Eo.TYPING,(e=>{console.log("Typing Indicator Received:",{isTyping:e.is_typing,role:e.role,senderId:e.sender_id}),"customer"===e.role&&(this.isCustomerTyping=e.is_typing,console.log("Updated isCustomerTyping:",this.isCustomerTyping))})),e.onStatusChange((e=>{this.isConnected=e}))}catch(e){throw console.error("Failed to initialize chat:",e),this.isConnected=!1,e}},async sendMessage(e,t){var i,n,s,o,r;const a=Uo(),l=Io.getInstance();if(console.log("Checking WebSocket connection:",this.isConnected),!this.isConnected)throw new Error("WebSocket not connected");console.log("Sending message:",e);try{const c={_id:Date.now().toString(),created_at:(new Date).toISOString(),updated_at:null,deleted_at:null,avatar:null==(i=a.getUser)?void 0:i.avatar,code:t,user_id:a.$id,cs_id:null,role:null==(n=a.getUser)?void 0:n.role,content:e};await l.sendMessage({type:"chat_message",code:t,content:e,sender_name:(null==(s=a.getUser)?void 0:s.full_name)?null==(o=a.getUser)?void 0:o.full_name:"CS Agent",avatar:null==(r=a.getUser)?void 0:r.avatar}),this.messages.push(c);const d=Ro();d.selectedTicket&&(Array.isArray(d.selectedTicket.chat_history)||(d.selectedTicket.chat_history=[]),d.selectedTicket.chat_history.push(c))}catch(c){throw console.error("Failed to send message:",c),c}},async sendTypingIndicator(e,t){const i=Io.getInstance();if(!this.isConnected)throw new Error("WebSocket not connected");try{console.log("[store] Sending typing indicator"),await i.sendTypingIndicator({type:"typing_indicator",code:t,is_typing:e,sender_id:Uo().$id,role:"cs"})}catch(n){throw console.error("Failed to send typing status:",n),n}},setInitialMessages(e){this.messages=e},setTypingStatus(e){this.isCustomerTyping=e},cleanup(){this.isConnected=!1,this.messages=[],this.isCustomerTyping=!1}}}),jo=class e{static initAudioContext(){if(!e.audioContext)try{const t=window.AudioContext||window.webkitAudioContext;e.audioContext=new t}catch(t){console.error("Web Audio API is not supported in this browser",t)}}static async loadSound(t){const i=t||e.customSoundUrl||e.defaultSoundUrl;if(e.audioContext||e.initAudioContext(),e.audioContext)try{const n=await fetch(i,{mode:"cors"}),s=await n.arrayBuffer();e.notificationSound=await e.audioContext.decodeAudioData(s),t&&(e.customSoundUrl=t)}catch(n){console.error("Error loading notification sound:",n),console.error("Failed URL:",i);try{const t=new Audio(i);await t.load(),e.useExternalSound=!0,console.log("Fallback to HTML Audio API")}catch(s){console.error("Both Web Audio API and HTML Audio API failed:",s)}}else console.error("Could not initialize audio context")}static async playNotification(){if(!e.isEnabled)return;const t=e.customSoundUrl||e.defaultSoundUrl;if(e.audioContext&&e.notificationSound)try{"suspended"===e.audioContext.state&&await e.audioContext.resume();const t=e.audioContext.createBufferSource();t.buffer=e.notificationSound;const i=e.audioContext.createGain();return i.gain.value=e.volume,t.connect(i),i.connect(e.audioContext.destination),void t.start(0)}catch(i){console.error("Error playing notification sound with Web Audio API:",i)}if(e.useExternalSound)try{const i=new Audio(t);i.volume=e.volume,i.play().catch((e=>{console.error("HTMLAudioElement playback failed:",e)}))}catch(i){console.error("Error playing notification with HTML Audio API:",i)}else try{await e.loadSound(),e.playNotification()}catch(i){console.error("Could not load notification sound",i)}}static setEnabled(t){e.isEnabled=t}static setVolume(t){t>=0&&t<=1&&(e.volume=t)}static setCustomSound(t){e.customSoundUrl=t,e.loadSound(t)}static testSound(){e.playNotification()}static getCurrentSoundUrl(){return e.customSoundUrl||e.defaultSoundUrl}};i(jo,"audioContext",null),i(jo,"notificationSound",null),i(jo,"defaultSoundUrl","https://cdn.pixabay.com/download/audio/2021/08/04/audio_0625c1539c.mp3"),i(jo,"customSoundUrl",null),i(jo,"isEnabled",!0),i(jo,"volume",.5),i(jo,"useExternalSound",!0);let Ho=jo;const $o=Co("chat-theme",{state:()=>({currentTheme:"light",isInitialized:!1}),getters:{isDark:e=>(console.log("isDark getter called, currentTheme:",e.currentTheme),"dark"===e.currentTheme),isLight:e=>"light"===e.currentTheme},actions:{toggleTheme(){const e=this.currentTheme;this.currentTheme="light"===this.currentTheme?"dark":"light",console.log("Theme toggled from",e,"to",this.currentTheme),this.saveToStorage(),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("widget-theme-change",{detail:{theme:this.currentTheme,isDark:this.isDark}}))},setTheme(e){console.log("Setting theme to:",e),e!==this.currentTheme&&(this.currentTheme=e,this.saveToStorage(),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("widget-theme-change",{detail:{theme:this.currentTheme,isDark:this.isDark}}))),this.isInitialized=!0},initializeFromStorage(){if("undefined"!=typeof window)try{const e=localStorage.getItem("cappuccino-widget-theme");!e||"light"!==e&&"dark"!==e||(console.log("Loading theme from storage:",e),this.currentTheme=e)}catch(e){console.warn("Failed to load theme from storage:",e)}this.isInitialized=!0},saveToStorage(){if("undefined"!=typeof window)try{localStorage.setItem("cappuccino-widget-theme",this.currentTheme),console.log("Theme saved to storage:",this.currentTheme)}catch(e){console.warn("Failed to save theme to storage:",e)}},debug(){console.log("=== THEME STORE DEBUG ==="),console.log("currentTheme:",this.currentTheme),console.log("isDark:",this.isDark),console.log("isLight:",this.isLight),console.log("isInitialized:",this.isInitialized),"undefined"!=typeof window&&console.log("localStorage:",localStorage.getItem("cappuccino-widget-theme")),console.log("========================")}}});var Bo=(e=>(e.OPEN="open",e.ASSIGNED="assigned",e.ACTIVE="active",e.RESOLVED="resolved",e.CLOSED="closed",e.REOPENED="reopened",e))(Bo||{}),zo=(e=>(e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.URGENT="urgent",e))(zo||{}),No=(e=>(e.COMPLAINT="complaint",e.INFORMATION="information",e.SUPPORT="support",e.FEEDBACK="feedback",e))(No||{}),Go="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Vo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function qo(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var i=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(i,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),i}var Ko=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};const Zo=qo(n({__proto__:null,default:Vo(Ko)},[Ko]));var Jo="object"==typeof Go&&Go&&Go.Object===Object&&Go;var Xo=qo(n({__proto__:null,default:Vo(Jo)},[Jo])),Yo="object"==typeof self&&self&&self.Object===Object&&self,Qo=Xo||Yo||Function("return this")();const er=qo(n({__proto__:null,default:Vo(Qo)},[Qo]));var tr=er,ir=function(){return tr.Date.now()};const nr=qo(n({__proto__:null,default:Vo(ir)},[ir]));var sr=/\s/;var or=function(e){for(var t=e.length;t--&&sr.test(e.charAt(t)););return t};var rr=qo(n({__proto__:null,default:Vo(or)},[or])),ar=/^\s+/;var lr=function(e){return e?e.slice(0,rr(e)+1).replace(ar,""):e};const cr=qo(n({__proto__:null,default:Vo(lr)},[lr]));var dr=er.Symbol;const ur=qo(n({__proto__:null,default:Vo(dr)},[dr]));var hr=ur,gr=Object.prototype,pr=gr.hasOwnProperty,fr=gr.toString,mr=hr?hr.toStringTag:void 0;var yr=function(e){var t=pr.call(e,mr),i=e[mr];try{e[mr]=void 0;var n=!0}catch(o){}var s=fr.call(e);return n&&(t?e[mr]=i:delete e[mr]),s};const vr=qo(n({__proto__:null,default:Vo(yr)},[yr]));var wr=Object.prototype.toString;var kr=function(e){return wr.call(e)};var br=vr,Tr=qo(n({__proto__:null,default:Vo(kr)},[kr])),xr=ur?ur.toStringTag:void 0;var Cr=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":xr&&xr in Object(e)?br(e):Tr(e)};var Sr=function(e){return null!=e&&"object"==typeof e};var _r=qo(n({__proto__:null,default:Vo(Cr)},[Cr])),Er=qo(n({__proto__:null,default:Vo(Sr)},[Sr]));var Ar=function(e){return"symbol"==typeof e||Er(e)&&"[object Symbol]"==_r(e)};var Ir=cr,Or=Zo,Dr=qo(n({__proto__:null,default:Vo(Ar)},[Ar])),Pr=/^[-+]0x[0-9a-f]+$/i,Mr=/^0b[01]+$/i,Wr=/^0o[0-7]+$/i,Ur=parseInt;var Lr=function(e){if("number"==typeof e)return e;if(Dr(e))return NaN;if(Or(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Or(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Ir(e);var i=Mr.test(e);return i||Wr.test(e)?Ur(e.slice(2),i?2:8):Pr.test(e)?NaN:+e};var Rr=Zo,Fr=nr,jr=qo(n({__proto__:null,default:Vo(Lr)},[Lr])),Hr=Math.max,$r=Math.min;var Br=function(e,t,i){var n,s,o,r,a,l,c=0,d=!1,u=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function g(t){var i=n,o=s;return n=s=void 0,c=t,r=e.apply(o,i)}function p(e){var i=e-l;return void 0===l||i>=t||i<0||u&&e-c>=o}function f(){var e=Fr();if(p(e))return m(e);a=setTimeout(f,function(e){var i=t-(e-l);return u?$r(i,o-(e-c)):i}(e))}function m(e){return a=void 0,h&&n?g(e):(n=s=void 0,r)}function y(){var e=Fr(),i=p(e);if(n=arguments,s=this,l=e,i){if(void 0===a)return function(e){return c=e,a=setTimeout(f,t),d?g(e):r}(l);if(u)return clearTimeout(a),a=setTimeout(f,t),g(l)}return void 0===a&&(a=setTimeout(f,t)),r}return t=jr(t)||0,Rr(i)&&(d=!!i.leading,o=(u="maxWait"in i)?Hr(jr(i.maxWait)||0,t):o,h="trailing"in i?!!i.trailing:h),y.cancel=function(){void 0!==a&&clearTimeout(a),c=0,n=l=s=a=void 0},y.flush=function(){return void 0===a?r:m(Fr())},y};const zr=Vo(Br),Nr=ai({__name:"Icons",props:{name:{type:String,required:!0}},setup(e,{expose:t}){t();const i={};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}}),Gr=(e,t)=>{const i=e.__vccOpts||e;for(const[n,s]of t)i[n]=s;return i},Vr={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-message-circle"},qr=[es("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"},null,-1)],Kr={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-send"},Zr=[es("line",{x1:"22",y1:"2",x2:"11",y2:"13"},null,-1),es("polygon",{points:"22 2 15 22 11 13 2 9 22 2"},null,-1)],Jr={key:2,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-x"},Xr=[es("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),es("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1)],Yr=es("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-bell"},[es("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),es("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})],-1),Qr=ss('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bell-off"><path d="M13.73 21a2 2 0 0 1-3.46 0"></path><path d="M18.63 13A17.89 17.89 0 0 1 18 8"></path><path d="M6.26 6.26A5.86 5.86 0 0 0 6 8c0 7-3 9-3 9h14"></path><path d="M18 8a6 6 0 0 0-9.33-5"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>',1),ea={key:5,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-settings"},ta=[es("circle",{cx:"12",cy:"12",r:"3"},null,-1),es("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},null,-1)],ia=es("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-volume-2"},[es("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}),es("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"})],-1);const na=Gr(Nr,[["render",function(e,t,i,n,s,o){return"message-circle"===i.name?(Gn(),Zn("svg",Vr,[...qr])):"send"===i.name?(Gn(),Zn("svg",Kr,[...Zr])):"x"===i.name?(Gn(),Zn("svg",Jr,[...Xr])):"bell"===i.name?(Gn(),Zn(jn,{key:3},[os(" Bell Icon "),Yr],2112)):"bell-off"===i.name?(Gn(),Zn(jn,{key:4},[os(" Bell Off Icon "),Qr],2112)):"settings"===i.name?(Gn(),Zn("svg",ea,[...ta])):"volume"===i.name?(Gn(),Zn(jn,{key:6},[os(" Volume Icon "),ia],2112)):os("v-if",!0)}],["__file","D:/nuxtjs/cappuccino-fe/widget/chat-box/components/icons/Icons.vue"]]),sa=ai({__name:"TicketChat",props:{ticket:{type:Object,required:!0}},emits:["sendMessage"],setup(e,{expose:t,emit:i}){t();const n=e,s=i,o=St(null),r=St(""),a=Fo(),l=Uo(),{isConnected:c,messages:d,isCustomerTyping:u}=So(a),h=St(!1),g=St(null),p=e=>{if(!e)return"";try{const n="undefined"!=typeof window&&window.WIDGET_DEBUG;n&&console.log("[TimeFormat] Raw input:",e);let s=e.trim();/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?$/.test(s)&&(s+="Z",n&&console.log("[TimeFormat] Added Z for UTC:",s));const o=new Date(s);if(isNaN(o.getTime()))return console.error("[TimeFormat] Invalid date:",e),"";let r;n&&(console.log("[TimeFormat] Parsed UTC date:",o.toISOString()),console.log("[TimeFormat] Browser timezone offset:",o.getTimezoneOffset(),"minutes"));try{r=Intl.DateTimeFormat().resolvedOptions().timeZone,n&&console.log("[TimeFormat] Detected timezone:",r)}catch(t){r=""}try{let t;if(t=r?o.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",timeZone:r}):o.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),n){const i=o.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",timeZone:"UTC"}),n=o.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",timeZone:"Asia/Jakarta"});console.log("[TimeFormat] UTC:",i,"Jakarta:",n,"User:",t),console.log("[TimeFormat] Conversion successful:",e,"->",t)}return t}catch(i){console.warn("[TimeFormat] Formatting failed:",i);const e=o.getHours().toString().padStart(2,"0");return`${e}:${o.getMinutes().toString().padStart(2,"0")}`}}catch(n){return console.error("[TimeFormat] Error:",n,"Input:",e),""}},f=zr((async e=>{if(n.ticket.chat_code)try{await a.sendTypingIndicator(e,n.ticket.chat_code)}catch(t){console.error("Failed to send typing status:",t)}}),300),m=()=>{r.value.trim()&&(f.cancel(),n.ticket.chat_code&&a.sendTypingIndicator(!1,n.ticket.chat_code),s("sendMessage",r.value),r.value="",setTimeout(y,100))},y=()=>{o.value&&(o.value.scrollTop=o.value.scrollHeight,h.value=!1)},v=()=>{if(!o.value)return;const{scrollTop:e,scrollHeight:t,clientHeight:i}=o.value,n=t-e-i;h.value=n>100};_n([()=>{var e;return null==(e=n.ticket.chat_history)?void 0:e.length},()=>a.isCustomerTyping],(()=>{console.log("Customer typing: ",a.isCustomerTyping),setTimeout(y,100)})),yi((()=>{y(),o.value&&o.value.addEventListener("scroll",v)})),bi((()=>{g.value&&clearTimeout(g.value),f.cancel(),o.value&&o.value.removeEventListener("scroll",v)}));const w=Cs((()=>{var e;const t=new Map;return null==(e=n.ticket.chat_history)||e.forEach((e=>{t.set(e._id,e)})),d.value.forEach((e=>{t.set(e._id,e)})),Array.from(t.values()).sort(((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()))})),k=Cs((()=>{const e={};return w.value.forEach((t=>{try{"undefined"!=typeof window&&window.WIDGET_DEBUG&&0===Object.keys(e).length&&console.log("[DateGrouping] First message:",t.created_at);let n=t.created_at.trim();/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?$/.test(n)&&(n+="Z");const s=new Date(n);let o;try{const e=Intl.DateTimeFormat().resolvedOptions().timeZone;o=s.toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:e})}catch(i){o=s.toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}e[o]||(e[o]=[]),e[o].push(t)}catch(i){console.error("Error processing message date:",i,t);const n="Unknown Date";e[n]||(e[n]=[]),e[n].push(t)}})),e}));"undefined"!=typeof window&&(window.testChatTimeFormat=e=>{console.log("Testing chat time format:"),console.log("Input:",e),console.log("Output:",p(e));["2025-06-12T08:54:14.664000","2025-06-12T10:09:48.782000","2025-06-12T11:32:12.424000"].forEach((e=>{const t=p(e);console.log(`${e} -> ${t}`)}))});const b={props:n,emit:s,chatContainer:o,newMessage:r,ticketChatStore:a,profileStore:l,isConnected:c,wsMessages:d,isCustomerTyping:u,showScrollButton:h,typingTimeout:g,formatTime:p,debouncedTypingStatus:f,handleSendMessage:m,scrollToBottom:y,handleScroll:v,handleInput:e=>{const t=e.target.value;if(!n.ticket.chat_code)return;const i=e.target;i.style.height="auto",i.style.height=Math.min(i.scrollHeight,120)+"px",t.length>0?f(!0):f(!1)},allMessages:w,isLeftSideMessage:e=>{var t;return e!==(null==(t=l.getUser)?void 0:t.role)},getSenderName:e=>{switch(e.role){case"customer":return"Customer";case"assistant":return"AI Assistant";case"cs":return"Customer Service";case"admin":return"Admin";default:return e.role}},groupedMessages:k,getMessageStyle:e=>{const t="px-3 py-1.5 rounded-lg break-words max-w-[280px] shadow-sm";switch(e.role){case"admin":return`${t} bg-green-500 text-white`;case"cs":return`${t} bg-blue-500 text-white`;case"assistant":return`${t} bg-emerald-100 dark:bg-emerald-900/20 text-emerald-800 dark:text-emerald-300`;default:return`${t} bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white`}},sendMessageWithEnter:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),m())},IconsComponent:na};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),oa=e=>(ii("data-v-ad8e483a"),e=e(),ni(),e),ra={class:"chat-container h-full flex flex-col relative overflow-hidden"},aa={class:"p-2 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"},la={class:"flex justify-between items-center"},ca=oa((()=>es("h2",{class:"text-sm font-bold text-gray-900 dark:text-white flex items-center"},[es("svg",{class:"h-4 w-4 mr-1.5 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"})]),ns(" Conversation ")],-1))),da={key:0,class:"flex items-center text-xs text-emerald-500"},ua=oa((()=>es("span",{class:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-1 animate-pulse"},null,-1))),ha={key:1,class:"flex items-center text-xs text-amber-500"},ga=oa((()=>es("span",{class:"w-1.5 h-1.5 bg-amber-500 rounded-full mr-1 animate-pulse"},null,-1))),pa={class:"flex justify-center my-2"},fa={class:"px-2 py-0.5 rounded-full text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 shadow-sm"},ma={class:"text-xs whitespace-pre-wrap"},ya={key:0,class:"flex flex-col items-center justify-center h-32 text-gray-500"},va=[oa((()=>es("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1))),oa((()=>es("p",{class:"text-sm font-medium"},"No messages yet",-1))),oa((()=>es("p",{class:"text-xs text-gray-400 mt-1"},"Start the conversation",-1)))],wa={key:1,class:"flex items-start space-x-2 animate-fade-in"},ka=[ss('<div class="inline-flex items-center space-x-2 px-3 py-1.5 bg-gray-100 dark:bg-gray-800 rounded-lg shadow-sm" data-v-ad8e483a><span class="text-xs text-gray-600 dark:text-gray-400" data-v-ad8e483a> Customer is typing </span><span class="flex space-x-1" data-v-ad8e483a><span class="w-1 h-1 bg-gray-500 dark:bg-gray-400 rounded-full animate-bounce" style="animation-delay:0ms;" data-v-ad8e483a></span><span class="w-1 h-1 bg-gray-500 dark:bg-gray-400 rounded-full animate-bounce" style="animation-delay:150ms;" data-v-ad8e483a></span><span class="w-1 h-1 bg-gray-500 dark:bg-gray-400 rounded-full animate-bounce" style="animation-delay:300ms;" data-v-ad8e483a></span></span></div>',1)],ba=[oa((()=>es("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)))],Ta={class:"cs-chat-input-container dark:bg-gray-800 dark:border-gray-700"},xa={class:"flex items-center space-x-3",style:{"align-items":"center",display:"flex"}},Ca=oa((()=>es("button",{class:"flex-shrink-0 flex items-center justify-center rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",style:{height:"40px",width:"40px","min-height":"40px","min-width":"40px"},type:"button"},[es("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-gray-500 dark:text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})])],-1))),Sa={class:"flex-1",style:{flex:"1"}},_a=["disabled"];const Ea=Gr(sa,[["render",function(e,t,i,n,s,o){var r;return Gn(),Zn("div",ra,[os(" Chat Header "),es("div",aa,[es("div",la,[ca,n.isConnected?(Gn(),Zn("div",da,[ua,ns(" Live Chat Connected ")])):(Gn(),Zn("div",ha,[ga,ns(" Connecting... ")]))])]),os(" Chat Messages - Increased padding at bottom to make room for input "),es("div",{ref:"chatContainer",onScroll:n.handleScroll,class:"cs-messages flex-1 overflow-y-auto p-3 space-y-3 bg-gray-50 dark:bg-gray-900",style:{"padding-bottom":"120px"}},[os(" Messages grouped by date "),(Gn(!0),Zn(jn,null,Ei(n.groupedMessages,((e,t)=>(Gn(),Zn(jn,{key:t},[os(" Date Separator - Improved "),es("div",pa,[es("span",fa,ee(t),1)]),os(" Messages for this date "),(Gn(!0),Zn(jn,null,Ei(e,(e=>(Gn(),Zn("div",{key:e._id,class:"space-y-3"},[es("div",{class:K(["flex space-y-0.5",n.isLeftSideMessage(e.role)?"justify-start":"justify-end"])},[es("div",{class:K(["space-y-0.5 max-w-[80%]",n.isLeftSideMessage(e.role)?"items-start":"items-end"])},[os(" Sender Name "),es("div",{class:K(["text-xs font-medium text-gray-500 dark:text-gray-400",n.isLeftSideMessage(e.role)?"text-left":"text-right"])},ee(n.getSenderName(e)),3),os(" Message Content with improved styling "),es("div",{class:K([n.getMessageStyle(e),n.isLeftSideMessage(e.role)?"rounded-tr-lg rounded-br-lg rounded-bl-lg":"rounded-tl-lg rounded-bl-lg rounded-br-lg","cs"===e.role?"hover:bg-blue-600 transition-colors":""])},[es("p",ma,ee(e.content),1)],2),os(" Timestamp - FIXED dengan UTC to Local conversion "),es("div",{class:K(["text-xs text-gray-500 dark:text-gray-400",n.isLeftSideMessage(e.role)?"text-left":"text-right"])},ee(n.formatTime(e.created_at?e.created_at:"")),3)],2)],2)])))),128))],64)))),128)),os(" Empty state if no messages "),0===n.allMessages.length?(Gn(),Zn("div",ya,[...va])):os("v-if",!0),os(" Typing Indicator with animation "),n.isCustomerTyping?(Gn(),Zn("div",wa,[...ka])):os("v-if",!0)],544),os(" Scroll to bottom button "),n.showScrollButton?(Gn(),Zn("div",{key:0,onClick:n.scrollToBottom,class:"back-to-top visible bg-blue-500 hover:bg-blue-600 text-white rounded-full p-2 shadow-md transition-all"},[...ba])):os("v-if",!0),os(" Chat Input - Fixed positioning with improved visibility "),es("div",Ta,[os(" Reset any conflicting styles with explicit flex container "),es("div",xa,[os(" Attachment Button dengan ukuran tetap "),Ca,os(" Textarea dengan ukuran yang konsisten "),es("div",Sa,[si(es("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.newMessage=e),placeholder:"Type your message...",onInput:n.handleInput,onKeydown:n.sendMessageWithEnter,rows:"1",class:"cs-chat-input w-full px-3 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none",style:{height:"40px","min-height":"40px","max-height":"120px","line-height":"1.5","vertical-align":"top","box-sizing":"border-box"}},null,544),[[Ys,n.newMessage]])]),os(" Send Button dengan ukuran tetap "),es("button",{onClick:n.handleSendMessage,disabled:!(null==(r=n.newMessage)?void 0:r.trim()),class:"cs-send-button flex-shrink-0 flex items-center justify-center rounded-lg bg-blue-500 text-white hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",style:{height:"40px",width:"40px","min-height":"40px","min-width":"40px"},type:"button"},[ts(n.IconsComponent,{name:"send",class:"h-4 w-4 dark:text-white"})],8,_a)])])])}],["__scopeId","data-v-ad8e483a"],["__file","D:/nuxtjs/cappuccino-fe/widget/chat-box/components/tickets/TicketChat.vue"]]),Aa=ai({__name:"ChatEmbeddedWidget",props:{agentName:{type:String,required:!1,default:"CS Agent"},agentAvatar:{type:String,required:!1,default:void 0},initialTheme:{type:String,required:!1,default:"light"},showNotifications:{type:Boolean,required:!1,default:!0},chatLimit:{type:Number,required:!1,default:10},initialView:{type:String,required:!1,default:"tickets"},filterDefaults:{type:Object,required:!1,default:()=>({})},companyId:{type:String,required:!1,default:void 0},mode:{type:String,required:!1,default:"full"},chatOnly:{type:[Object,null],required:!1,default:null}},setup(e,{expose:t}){t();const i=e,n=St(!0),s=St(!1);yi((()=>{var e;try{s.value="undefined"!=typeof process&&"development"===(null==(e=process.env)?void 0:e.NODE_ENV)}catch{s.value="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||""!==window.location.port}}));const o=Cs((()=>"chat-only"===i.mode)),r=Cs((()=>"full"===i.mode)),{newMessage:a,messageContainer:l,currentView:c,tickets:d,filteredTickets:u,selectedTicket:h,ticketMeta:g,chatMessages:p,isCustomerTyping:f,isConnected:m,isInitialized:y,sendMessage:v,handleInput:w,selectTicket:k,switchView:b,handlePageChange:T,resolveTicket:x,closeTicket:C,reopenTicket:S,initialize:_,currentPage:E,pageSize:A,fetchTickets:I,handleSearch:O,setFilters:D}=function(e){const t=Fo(),i=Ro(),n=Uo(),s=$o(),o=Cs((()=>"chat-only"===e.mode)),r=Cs((()=>"chat-only"!==e.mode)),a=e.externalIsOpen||St(!1),l=St(""),c=St(null),d=St(!1),u=St(!1),h=St(!1),g=St(""),p=St(o.value?"chat":e.initialView||"tickets"),f=St(e.filterDefaults||{}),m=St(1),y=St(10),v=St(!1),w=St(null),k=St(null),b=St([]);e.initialTheme&&s.setTheme(e.initialTheme);let T=null;const x=Cs((()=>i.tickets)),C=Cs((()=>i.selectedTicket)),S=Cs((()=>i.meta)),_=Cs((()=>t.messages)),E=Cs((()=>t.isCustomerTyping)),A=Cs((()=>t.isConnected)),I=Cs((()=>i.isResolving)),O=Cs((()=>i.isClosing)),D=Cs((()=>i.isReopening)),P=Cs((()=>i.isAnyActionLoading)),M=Cs((()=>i.canResolveSelected)),W=Cs((()=>i.canCloseSelected)),U=Cs((()=>i.canReopenSelected)),L=Cs((()=>i.availableActions)),R=Cs((()=>{if(o.value||!g.value.trim())return x.value;const e=g.value.trim().toLowerCase();return x.value.filter((t=>{var i,n,s,o,r;return(null==(i=t.title)?void 0:i.toLowerCase().includes(e))||(null==(n=t.description)?void 0:n.toLowerCase().includes(e))||(null==(s=t.customer_name)?void 0:s.toLowerCase().includes(e))||(null==(o=t.customer_email)?void 0:o.toLowerCase().includes(e))||(null==(r=t.ticket_number)?void 0:r.toString().includes(e))}))})),F=e=>{const t=`notif-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,i={...e,id:t,timestamp:Date.now(),autoClose:!1!==e.autoClose};return b.value.push(i),i.autoClose&&setTimeout((()=>{j(t)}),5e3),t},j=e=>{const t=b.value.findIndex((t=>t.id===e));t>-1&&b.value.splice(t,1)},H=()=>{b.value=[]},$=async()=>{var s;if(o.value&&(null==(s=e.chatOnly)?void 0:s.ticketId)){v.value=!0,w.value=null;try{if(console.log("[useChatWidget] Loading ticket for chat-only mode:",e.chatOnly.ticketId),await i.getTicketById(e.chatOnly.ticketId),!C.value)throw new Error("Failed to load ticket");p.value="chat",console.log("[useChatWidget] Chat-only ticket loaded successfully:",C.value.title),C.value.chat_history&&C.value.chat_history.length>0&&(console.log("[useChatWidget] Setting initial chat messages:",C.value.chat_history.length),t.setInitialMessages(C.value.chat_history)),!1!==e.chatOnly.autoConnect&&n.user&&(console.log("[useChatWidget] Auto-connecting to chat..."),await t.initializeChat())}catch(r){throw console.error("[useChatWidget] Failed to load chat-only ticket:",r),w.value=r.message||"Failed to load conversation",r}finally{v.value=!1}}},B=async()=>{if(!d.value)try{h.value=!0,console.log("[useChatWidget] Initializing widget in mode:",e.mode),await Ho.loadSound(),n.fetchProfile(),n.loadProfile(),n.user||n.setProfile({_id:"",full_name:e.agentName,avatar:e.agentAvatar,email:"",status:"online",company_id:e.companyId||""}),e.companyId&&r.value&&i.setFilters({companyId:e.companyId,...f.value}),o.value?await $():await z(),n.user&&await t.initializeChat(),d.value=!0,console.log("[useChatWidget] Widget initialization completed successfully")}catch(s){throw console.error("[useChatWidget] Failed to initialize Chat Widget:",s),s}finally{h.value=!1}},z=async()=>{if(o.value)console.log("[useChatWidget] fetchTickets called in chat-only mode - skipping");else try{await i.fetchTickets(m.value,y.value)}catch(e){console.error("[useChatWidget] Failed to fetch tickets:",e)}},N=()=>{Gt((()=>{c.value&&(c.value.scrollTop=c.value.scrollHeight)}))},G=async()=>{o.value?await $():console.log("[useChatWidget] reloadChatOnlyTicket called in non-chat-only mode - ignoring")};return e.externalIsOpen&&_n(a,(e=>{e&&!d.value&&B()})),_n((()=>i.lastActionResult),(e=>{e&&F({type:e.success?"success":"error",title:e.success?"Action Completed":"Action Failed",message:e.message})})),yi((()=>{if((e.initialView||o.value)&&B(),"undefined"!=typeof window){const e=e=>{console.log("[useChatWidget] Ticket resolved event received:",e.detail)},t=e=>{console.log("[useChatWidget] Ticket closed event received:",e.detail)},i=e=>{console.log("[useChatWidget] Ticket reopened event received:",e.detail)};window.addEventListener("ticket-resolved",e),window.addEventListener("ticket-closed",t),window.addEventListener("ticket-reopened",i),bi((()=>{window.removeEventListener("ticket-resolved",e),window.removeEventListener("ticket-closed",t),window.removeEventListener("ticket-reopened",i)}))}})),_n((()=>_.value.length),(()=>N())),_n((()=>{var e;return null==(e=C.value)?void 0:e._id}),((e,i)=>{var n;e&&e!==i&&(null==(n=C.value)?void 0:n.chat_history)&&(t.setInitialMessages(C.value.chat_history),N())})),bi((()=>{T&&(clearTimeout(T),T=null),t.cleanup(),H()})),{isOpen:a,newMessage:l,messageContainer:c,isInitialized:d,isConnecting:h,showSettings:u,searchQuery:g,currentView:p,currentPage:m,pageSize:y,ticketFilters:f,isLoadingChatOnlyTicket:v,chatOnlyError:w,isChatOnlyMode:o,isFullMode:r,isResolving:I,isClosing:O,isReopening:D,isAnyActionLoading:P,pendingAction:k,notifications:b,tickets:x,filteredTickets:R,selectedTicket:C,ticketMeta:S,chatMessages:_,isCustomerTyping:E,isConnected:A,canResolve:M,canClose:W,canReopen:U,availableActions:L,initialize:B,sendMessage:async e=>{if(C.value&&C.value.chat_code)try{T&&(clearTimeout(T),T=null,t.sendTypingIndicator(!1,C.value.chat_code));const i=e||l.value.trim();l.value="",console.log("[useChatWidget] Sending message:",i),await t.sendMessage(i,C.value.chat_code),N()}catch(i){console.error("[useChatWidget] Error sending message:",i)}else console.error("[useChatWidget] Cannot send message: no selected ticket or chat code")},handleInput:()=>{var e;(null==(e=C.value)?void 0:e.chat_code)&&(T&&clearTimeout(T),t.sendTypingIndicator(!0,C.value.chat_code),T=window.setTimeout((()=>{var e;(null==(e=C.value)?void 0:e.chat_code)&&t.sendTypingIndicator(!1,C.value.chat_code),T=null}),3e3))},selectTicket:async e=>{var n;if(o.value)console.log("[useChatWidget] selectTicket called in chat-only mode - ignoring");else try{await i.getTicketById(e),p.value="chat",(null==(n=C.value)?void 0:n.chat_history)&&t.setInitialMessages(C.value.chat_history),N()}catch(s){console.error("[useChatWidget] Error selecting ticket:",s)}},resolveTicket:async(e,t={})=>{var n,s,o;const r=e||(null==(n=C.value)?void 0:n._id);if(r)try{t.optimistic&&i.updateTicketStatusLocally(r,"resolved");const e=await i.resolveTicket(r);return F({type:"success",title:"Ticket Resolved",message:`Ticket "${e.title}" has been marked as resolved`}),null==(s=t.onSuccess)||s.call(t,e),e}catch(a){throw console.error("[useChatWidget] Error resolving ticket:",a),t.optimistic&&C.value&&i.updateTicketStatusLocally(r,C.value.status),F({type:"error",title:"Failed to Resolve Ticket",message:a.message||"An error occurred while resolving the ticket"}),null==(o=t.onError)||o.call(t,a),a}else console.error("[useChatWidget] Cannot resolve ticket: no ticket ID provided")},closeTicket:async(e,t={})=>{var n,s,o;const r=e||(null==(n=C.value)?void 0:n._id);if(r)try{t.optimistic&&i.updateTicketStatusLocally(r,"closed");const e=await i.closeTicket(r);return F({type:"success",title:"Ticket Closed",message:`Ticket "${e.title}" has been closed`}),null==(s=t.onSuccess)||s.call(t,e),e}catch(a){throw console.error("[useChatWidget] Error closing ticket:",a),t.optimistic&&C.value&&i.updateTicketStatusLocally(r,C.value.status),F({type:"error",title:"Failed to Close Ticket",message:a.message||"An error occurred while closing the ticket"}),null==(o=t.onError)||o.call(t,a),a}else console.error("[useChatWidget] Cannot close ticket: no ticket ID provided")},reopenTicket:async(e,t={})=>{var n,s,o;const r=e||(null==(n=C.value)?void 0:n._id);if(r)try{t.optimistic&&i.updateTicketStatusLocally(r,"reopened");const e=await i.reopenTicket(r);return F({type:"success",title:"Ticket Reopened",message:`Ticket "${e.title}" has been reopened`}),null==(s=t.onSuccess)||s.call(t,e),e}catch(a){throw console.error("[useChatWidget] Error reopening ticket:",a),t.optimistic&&C.value&&i.updateTicketStatusLocally(r,C.value.status),F({type:"error",title:"Failed to Reopen Ticket",message:a.message||"An error occurred while reopening the ticket"}),null==(o=t.onError)||o.call(t,a),a}else console.error("[useChatWidget] Cannot reopen ticket: no ticket ID provided")},bulkResolveTickets:async e=>{try{const t=await i.bulkResolveTickets(e),n=t.filter((e=>e.success)).length,s=t.filter((e=>!e.success)).length;return F({type:n===e.length?"success":"warning",title:"Bulk Resolve Completed",message:`${n} tickets resolved successfully${s>0?`, ${s} failed`:""}`}),t}catch(t){throw F({type:"error",title:"Bulk Resolve Failed",message:t.message||"Failed to perform bulk resolve operation"}),t}},bulkCloseTickets:async e=>{try{const t=await i.bulkCloseTickets(e),n=t.filter((e=>e.success)).length,s=t.filter((e=>!e.success)).length;return F({type:n===e.length?"success":"warning",title:"Bulk Close Completed",message:`${n} tickets closed successfully${s>0?`, ${s} failed`:""}`}),t}catch(t){throw F({type:"error",title:"Bulk Close Failed",message:t.message||"Failed to perform bulk close operation"}),t}},canPerformAction:(e,t)=>i.canPerformAction(e,t),getActionButtons:e=>i.getActionButtons(e),toggleWidget:()=>{a.value=!a.value,a.value&&!d.value&&B()},toggleSettings:()=>{u.value=!u.value},scrollToBottom:N,switchView:e=>{o.value&&"tickets"===e?console.log("[useChatWidget] switchView to tickets called in chat-only mode - ignoring"):(p.value=e,"tickets"===e&&r.value&&z())},handlePageChange:e=>{o.value?console.log("[useChatWidget] handlePageChange called in chat-only mode - ignoring"):(m.value=e,z())},setFilters:e=>{o.value?console.log("[useChatWidget] setFilters called in chat-only mode - ignoring"):(f.value={...f.value,...e},i.setFilters(f.value),m.value=1,z())},handleSearch:e=>{o.value?console.log("[useChatWidget] handleSearch called in chat-only mode - ignoring"):(g.value=e,"tickets"===p.value&&(i.setFilters({search:e}),m.value=1,z()))},fetchTickets:z,loadChatOnlyTicket:$,reloadChatOnlyTicket:G,updateChatOnlyConfig:t=>{o.value&&e.chatOnly?(Object.assign(e.chatOnly,t),t.ticketId&&t.ticketId!==e.chatOnly.ticketId&&(console.log("[useChatWidget] Ticket ID changed, reloading..."),G())):console.log("[useChatWidget] updateChatOnlyConfig called in non-chat-only mode - ignoring")},addNotification:F,removeNotification:j,clearAllNotifications:H}}({agentName:i.agentName,agentAvatar:i.agentAvatar,initialView:o.value?"chat":i.initialView,position:"bottom-right",initialTheme:i.initialTheme,companyId:i.companyId,filterDefaults:i.filterDefaults,externalIsOpen:n,mode:i.mode,chatOnly:i.chatOnly?{ticketId:i.chatOnly.ticketId,hideTicketInfo:i.chatOnly.hideTicketInfo,hideActions:i.chatOnly.hideActions,customTitle:i.chatOnly.customTitle,autoConnect:i.chatOnly.autoConnect}:null}),P=$o(),{isDark:M}=So(P),W=Ro(),U=Fo(),L=Uo(),R=St(""),F=St(o.value),j=St(!1),H=St(!1),$=St(!1),B=St(!1),z=St(null),N=async()=>{var e;if(o.value&&(null==(e=i.chatOnly)?void 0:e.ticketId)){$.value=!0;try{if(console.log("Loading ticket for chat-only mode:",i.chatOnly.ticketId),await W.getTicketById(i.chatOnly.ticketId),h.value){if(F.value=!0,h.value.chat_history){const e=h.value.chat_history.map((e=>{var t,i,n;let s;return s="admin"===e.role?"admin":"customer"===e.role?"customer":e.user_id===(null==(t=null==h?void 0:h.value)?void 0:t.cs_id)?"cs":"assistant",{...e,role:s,sender_name:e.user_id===(null==(i=h.value)?void 0:i.cs_id)?(null==(n=h.value.cs_user)?void 0:n.full_name)||"CS Agent":"assistant"===s?"AI Assistant":"Customer"}}));U.setInitialMessages(e)}!1!==i.chatOnly.autoConnect&&L.user&&await U.initializeChat(),console.log("Chat-only ticket loaded successfully:",h.value.title)}}catch(t){console.error("Failed to load ticket for chat-only mode:",t)}finally{$.value=!1}}},G=(e,t)=>{e.classList.remove("dark","light"),e.classList.add(t),e.setAttribute("data-theme",t);try{e.style.colorScheme=t}catch{}};_n(M,(e=>{console.log("Theme changed to:",e?"dark":"light");[document.querySelector(".cappuccino-chat-embedded-widget"),document.getElementById(i.companyId?`widget-${i.companyId}`:"default-widget"),document.querySelector('[class*="cappuccino-chat"]')].filter(Boolean).forEach((t=>{t&&(G(t,e?"dark":"light"),console.log("Theme applied to container:",{element:t.className,isDark:e,dataTheme:t.getAttribute("data-theme")}))})),setTimeout((()=>{document.querySelectorAll(".cappuccino-chat-embedded-widget *").forEach((e=>{e instanceof HTMLElement&&(e.style.transition="all 0.2s ease")}))}),50)}),{immediate:!0,flush:"post"});yi((async()=>{var e;try{console.log("Mounting widget with mode:",i.mode),console.log("Chat-only config:",i.chatOnly),P.initializeFromStorage(),P.setTheme(i.initialTheme),await Gt();const t=document.querySelector(".cappuccino-chat-embedded-widget");if(t){const e=P.isDark?"dark":"light";G(t,e),console.log("Initial theme applied:",{isDark:P.isDark,classes:t.className,dataTheme:t.getAttribute("data-theme")})}await _(),o.value&&await N(),console.log("Embedded widget initialized"),r.value?console.log("Tickets loaded:",d.value.length):console.log("Chat-only mode, ticket loaded:",null==(e=h.value)?void 0:e.title)}catch(t){console.error("Error during widget initialization:",t)}}));const V=()=>{console.log("=== THEME DEBUG ==="),console.log("Store theme:",P.currentTheme),console.log("Store isDark:",P.isDark),console.log("Store isInitialized:",P.isInitialized);const e=document.querySelector(".cappuccino-chat-embedded-widget");if(e){console.log("Container classes:",e.className),console.log("Container data-theme:",e.getAttribute("data-theme"));const t=window.getComputedStyle(e);console.log("Computed background:",t.backgroundColor),console.log("Computed color:",t.color);const i=e.classList.contains("light"),n=e.classList.contains("dark");console.log("Has light class:",i),console.log("Has dark class:",n)}"undefined"!=typeof window&&console.log("LocalStorage theme:",localStorage.getItem("cappuccino-widget-theme")),console.log("==================")},q=e=>{const t=e||P.currentTheme,i=document.querySelector(".cappuccino-chat-embedded-widget");i&&(G(i,t),console.log("Force applied theme:",t))};"undefined"!=typeof window&&(window.debugWidgetTheme=V,window.forceWidgetTheme=q);const K=e=>{if(!h.value)return;const t={resolve:{title:"Resolve Ticket",message:`Are you sure you want to mark this ticket as resolved?\n\nTicket: ${h.value.title}`,action:J},close:{title:"Close Ticket",message:`Are you sure you want to close this ticket?\n\nTicket: ${h.value.title}\n\nThis action will mark the ticket as completed.`,action:X},reopen:{title:"Reopen Ticket",message:`Are you sure you want to reopen this ticket?\n\nTicket: ${h.value.title}\n\nThis will allow further communication and updates.`,action:Y}};z.value={type:e,...t[e]},B.value=!0},Z=()=>{B.value=!1,z.value=null},J=async()=>{var e;if(null==(e=h.value)?void 0:e._id){j.value=!0;try{await W.resolveTicket(h.value._id),console.log("Ticket resolved successfully"),await W.getTicketById(h.value._id)}catch(t){throw console.error("Failed to resolve ticket:",t),t}finally{j.value=!1}}},X=async()=>{var e;if(null==(e=h.value)?void 0:e._id){j.value=!0;try{await W.closeTicket(h.value._id),console.log("Ticket closed successfully"),await W.getTicketById(h.value._id)}catch(t){throw console.error("Failed to close ticket:",t),t}finally{j.value=!1}}},Y=async()=>{var e;if(null==(e=h.value)?void 0:e._id){j.value=!0;try{await W.reopenTicket(h.value._id),console.log("Ticket reopened successfully"),await W.getTicketById(h.value._id)}catch(t){throw console.error("Failed to reopen ticket:",t),t}finally{j.value=!1}}},Q=e=>{e&&e.stopPropagation(),K("resolve")},ee=e=>{e&&e.stopPropagation(),K("close")},te=e=>{e&&e.stopPropagation(),K("reopen")},ie=Cs((()=>{var e;return(null==(e=h.value)?void 0:e.status)===Bo.ACTIVE})),ne=Cs((()=>{var e;return(null==(e=h.value)?void 0:e.status)===Bo.RESOLVED})),se=Cs((()=>{var e;return(null==(e=h.value)?void 0:e.status)===Bo.CLOSED})),oe=Cs((()=>{if(!h.value)return[];const e=[];return ie.value&&e.push({type:"resolve",label:"Resolve",icon:"check",onClick:Q,class:"bg-green-500 hover:bg-green-600 text-white",description:"Mark as resolved"}),ne.value&&e.push({type:"close",label:"Close",icon:"x",onClick:ee,class:"bg-gray-500 hover:bg-gray-600 text-white",description:"Close ticket"}),se.value&&e.push({type:"reopen",label:"Reopen",icon:"refresh",onClick:te,class:"bg-amber-500 hover:bg-amber-600 text-white",description:"Reopen ticket"}),e})),re=[{value:"all",label:"All Status"},{value:Bo.OPEN,label:"Open"},{value:Bo.ASSIGNED,label:"Assigned"},{value:Bo.ACTIVE,label:"Active"},{value:Bo.RESOLVED,label:"Resolved"},{value:Bo.CLOSED,label:"Closed"},{value:Bo.REOPENED,label:"Reopened"}],ae=[{value:"all",label:"All Types"},{value:No.COMPLAINT,label:"Complaint"},{value:No.INFORMATION,label:"Information"},{value:No.SUPPORT,label:"Support"},{value:No.FEEDBACK,label:"Feedback"}],le=[{value:"all",label:"All Priority"},{value:zo.LOW,label:"Low"},{value:zo.MEDIUM,label:"Medium"},{value:zo.HIGH,label:"High"},{value:zo.URGENT,label:"Urgent"}],ce=Cs((()=>{var e,t,n;return o.value?(null==(e=i.chatOnly)?void 0:e.customTitle)||(null==(t=h.value)?void 0:t.title)||"Chat":(null==(n=h.value)?void 0:n.title)||"Chat"})),de={props:i,isOpen:n,isDevelopment:s,isChatOnlyMode:o,isFullMode:r,newMessage:a,messageContainer:l,currentView:c,tickets:d,filteredTickets:u,selectedTicket:h,ticketMeta:g,chatMessages:p,isCustomerTyping:f,isConnected:m,isInitialized:y,sendMessage:v,handleInput:w,selectTicket:k,switchView:b,handlePageChange:T,resolveTicket:x,closeTicket:C,reopenTicket:S,initialize:_,currentPage:E,pageSize:A,fetchTickets:I,handleSearch:O,setFilters:D,themeStore:P,isDark:M,ticketsStore:W,ticketChatStore:U,profileStore:L,searchQuery:R,displayingTicketDetail:F,isUpdating:j,showTicketDrawer:H,isLoadingTicket:$,showConfirmDialog:B,confirmAction:z,loadChatOnlyTicket:N,applyThemeToContainer:G,toggleDarkMode:()=>{console.log("Toggling theme from:",P.currentTheme),P.toggleTheme(),console.log("Theme toggled to:",P.currentTheme),Gt((()=>{const e=document.querySelector(".cappuccino-chat-embedded-widget");if(e){const t=P.isDark;G(e,t?"dark":"light"),console.log("Container classes after toggle:",e.className)}}))},formatDate:e=>{if(!e)return"";try{const n="undefined"!=typeof window&&window.WIDGET_DEBUG;n&&console.log("[DateFormat] Raw input:",e);let s=e.trim();/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?$/.test(s)&&(s+="Z",n&&console.log("[DateFormat] Added Z for UTC:",s));const o=new Date(s);if(isNaN(o.getTime()))return console.error("[DateFormat] Invalid date:",e),e;let r;n&&console.log("[DateFormat] Parsed UTC date:",o.toISOString());try{r=Intl.DateTimeFormat().resolvedOptions().timeZone,n&&console.log("[DateFormat] Detected timezone:",r)}catch(t){r=""}try{let t;if(t=r?o.toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:r}):o.toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),n){const i=o.toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"UTC"}),n=o.toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Jakarta"});console.log("[DateFormat] UTC:",i,"Jakarta:",n,"User:",t),console.log("[DateFormat] Conversion successful:",e,"->",t)}return t}catch(i){console.warn("[DateFormat] Formatting failed:",i);const e=o.getDate(),t=o.toLocaleDateString("id-ID",{month:"short"}),n=o.getFullYear(),s=o.getHours().toString().padStart(2,"0");return`${e} ${t} ${n}, ${s}:${o.getMinutes().toString().padStart(2,"0")}`}}catch(t){return console.error("[DateFormat] Error formatting date:",t),e}},onSearchInput:e=>{if(o.value)return;const t=e.target.value;R.value=t,O(t)},debugTheme:V,forceApplyTheme:q,goToTicketDetail:async(e,t)=>{var i,n;if(!o.value)try{if(t&&t.stopPropagation(),console.log("Going to ticket detail:",e),F.value=!0,await W.getTicketById(e),null==(i=h.value)?void 0:i.chat_history){const e=h.value.chat_history.map((e=>{var t,i,n,s;let o;return o="admin"===e.role?"admin":"customer"===e.role?"customer":e.user_id===(null==(t=null==h?void 0:h.value)?void 0:t.cs_id)?"cs":"cs"===e.role&&e.user_id!=(null==(i=null==h?void 0:h.value)?void 0:i.cs_id)?"admin":"assistant",{...e,role:o,sender_name:e.user_id===(null==(n=h.value)?void 0:n.cs_id)?(null==(s=h.value.cs_user)?void 0:s.full_name)||"CS Agent":"assistant"===o?"AI Assistant":"Customer"}}));U.setInitialMessages(e)}L.user&&await U.initializeChat(),console.log("Ticket detail loaded:",null==(n=h.value)?void 0:n.title)}catch(s){console.error("Error fetching ticket details:",s),F.value=!1}},toggleTicketDrawer:e=>{e&&e.stopPropagation(),H.value=!H.value},goBackToTickets:e=>{o.value||(e&&e.stopPropagation(),F.value=!1,H.value=!1)},getStatusStyle:e=>{switch(e){case Bo.OPEN:return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-500";case Bo.ASSIGNED:case Bo.ACTIVE:return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-500";case Bo.RESOLVED:return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-500";case Bo.REOPENED:return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-500";case Bo.CLOSED:default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-500"}},getPriorityStyle:e=>{switch(e){case zo.URGENT:return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-500";case zo.HIGH:return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-500";case zo.MEDIUM:return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-500";case zo.LOW:default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-500"}},showConfirmationDialog:K,closeConfirmationDialog:Z,executeConfirmedAction:async()=>{if(z.value)try{await z.value.action(),Z()}catch(e){console.error("Error executing action:",e)}},handleSendMessage:async e=>{if(h.value&&h.value.chat_code)try{await U.sendMessage(e,h.value.chat_code)}catch(t){console.error("Failed to send message:",t)}},handleResolveConfirmed:J,handleCloseConfirmed:X,handleReopenConfirmed:Y,handleResolve:Q,handleClose:ee,handleReopen:te,canResolve:ie,canClose:ne,canReopen:se,getActionButtons:oe,statusOptions:re,typeOptions:ae,priorityOptions:le,handleStatusChange:e=>{if(o.value)return;const t=e.target.value;D({status:t})},handleTypeChange:e=>{if(o.value)return;const t=e.target.value;D({type:t})},handlePriorityChange:e=>{if(o.value)return;const t=e.target.value;D({priority:t})},handleSearchChange:async e=>{if(o.value)return;const t=e.target.value;D({search:t})},chatHeaderTitle:ce,TicketChat:Ea};return Object.defineProperty(de,"__isScriptSetup",{enumerable:!1,value:!0}),de}}),Ia=e=>(ii("data-v-ef3fe763"),e=e(),ni(),e),Oa={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Da={class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 p-6"},Pa={class:"flex items-center justify-between mb-4"},Ma={class:"text-lg font-bold text-gray-900 dark:text-white"},Wa=[Ia((()=>es("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)))],Ua={class:"mb-6"},La={class:"text-gray-700 dark:text-gray-300 whitespace-pre-line"},Ra={class:"flex justify-end space-x-3"},Fa=["disabled"],ja={key:0,class:"flex items-center"},Ha=Ia((()=>es("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[es("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),es("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1))),$a={key:1},Ba={key:1,class:"chat-only-container h-full"},za={key:0,class:"h-full flex flex-col items-center justify-center p-6 bg-gray-50 dark:bg-gray-900"},Na=[Ia((()=>es("div",{class:"relative w-10 h-10 mb-4"},[es("div",{class:"absolute top-0 left-0 w-full h-full border-3 border-blue-200 dark:border-blue-900 rounded-full animate-pulse"}),es("div",{class:"absolute top-0 left-0 w-full h-full border-3 border-transparent border-t-blue-500 rounded-full animate-spin"})],-1))),Ia((()=>es("p",{class:"text-gray-600 dark:text-gray-400"},"Loading conversation...",-1)))],Ga={class:"h-full flex flex-col"},Va={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700"},qa={class:"p-3 flex justify-between items-center"},Ka={class:"flex-1"},Za={class:"flex items-center"},Ja={class:"font-bold text-gray-900 dark:text-white text-lg"},Xa={class:"flex items-center space-x-2 mt-1"},Ya={key:1,class:"flex items-center text-xs text-emerald-500"},Qa=Ia((()=>es("span",{class:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-1 animate-pulse"},null,-1))),el={class:"flex items-center space-x-2"},tl=["title"],il={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},nl=[Ia((()=>es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)))],sl={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ol=[Ia((()=>es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)))],rl={key:0,class:"px-3 pb-3 flex justify-between items-center"},al={class:"flex items-center space-x-2"},ll=["onClick","disabled","title"],cl={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},dl=[Ia((()=>es("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1))),Ia((()=>es("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)))],ul=Ia((()=>es("svg",{class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1))),hl={key:2,class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},gl=[Ia((()=>es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)))],pl={key:3,class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},fl=[Ia((()=>es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)))],ml={class:"text-sm text-gray-500 dark:text-gray-400"},yl={key:0,class:"p-3 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-700 shadow-inner"},vl={class:"space-y-3"},wl=Ia((()=>es("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Description",-1))),kl={class:"text-sm text-gray-800 dark:text-gray-200 mt-1 whitespace-pre-line"},bl={class:"grid grid-cols-2 gap-3"},Tl=Ia((()=>es("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Customer",-1))),xl={class:"text-sm text-gray-800 dark:text-gray-200 flex items-center"},Cl=Ia((()=>es("svg",{class:"h-4 w-4 mr-1 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1))),Sl=Ia((()=>es("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Created",-1))),_l={class:"text-sm text-gray-800 dark:text-gray-200"},El={key:0},Al=Ia((()=>es("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Assigned To",-1))),Il={class:"text-sm text-gray-800 dark:text-gray-200"},Ol={class:"chat-embedded-container h-full flex overflow-hidden"},Dl={class:"bg-white dark:bg-gray-800 p-3 border-b border-gray-200 dark:border-gray-700"},Pl={class:"flex justify-between items-center mb-2"},Ml=Ia((()=>es("h2",{class:"text-lg font-bold text-gray-900 dark:text-white"},"Tickets",-1))),Wl={class:"flex space-x-2"},Ul=["title"],Ll={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Rl=[Ia((()=>es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)))],Fl={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},jl=[Ia((()=>es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)))],Hl=[Ia((()=>es("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)))],$l=[Ia((()=>es("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)))],Bl={class:"space-y-2"},zl={class:"relative"},Nl=Ia((()=>es("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[es("svg",{class:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))),Gl={class:"grid grid-cols-2 gap-2"},Vl=["value"],ql=["value"],Kl={class:"flex-1 overflow-y-auto bg-gray-50 dark:bg-gray-900"},Zl={key:0,class:"flex justify-center items-center h-32"},Jl=[Ia((()=>es("div",{class:"relative w-10 h-10"},[es("div",{class:"absolute top-0 left-0 w-full h-full border-3 border-blue-200 dark:border-blue-900 rounded-full animate-pulse"}),es("div",{class:"absolute top-0 left-0 w-full h-full border-3 border-transparent border-t-blue-500 rounded-full animate-spin"})],-1)))],Xl={class:"p-4 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 m-3 rounded-lg border border-red-200 dark:border-red-800"},Yl={class:"flex items-start"},Ql=Ia((()=>es("svg",{class:"h-5 w-5 mr-2 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1))),ec={class:"p-3 space-y-3"},tc=["onClick"],ic={class:"flex flex-col"},nc={class:"flex justify-between items-start mb-2"},sc={class:"flex-1"},oc={class:"font-medium text-gray-900 dark:text-white text-sm line-clamp-1"},rc={class:"flex flex-wrap gap-1.5 mb-2"},ac={key:0,class:"px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"},lc={class:"text-xs text-gray-600 dark:text-gray-400 line-clamp-2 mb-2"},cc={class:"flex justify-between items-center pt-2 border-t border-gray-100 dark:border-gray-700 text-xs"},dc={class:"text-gray-600 dark:text-gray-400 flex items-center"},uc=Ia((()=>es("svg",{class:"h-3.5 w-3.5 mr-1 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1))),hc={class:"text-gray-500 dark:text-gray-400 flex items-center"},gc=Ia((()=>es("svg",{class:"h-3.5 w-3.5 mr-1 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1))),pc=ss('<div class="flex flex-col items-center justify-center h-64 text-gray-500 dark:text-gray-400 p-4" data-v-ef3fe763><div class="w-16 h-16 mb-3 flex items-center justify-center text-blue-400 dark:text-blue-500 opacity-80" data-v-ef3fe763><svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-ef3fe763><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z" data-v-ef3fe763></path></svg></div><p class="font-medium text-base mb-1" data-v-ef3fe763>No tickets found</p><p class="text-sm text-gray-400 dark:text-gray-500 text-center" data-v-ef3fe763>Any new support requests will appear here</p></div>',1),fc={key:0,class:"p-3 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 flex justify-center"},mc={class:"inline-flex shadow-sm"},yc=["disabled"],vc=[Ia((()=>es("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)))],wc=["onClick"],kc=["disabled"],bc=[Ia((()=>es("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)))],Tc={key:0,class:"h-full flex flex-col items-center justify-center p-6 bg-gray-50 dark:bg-gray-900 text-gray-500 dark:text-gray-400"},xc=ss('<div class="w-20 h-20 mb-4 flex items-center justify-center text-blue-400 dark:text-blue-500 opacity-80" data-v-ef3fe763><svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-ef3fe763><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" data-v-ef3fe763></path></svg></div><h3 class="text-xl font-bold mb-2" data-v-ef3fe763>No conversation selected</h3><p class="text-center text-gray-400 dark:text-gray-500 mb-4" data-v-ef3fe763> Select a ticket from the list to view the conversation </p>',3),Cc=Ia((()=>es("svg",{class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1))),Sc={class:"h-full flex flex-col"},_c={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700"},Ec={class:"p-3 flex justify-between items-center"},Ac=[Ia((()=>es("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)))],Ic={class:"flex-1"},Oc={class:"flex items-center"},Dc={class:"font-bold text-gray-900 dark:text-white text-lg"},Pc={class:"flex items-center space-x-2 mt-1"},Mc={key:0,class:"flex items-center text-xs text-emerald-500"},Wc=Ia((()=>es("span",{class:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-1 animate-pulse"},null,-1))),Uc={key:0,class:"px-3 pb-3 flex justify-between items-center"},Lc={class:"flex items-center space-x-2"},Rc=["onClick","disabled","title"],Fc={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},jc=[Ia((()=>es("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1))),Ia((()=>es("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)))],Hc=Ia((()=>es("svg",{class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1))),$c={key:2,class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Bc=[Ia((()=>es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)))],zc={key:3,class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Nc=[Ia((()=>es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)))],Gc={class:"text-sm text-gray-500 dark:text-gray-400"},Vc={key:0,class:"p-3 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-700 shadow-inner"},qc={class:"space-y-3"},Kc=Ia((()=>es("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Description",-1))),Zc={class:"text-sm text-gray-800 dark:text-gray-200 mt-1 whitespace-pre-line"},Jc={class:"grid grid-cols-2 gap-3"},Xc=Ia((()=>es("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Customer",-1))),Yc={class:"text-sm text-gray-800 dark:text-gray-200 flex items-center"},Qc=Ia((()=>es("svg",{class:"h-4 w-4 mr-1 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[es("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1))),ed=Ia((()=>es("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Created",-1))),td={class:"text-sm text-gray-800 dark:text-gray-200"},id={key:0},nd=Ia((()=>es("h3",{class:"text-sm font-semibold text-gray-600 dark:text-gray-300"},"Assigned To",-1))),sd={class:"text-sm text-gray-800 dark:text-gray-200"};const od=Gr(Aa,[["render",function(e,t,i,n,s,o){var r,a,l,c,d,u,h,g,p,f;return Gn(),Zn(jn,null,[os(" Add mode-specific classes to main container "),es("div",{class:K(["chat-embedded-widget h-full",{"chat-only-mode":n.isChatOnlyMode,"full-mode":n.isFullMode}])},[os(" Confirmation Dialog "),n.showConfirmDialog?(Gn(),Zn("div",Oa,[os(" Backdrop "),es("div",{class:"absolute inset-0 bg-black/50",onClick:n.closeConfirmationDialog}),os(" Dialog "),es("div",Da,[os(" Header "),es("div",Pa,[es("h3",Ma,ee(null==(r=n.confirmAction)?void 0:r.title),1),es("button",{onClick:n.closeConfirmationDialog,class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...Wa])]),os(" Content "),es("div",Ua,[es("p",La,ee(null==(a=n.confirmAction)?void 0:a.message),1)]),os(" Actions "),es("div",Ra,[es("button",{onClick:n.closeConfirmationDialog,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-md transition-colors"}," Cancel "),es("button",{onClick:n.executeConfirmedAction,disabled:n.isUpdating,class:K(["px-4 py-2 text-sm font-medium text-white rounded-md transition-colors disabled:opacity-50",{"bg-green-500 hover:bg-green-600":"resolve"===(null==(l=n.confirmAction)?void 0:l.type),"bg-gray-500 hover:bg-gray-600":"close"===(null==(c=n.confirmAction)?void 0:c.type),"bg-amber-500 hover:bg-amber-600":"reopen"===(null==(d=n.confirmAction)?void 0:d.type)}])},[n.isUpdating?(Gn(),Zn("span",ja,[Ha,ns(" Processing... ")])):(Gn(),Zn("span",$a,ee(null==(u=n.confirmAction)?void 0:u.title),1))],10,Fa)])])])):os("v-if",!0),os(" CHAT-ONLY MODE: Single Chat Panel "),n.isChatOnlyMode?(Gn(),Zn("div",Ba,[os(" Loading State for Chat-Only Mode "),n.isLoadingTicket||!n.selectedTicket?(Gn(),Zn("div",za,[...Na])):n.selectedTicket?(Gn(),Zn(jn,{key:1},[os(" Chat Interface for Chat-Only Mode "),es("div",Ga,[os(" Enhanced Chat Header for Chat-Only Mode "),es("div",Va,[os(" Main Header "),es("div",qa,[es("div",Ka,[es("div",Za,[es("h2",Ja,ee(n.chatHeaderTitle),1),n.selectedTicket.ticket_number&&!(null==(h=n.props.chatOnly)?void 0:h.hideTicketInfo)?(Gn(),Zn("span",{key:0,onClick:n.toggleTicketDrawer,class:"ml-2 px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"}," #"+ee(n.selectedTicket.ticket_number),1)):os("v-if",!0)]),es("div",Xa,[(null==(g=n.props.chatOnly)?void 0:g.hideTicketInfo)?os("v-if",!0):(Gn(),Zn("span",{key:0,class:K(["px-2 py-0.5 rounded-full text-xs font-medium",n.getStatusStyle(n.selectedTicket.status)])},ee(n.selectedTicket.status.charAt(0).toUpperCase()+n.selectedTicket.status.slice(1)),3)),n.isConnected?(Gn(),Zn("span",Ya,[Qa,ns(" Live Chat ")])):os("v-if",!0)])]),os(" Right Side Actions "),es("div",el,[os(" Theme Toggle "),es("button",{onClick:n.toggleDarkMode,class:"p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:n.isDark?"Switch to Light Mode":"Switch to Dark Mode"},[n.isDark?(Gn(),Zn("svg",il,[...nl])):(Gn(),Zn("svg",sl,[...ol]))],8,tl)])]),os(" Action Buttons Row (if not hidden and actions are available) "),!(null==(p=n.props.chatOnly)?void 0:p.hideActions)&&n.getActionButtons.length>0?(Gn(),Zn("div",rl,[es("div",al,[(Gn(!0),Zn(jn,null,Ei(n.getActionButtons,(e=>(Gn(),Zn("button",{key:e.type,onClick:e.onClick,disabled:n.isUpdating,class:K([e.class,"px-3 py-1.5 text-sm font-medium rounded-md shadow-sm flex items-center disabled:opacity-50 disabled:cursor-not-allowed transition-all hover:shadow-md"]),title:e.description},[os(" Loading spinner when updating "),n.isUpdating?(Gn(),Zn("svg",cl,[...dl])):"check"===e.icon?(Gn(),Zn(jn,{key:1},[os(" Action Icons "),ul],2112)):"x"===e.icon?(Gn(),Zn("svg",hl,[...gl])):"refresh"===e.icon?(Gn(),Zn("svg",pl,[...fl])):os("v-if",!0),ns(" "+ee(e.label),1)],10,ll)))),128))]),os(" Status Info "),es("div",ml," Last updated: "+ee(n.formatDate(n.selectedTicket.updated_at||n.selectedTicket.created_at||"").split(",")[0]),1)])):os("v-if",!0)]),os(" Ticket Details Drawer (if not hidden) "),n.showTicketDrawer&&n.selectedTicket&&!(null==(f=n.props.chatOnly)?void 0:f.hideTicketInfo)?(Gn(),Zn("div",yl,[es("div",vl,[es("div",null,[wl,es("p",kl,ee(n.selectedTicket.description),1)]),es("div",bl,[es("div",null,[Tl,es("p",xl,[Cl,ns(" "+ee(n.selectedTicket.customer_name),1)])]),es("div",null,[Sl,es("p",_l,ee(n.formatDate(n.selectedTicket.created_at)),1)])]),n.selectedTicket.cs_user?(Gn(),Zn("div",El,[Al,es("p",Il,ee(n.selectedTicket.cs_user.full_name),1)])):os("v-if",!0)])])):os("v-if",!0),os(" Chat Component "),n.selectedTicket?(Gn(),Jn(n.TicketChat,{key:1,ticket:n.selectedTicket,onSendMessage:n.handleSendMessage,class:"flex-1 flex flex-col"},null,8,["ticket"])):os("v-if",!0)])],2112)):os("v-if",!0)])):(Gn(),Zn(jn,{key:2},[os(" FULL MODE: Original Layout with Tickets + Chat "),es("div",Ol,[os(" Left Side: Tickets List Panel "),es("div",{class:K(["chat-tickets-panel w-1/3 border-r border-gray-200 dark:border-gray-700 flex flex-col",{"hidden md:flex":n.displayingTicketDetail}])},[os(" Tickets Header "),es("div",Dl,[es("div",Pl,[Ml,es("div",Wl,[os(" Theme Toggle "),es("button",{onClick:n.toggleDarkMode,class:"p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:n.isDark?"Switch to Light Mode":"Switch to Dark Mode"},[n.isDark?(Gn(),Zn("svg",Ll,[...Rl])):(Gn(),Zn("svg",Fl,[...jl]))],8,Ul),es("button",{onClick:t[0]||(t[0]=(...e)=>n.fetchTickets&&n.fetchTickets(...e)),class:"p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Refresh Tickets"},[...Hl]),n.isDevelopment?(Gn(),Zn("button",{key:0,onClick:n.debugTheme,class:"p-1.5 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Debug Theme"},[...$l])):os("v-if",!0)])]),os(" Search and Filters "),es("div",Bl,[es("div",zl,[Nl,es("input",{type:"text",placeholder:"Search tickets...",onInput:n.handleSearchChange,class:"w-full pl-10 pr-4 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500"},null,32)]),es("div",Gl,[si(es("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.ticketsStore.filters.status=e),onChange:n.handleStatusChange,class:"w-full pl-3 pr-8 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500"},[(Gn(),Zn(jn,null,Ei(n.statusOptions,(e=>es("option",{key:e.value,value:e.value},ee(e.label),9,Vl))),64))],544),[[Qs,n.ticketsStore.filters.status]]),si(es("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.ticketsStore.filters.priority=e),onChange:n.handlePriorityChange,class:"w-full pl-3 pr-8 py-2 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500"},[(Gn(),Zn(jn,null,Ei(n.priorityOptions,(e=>es("option",{key:e.value,value:e.value},ee(e.label),9,ql))),64))],544),[[Qs,n.ticketsStore.filters.priority]])])])]),os(" Tickets List "),es("div",Kl,[os(" Loading State "),n.ticketsStore.isLoading?(Gn(),Zn("div",Zl,[...Jl])):n.ticketsStore.error?(Gn(),Zn(jn,{key:1},[os(" Error State "),es("div",Xl,[es("div",Yl,[Ql,es("span",null,ee(n.ticketsStore.error),1)])])],2112)):n.tickets&&n.tickets.length>0?(Gn(),Zn(jn,{key:2},[os(" Tickets List "),es("div",ec,[(Gn(!0),Zn(jn,null,Ei(n.tickets,(e=>(Gn(),Zn("div",{key:e._id,onClick:t=>n.goToTicketDetail(e._id,t),class:"chat-ticket-card p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-blue-400 dark:hover:border-blue-500 bg-white dark:bg-gray-800 shadow-sm cursor-pointer transition-all"},[os(" Ticket Content (Same as before) "),es("div",ic,[es("div",nc,[es("div",sc,[es("h3",oc,ee(e.title),1)]),es("span",{class:K(["block h-2 w-2 rounded-full flex-shrink-0 ml-1",{"bg-red-500":"urgent"===e.priority,"bg-amber-500":"high"===e.priority,"bg-blue-500":"medium"===e.priority,"bg-gray-400":"low"===e.priority}])},null,2)]),es("div",rc,[es("span",{class:K(["px-2 py-0.5 rounded-full text-xs font-medium",n.getStatusStyle(e.status)])},ee(e.status.charAt(0).toUpperCase()+e.status.slice(1)),3),es("span",{class:K(["px-2 py-0.5 rounded-full text-xs font-medium",n.getPriorityStyle(e.priority)])},ee(e.priority.charAt(0).toUpperCase()+e.priority.slice(1)),3),e.ticket_number?(Gn(),Zn("span",ac," #"+ee(e.ticket_number),1)):os("v-if",!0)]),es("p",lc,ee(e.description),1),es("div",cc,[es("span",dc,[uc,ns(" "+ee(e.customer_name),1)]),es("span",hc,[gc,ns(" "+ee(n.formatDate(e.created_at||"").split(",")[0]),1)])])])],8,tc)))),128))])],2112)):(Gn(),Zn(jn,{key:3},[os(" Empty State "),pc],2112))]),os(" Pagination "),n.ticketMeta&&n.ticketMeta.total_pages>1?(Gn(),Zn("div",fc,[es("div",mc,[es("button",{onClick:t[3]||(t[3]=e=>n.handlePageChange(n.ticketMeta.current_page-1)),disabled:!n.ticketMeta.has_previous,class:"px-3 py-1 text-sm font-medium rounded-l-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...vc],8,yc),(Gn(!0),Zn(jn,null,Ei(n.ticketMeta.total_pages,(e=>(Gn(),Zn("button",{key:e,onClick:t=>n.handlePageChange(e),class:K(["px-3 py-1 text-sm font-medium border-y border-r focus:ring-2 focus:ring-blue-500 focus:z-10 transition-colors",[e===n.currentPage?"bg-blue-500 text-white border-blue-500 dark:bg-blue-600 dark:border-blue-600 z-10":"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600"]])},ee(e),11,wc)))),128)),es("button",{onClick:t[4]||(t[4]=e=>n.handlePageChange(n.ticketMeta.current_page+1)),disabled:!n.ticketMeta.has_next,class:"px-3 py-1 text-sm font-medium rounded-r-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...bc],8,kc)])])):os("v-if",!0)],2),os(" Right Side: Chat Panel "),es("div",{class:K(["chat-panel flex-1 flex flex-col h-full",{"hidden md:flex":!n.displayingTicketDetail&&n.tickets.length>0,"w-full md:w-2/3":n.displayingTicketDetail}])},[os(" Empty State when no ticket is selected "),n.displayingTicketDetail&&n.selectedTicket?n.displayingTicketDetail&&n.selectedTicket?(Gn(),Zn(jn,{key:1},[os(" Chat Interface "),es("div",Sc,[os(" Enhanced Chat Header "),es("div",_c,[os(" Main Header Row "),es("div",Ec,[os(" Back Button (Mobile) "),es("button",{onClick:n.goBackToTickets,class:"md:hidden p-2 mr-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[...Ac]),es("div",Ic,[es("div",Oc,[es("h2",Dc,ee(n.selectedTicket.title),1),n.selectedTicket.ticket_number?(Gn(),Zn("span",{key:0,onClick:n.toggleTicketDrawer,class:"ml-2 px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"}," #"+ee(n.selectedTicket.ticket_number),1)):os("v-if",!0)]),es("div",Pc,[es("span",{class:K(["px-2 py-0.5 rounded-full text-xs font-medium",n.getStatusStyle(n.selectedTicket.status)])},ee(n.selectedTicket.status.charAt(0).toUpperCase()+n.selectedTicket.status.slice(1)),3),n.isConnected?(Gn(),Zn("span",Mc,[Wc,ns(" Live Chat ")])):os("v-if",!0)])])]),os(" Action Buttons Row "),n.getActionButtons.length>0?(Gn(),Zn("div",Uc,[es("div",Lc,[(Gn(!0),Zn(jn,null,Ei(n.getActionButtons,(e=>(Gn(),Zn("button",{key:e.type,onClick:e.onClick,disabled:n.isUpdating,class:K([e.class,"px-3 py-1.5 text-sm font-medium rounded-md shadow-sm flex items-center disabled:opacity-50 disabled:cursor-not-allowed transition-all hover:shadow-md"]),title:e.description},[os(" Loading spinner when updating "),n.isUpdating?(Gn(),Zn("svg",Fc,[...jc])):"check"===e.icon?(Gn(),Zn(jn,{key:1},[os(" Action Icons "),Hc],2112)):"x"===e.icon?(Gn(),Zn("svg",$c,[...Bc])):"refresh"===e.icon?(Gn(),Zn("svg",zc,[...Nc])):os("v-if",!0),ns(" "+ee(e.label),1)],10,Rc)))),128))]),os(" Status Info "),es("div",Gc," Last updated: "+ee(n.formatDate(n.selectedTicket.updated_at||n.selectedTicket.created_at||"").split(",")[0]),1)])):os("v-if",!0)]),os(" Ticket Details Drawer "),n.showTicketDrawer&&n.selectedTicket?(Gn(),Zn("div",Vc,[es("div",qc,[es("div",null,[Kc,es("p",Zc,ee(n.selectedTicket.description),1)]),es("div",Jc,[es("div",null,[Xc,es("p",Yc,[Qc,ns(" "+ee(n.selectedTicket.customer_name),1)])]),es("div",null,[ed,es("p",td,ee(n.formatDate(n.selectedTicket.created_at)),1)])]),n.selectedTicket.cs_user?(Gn(),Zn("div",id,[nd,es("p",sd,ee(n.selectedTicket.cs_user.full_name),1)])):os("v-if",!0)])])):os("v-if",!0),os(" Chat Component "),n.selectedTicket?(Gn(),Jn(n.TicketChat,{key:1,ticket:n.selectedTicket,onSendMessage:n.handleSendMessage,class:"flex-1 flex flex-col"},null,8,["ticket"])):os("v-if",!0)])],2112)):os("v-if",!0):(Gn(),Zn("div",Tc,[xc,os(" Mobile Back Button "),es("button",{onClick:t[5]||(t[5]=e=>n.displayingTicketDetail=!1),class:"md:hidden mt-4 inline-flex items-center px-4 py-2 text-sm bg-blue-500 text-white rounded-md hover:bg-blue-600 shadow-sm transition-colors"},[Cc,ns(" Back to Tickets ")])]))],2)])],2112))],2)],2112)}],["__scopeId","data-v-ef3fe763"],["__file","D:/nuxtjs/cappuccino-fe/widget/chat-box/components/ChatEmbeddedWidget.vue"]]);!function(){if("undefined"!=typeof window){const e={widgetDomains:["cappuccino-api.bsa.id","cappucino-api.bsa.id","cappuccino.bsa.id","cappucino.bsa.id"],isWidgetDomain:t=>e.widgetDomains.some((e=>t.includes(e))),isSecureContext:()=>"https:"===window.location.protocol||"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,addCSPMeta:(e=[])=>{try{const t=document.querySelector('meta[http-equiv="Content-Security-Policy"]'),i=[...["upgrade-insecure-requests"],...e].join("; ");if(t){const e=t.getAttribute("content")||"";if(!e.includes("upgrade-insecure-requests")){const n=e?`${e}; ${i}`:i;return t.setAttribute("content",n),console.log("[Cappuccino Widget] Updated existing CSP:",n),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"csp_updated",data:{content:n}}})),!0}}else{const e=document.createElement("meta");e.setAttribute("http-equiv","Content-Security-Policy"),e.setAttribute("content",i);const t=document.head||document.getElementsByTagName("head")[0];if(t)return t.appendChild(e),console.log("[Cappuccino Widget] Auto-added CSP meta tag:",i),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"csp_added",data:{content:i}}})),!0}return!1}catch(t){return console.warn("[Cappuccino Widget] Failed to manage CSP meta tag:",t),!1}},sanitizeURL:(t,i=!0)=>{if(!t||"string"!=typeof t)return t;if(t.startsWith("data:")||t.startsWith("blob:")||t.startsWith("javascript:")||t.startsWith("//"))return t;if(!e.isWidgetDomain(t))return t;let n=t;return i&&t.startsWith("http://")&&(n=t.replace("http://","https://"),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"https_enforced",data:{original:t,sanitized:n,reason:"widget_domain"}}}))),n},checkMixedContent:()=>{if(!e.isSecureContext())return console.warn("[Cappuccino Widget] Page is not served over HTTPS - mixed content issues may occur"),void window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"insecure_context",data:{protocol:window.location.protocol}}}));if("undefined"!=typeof window&&window.WIDGET_CONFIG){const t=window.WIDGET_CONFIG;t.baseUrlApi&&t.baseUrlApi.startsWith("http://")&&e.isWidgetDomain(t.baseUrlApi)&&(console.warn("[Cappuccino Widget] Widget API URL uses HTTP - this may cause mixed content issues"),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"mixed_content_detected",data:{type:"api",url:t.baseUrlApi}}}))),t.baseUrlWs&&t.baseUrlWs.startsWith("ws://")&&e.isWidgetDomain(t.baseUrlWs)&&(console.warn("[Cappuccino Widget] Widget WebSocket URL uses WS - this may cause mixed content issues"),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"mixed_content_detected",data:{type:"websocket",url:t.baseUrlWs}}})))}},testSecureConnection:async t=>{const i=[];let n,s=!1,o=!1;if(!e.isWidgetDomain(t))return{success:!1,httpsSupported:!1,error:"Not a widget domain - skipping security test",recommendations:["Security tests only apply to widget domains"]};try{const e=t.replace(/^http:\/\//i,"https://");await fetch(e,{method:"HEAD",mode:"no-cors"});s=!0,o=!0,t.startsWith("http://")&&i.push("Consider updating your widget API to use HTTPS by default")}catch(r){n=r.message,t.startsWith("http://")&&(i.push("Your widget API uses HTTP. Widget will auto-upgrade to HTTPS"),i.push("Ensure your server supports HTTPS connections")),"undefined"!=typeof window&&"https:"===window.location.protocol&&i.push("Page is HTTPS but widget API might be HTTP - widget will handle upgrade automatically")}return{success:o,httpsSupported:s,error:n,recommendations:i}}},t=()=>{try{e.addCSPMeta()}catch(t){console.warn("[Cappuccino Widget] Failed to add CSP meta tag:",t)}},i=window.fetch,n=()=>function(t,n){let s;if(s=t instanceof Request?t.url:t instanceof URL?t.toString():t,e.isWidgetDomain(s)){s=(e=>{if(e.startsWith("data:")||e.startsWith("blob:")||e.startsWith("javascript:")||e.startsWith("//"))return e;if(e.match(/^https?:\/\//)){let t=e.replace(/^http:\/\//i,"https://");return t!==e&&(console.log("[Cappuccino Widget] Forced HTTPS for widget domain:",e,"->",t),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"fetch_https_enforced",data:{original:e,converted:t,domain:"widget"}}}))),t}return e})(s),t=t instanceof Request?new Request(s,t):s}return i.apply(window,[t,n])},s=n(),o=XMLHttpRequest.prototype.open,r=()=>function(t,i,n,s,r){if("string"==typeof i&&e.isWidgetDomain(i)&&i.startsWith("http://")){const e=i;i=i.replace("http://","https://"),console.log("[Cappuccino Widget] XHR forced HTTPS for widget domain:",e,"->",i),window.dispatchEvent(new CustomEvent("widget-security-event",{detail:{type:"xhr_https_enforced",data:{original:e,converted:i,domain:"widget"}}}))}const a=void 0===n||n;return o.call(this,t,i,a,s,r)};let a=!1;const l=()=>{a||(window.fetch=n(),XMLHttpRequest.prototype.open=r(),a=!0,console.log("[Cappuccino Widget] Global security override enabled (scoped to widget domains)"))},c=()=>{a&&(window.fetch=i,XMLHttpRequest.prototype.open=o,a=!1,console.log("[Cappuccino Widget] Global security override disabled"))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t();const d={...e,widgetFetch:s,enableGlobalOverride:l,disableGlobalOverride:c,isGlobalOverrideEnabled:()=>a,getWidgetDomains:()=>[...e.widgetDomains],addWidgetDomain:t=>{e.widgetDomains.includes(t)||(e.widgetDomains.push(t),console.log("[Cappuccino Widget] Added widget domain:",t))},removeWidgetDomain:t=>{const i=e.widgetDomains.indexOf(t);i>-1&&(e.widgetDomains.splice(i,1),console.log("[Cappuccino Widget] Removed widget domain:",t))}};window.CappuccinoSecurityHelpers=d,console.log("[Cappuccino Widget] Safe scoped security measures initialized"),console.log("[Cappuccino Widget] Protected domains:",e.widgetDomains),console.log("[Cappuccino Widget] Global override:",a?"Enabled":"Disabled (Safe Mode)")}}();const rd=(e,t,i,n)=>{var s;if("undefined"!=typeof window&&window.WIDGET_DEBUG){const i=(null==(s=window.CappuccinoSecurityHelpers)?void 0:s.isSecureContext())?"[SECURE]":"[INSECURE]";console.log(`[EmbeddedWidget] ${i} ${e}`,t||"")}},ad=(e,t)=>{var i;const n=(null==(i=window.CappuccinoSecurityHelpers)?void 0:i.isSecureContext())?"[SECURE]":"[INSECURE]";console.error(`[EmbeddedWidget] ${n} ${e}`,t||"")},ld=(e,t)=>{rd(`Applying theme: ${t} to container`),e.classList.remove("dark","light"),e.classList.add(t),e.setAttribute("data-theme",t),e.style.colorScheme=t,e.offsetHeight,rd("Theme applied successfully:",{theme:t,classes:e.className,dataTheme:e.getAttribute("data-theme"),colorScheme:e.style.colorScheme})};function cd(e){var t;const i={autoAddCSP:!1!==e.autoAddCSP,enforceHTTPS:!1!==e.enforceHTTPS,enableGlobalOverride:!0===e.enableGlobalOverride,...e};i.debug&&(window.WIDGET_DEBUG=!0),rd("Creating embedded chat widget with safe scoped security...",i);const n=window.CappuccinoSecurityHelpers;if(n&&i.securityDomains&&(i.securityDomains.forEach((e=>{n.addWidgetDomain(e)})),rd("Additional security domains added:",i.securityDomains)),i.autoAddCSP&&n){rd("Auto-adding CSP meta tag...");n.addCSPMeta([])&&rd("CSP meta tag added successfully")}if(i.enableGlobalOverride&&n?(rd("Enabling global security override (scoped to widget domains)..."),n.enableGlobalOverride()):rd("Global override disabled - using safe scoped mode"),i.enforceHTTPS&&n){if(i.baseUrlApi){const e=i.baseUrlApi;i.baseUrlApi=n.sanitizeURL(i.baseUrlApi),e!==i.baseUrlApi&&rd("API URL sanitized:",e,0,i.baseUrlApi)}if(i.baseUrlWs){const e=i.baseUrlWs;i.baseUrlWs=n.sanitizeURL(i.baseUrlWs).replace("http://","wss://").replace("https://","wss://"),e!==i.baseUrlWs&&rd("WebSocket URL sanitized:",e,0,i.baseUrlWs)}}if(!i.apiKey)throw new Error("API Key is required for CS/Admin chat widget initialization");if(!i.baseUrlApi)throw new Error("Base URL API is required for CS/Admin chat widget initialization");if(!i.baseUrlWs)throw new Error("Base URL WebSocket is required for CS/Admin chat widget initialization");if(!i.containerId)throw new Error("Container ID is required for embedded CS/Admin chat widget");if("chat-only"===i.mode){if(!(null==(t=i.chatOnly)?void 0:t.ticketId)&&!i.ticketId)throw new Error("ticketId is required for chat-only mode");i.chatOnly||(i.chatOnly={ticketId:i.ticketId,autoConnect:!0}),rd("Chat-only mode configuration:",i.chatOnly)}const s=document.getElementById(i.containerId);if(!s)throw new Error(`Container element with ID "${i.containerId}" not found`);rd("Container found:",s),window.WIDGET_CONFIG={apiKey:i.apiKey,baseUrlApi:i.baseUrlApi,baseUrlWs:i.baseUrlWs,isProduction:i.isProduction};const o=function(){const e=re(!0),t=e.run((()=>St({})));let i=[],n=[];const s=vt({install(e){ao(s),s._a=e,e.provide(lo,s),e.config.globalProperties.$pinia=s,n.forEach((e=>i.push(e))),n=[]},use(e){return this._a||oo?i.push(e):n.push(e),this},_p:i,_a:null,_e:e,_s:new Map,state:t});return s}();let r=null,a=null,l=!1,c=null;((e,t)=>{rd("Preparing container with configuration",t),e.className="cappuccino-chat-embedded-widget";const i=window.CappuccinoSecurityHelpers;(null==i?void 0:i.isSecureContext())?e.classList.add("secure-context"):e.classList.add("insecure-context"),"chat-only"===t.mode?e.classList.add("chat-only-mode"):e.classList.add("full-mode"),t.height?e.style.height=t.height:"chat-only"===t.mode&&(e.style.height="400px"),t.width&&(e.style.width=t.width);const n=t.theme||"light";ld(e,n),t.debug&&(window.WIDGET_DEBUG=!0,e.setAttribute("data-debug","true")),rd("Container prepared successfully")})(s,i),i.onSecurityEvent&&window.addEventListener("widget-security-event",(e=>{i.onSecurityEvent(e.detail)}));const d=async()=>{if(l)rd("Widget already initialized, skipping...");else try{rd("Initializing Embedded Chat Widget with safe security..."),c=((e,t)=>{rd("Initializing stores...");try{const i=window.CappuccinoSecurityHelpers;i&&i.checkMixedContent();const n=$o(e);n.initializeFromStorage(),t.theme&&(rd(`Setting theme from config: ${t.theme}`),n.setTheme(t.theme)),rd("Theme store initialized:",{currentTheme:n.currentTheme,isDark:n.isDark,isInitialized:n.isInitialized}),t.agentId&&(rd("Initializing profile store..."),Uo(e).setProfile({_id:t.agentId,full_name:t.agentName||"CS Agent",avatar:t.agentAvatar,email:"",status:"online",company_id:t.companyId||""}),rd("Profile store initialized"));let s=null;return(t.companyId||"chat-only"===t.mode)&&(rd("Initializing tickets store..."),s=Ro(e),t.companyId&&s.setFilters({companyId:t.companyId,...t.filterDefaults}),rd("Tickets store initialized")),{themeStore:n,profileStore:t.agentId?Uo(e):null,ticketsStore:s}}catch(i){throw ad("Failed to initialize stores:",i),i}})(o,i),await(async(e,t)=>{var i,n;if("chat-only"===t.mode&&(null==(i=t.chatOnly)?void 0:i.ticketId)){rd("Initializing chat-only mode for ticket:",t.chatOnly.ticketId);try{const i=e.ticketsStore;if(!i)throw new Error("Tickets store not available for chat-only mode");if(await i.getTicketById(t.chatOnly.ticketId),rd("Ticket loaded for chat-only mode:",null==(n=i.selectedTicket)?void 0:n.title),!1!==t.chatOnly.autoConnect&&e.profileStore){const e=Fo();await e.initializeChat(),rd("Chat connection initialized for chat-only mode")}}catch(s){throw ad("Failed to initialize chat-only mode:",s),s}}})(c,i),r=so(od,{agentName:i.agentName||"CS Agent",agentAvatar:i.agentAvatar,initialTheme:i.theme||"light",showNotifications:void 0===i.showNotifications||i.showNotifications,chatLimit:i.chatLimit||10,initialView:"chat-only"===i.mode?"chat":i.initialView||"tickets",filterDefaults:i.filterDefaults||{},companyId:i.companyId,mode:i.mode||"full",chatOnly:i.chatOnly}),r.use(o),r.mount(s),rd("Embedded Chat Widget mounted successfully"),((e,t)=>{setTimeout((()=>{rd("Performing post-mount theme verification...");const i=t.themeStore.currentTheme,n=e.classList.contains(i),s=e.getAttribute("data-theme"),o=e.style.colorScheme;if(rd("Theme verification results:",{expectedTheme:i,hasCorrectClass:n,dataTheme:s,colorScheme:o,containerClasses:e.className}),n&&s===i&&o===i)rd("Theme verification passed");else{rd("Theme mismatch detected, fixing..."),ld(e,i);const t=new CustomEvent("widget-theme-force-update",{detail:{theme:i}});e.dispatchEvent(t)}}),100)})(s,c),"chat-only"!==i.mode&&c.ticketsStore&&(await c.ticketsStore.fetchTickets(),rd("Initial tickets fetched:",c.ticketsStore.tickets.length)),l=!0,window.addEventListener("widget-theme-change",(e=>{rd("Theme change event received:",e.detail),e.detail.theme&&ld(s,e.detail.theme)})),rd("Widget initialization completed successfully")}catch(e){throw rd("Failed to initialize Embedded Chat Widget:",e),e}};return a={destroy:()=>{rd("Destroying widget..."),r&&(r.unmount(),s.innerHTML="",l=!1,c=null,i.enableGlobalOverride&&n&&(n.disableGlobalOverride(),rd("Global security override disabled on widget destroy")),window.removeEventListener("widget-theme-change",(()=>{})),window.removeEventListener("widget-security-event",(()=>{})),rd("Embedded widget destroyed"))},initialize:async()=>{l||await d()},setTheme:e=>{rd(`Widget setTheme called with: ${e}`),(null==c?void 0:c.themeStore)?(c.themeStore.setTheme(e),ld(s,e)):(rd("Theme store not available, applying directly to container"),ld(s,e))},getTheme:()=>(null==c?void 0:c.themeStore)?c.themeStore.currentTheme:s.getAttribute("data-theme")||"light",toggleTheme:()=>{const e=a.getTheme(),t="light"===e?"dark":"light";rd(`Toggling theme from ${e} to ${t}`),a.setTheme(t)},loadTicket:async e=>{if(rd("Loading ticket:",e),l||await d(),null==c?void 0:c.ticketsStore)return await c.ticketsStore.getTicketById(e),rd("Ticket loaded:",c.ticketsStore.selectedTicket),c.ticketsStore.selectedTicket},sendMessage:async e=>{var t;rd("Sending message:",e),l||await d();const i=null==(t=null==c?void 0:c.ticketsStore)?void 0:t.selectedTicket;if(!(null==i?void 0:i.chat_code))throw new Error("No active ticket or chat code available");const n=Fo();await n.sendMessage(e,i.chat_code)},getCurrentTicket:()=>{var e;return(null==(e=null==c?void 0:c.ticketsStore)?void 0:e.selectedTicket)||null},refreshTickets:async()=>{rd("Refreshing tickets..."),l||await d(),(null==c?void 0:c.ticketsStore)&&(await c.ticketsStore.fetchTickets(),rd("Tickets refreshed:",c.ticketsStore.tickets.length))},showTickets:async()=>{"chat-only"!==i.mode?(rd("showTickets called"),l||await d(),(null==c?void 0:c.ticketsStore)&&(await c.ticketsStore.fetchTickets(),rd("Tickets loaded:",c.ticketsStore.tickets.length))):rd("showTickets called in chat-only mode - ignoring")},showChat:async e=>{rd("showChat called",e),l||await d(),e&&(null==c?void 0:c.ticketsStore)&&(await c.ticketsStore.getTicketById(e),rd("Ticket loaded:",c.ticketsStore.selectedTicket))},setFilters:async e=>{"chat-only"!==i.mode?(rd("Setting filters:",e),l||await d(),(null==c?void 0:c.ticketsStore)&&(c.ticketsStore.setFilters(e),await c.ticketsStore.fetchTickets(),rd("Filters applied, tickets:",c.ticketsStore.tickets.length))):rd("setFilters called in chat-only mode - ignoring")},getConfig:()=>({...i}),updateChatOnlyConfig:e=>{"chat-only"===i.mode?(i.chatOnly={...i.chatOnly,...e},rd("Chat-only config updated:",i.chatOnly)):rd("updateChatOnlyConfig called in non-chat-only mode - ignoring")},checkSecurityStatus:()=>{var e,t;const n=window.CappuccinoSecurityHelpers;return{isSecureContext:(null==n?void 0:n.isSecureContext())||!1,hasCSP:!!document.querySelector('meta[http-equiv="Content-Security-Policy"]'),protocol:window.location.protocol,apiUrl:null==(e=window.WIDGET_CONFIG)?void 0:e.baseUrlApi,wsUrl:null==(t=window.WIDGET_CONFIG)?void 0:t.baseUrlWs,configSecurity:{autoAddCSP:i.autoAddCSP,enforceHTTPS:i.enforceHTTPS,enableGlobalOverride:i.enableGlobalOverride,debug:i.debug},globalOverrideStatus:(null==n?void 0:n.isGlobalOverrideEnabled())||!1,protectedDomains:(null==n?void 0:n.getWidgetDomains())||[]}},addCSP:(e=[])=>{const t=window.CappuccinoSecurityHelpers;return!!t&&t.addCSPMeta(e)},forceHTTPS:()=>{const e=window.CappuccinoSecurityHelpers;if(e){const t=a.getConfig();let i=!1;if(t.baseUrlApi&&t.baseUrlApi.startsWith("http://")){const n=e.sanitizeURL(t.baseUrlApi);a.updateConfig({baseUrlApi:n}),i=!0}if(t.baseUrlWs&&t.baseUrlWs.startsWith("ws://")){const e=t.baseUrlWs.replace("ws://","wss://");a.updateConfig({baseUrlWs:e}),i=!0}return i&&rd("HTTPS enforcement applied to widget configuration"),i}return!1},testSecureConnection:async()=>{const e=window.CappuccinoSecurityHelpers;return e&&i.baseUrlApi?await e.testSecureConnection(i.baseUrlApi):{success:!1,httpsSupported:!1,error:"Security helpers not available",recommendations:["Ensure widget is properly loaded"]}},toggleGlobalOverride:()=>{const e=window.CappuccinoSecurityHelpers;return!!e&&(e.isGlobalOverrideEnabled()?(e.disableGlobalOverride(),rd("Global security override disabled"),!1):(e.enableGlobalOverride(),rd("Global security override enabled (scoped to widget domains)"),!0))},getProtectedDomains:()=>{const e=window.CappuccinoSecurityHelpers;return(null==e?void 0:e.getWidgetDomains())||[]},addProtectedDomain:e=>{const t=window.CappuccinoSecurityHelpers;return!!t&&(t.addWidgetDomain(e),rd("Added protected domain:",e),!0)},widgetFetch:async(e,t)=>{const i=window.CappuccinoSecurityHelpers;return(null==i?void 0:i.widgetFetch)?await i.widgetFetch(e,t):await fetch(e,t)},debugTheme:()=>{var e;const t=a.getTheme(),i=null==(e=null==c?void 0:c.themeStore)?void 0:e.currentTheme;rd("=== WIDGET THEME DEBUG ==="),rd("Widget theme:",t),rd("Store theme:",i),rd("Container classes:",s.className),rd("Container data-theme:",s.getAttribute("data-theme")),rd("Container color-scheme:",s.style.colorScheme),(null==c?void 0:c.themeStore)&&c.themeStore.debug();const n=window.getComputedStyle(s);rd("Computed background-color:",n.backgroundColor),rd("Computed color:",n.color);const o=s.className.split(" ");return rd("All container classes:",o),rd("========================"),{widgetTheme:t,storeTheme:i,containerClasses:s.className,dataTheme:s.getAttribute("data-theme"),colorScheme:s.style.colorScheme,computedBackground:n.backgroundColor,computedColor:n.color}},debugSecurity:()=>{const e=a.checkSecurityStatus(),t=window.CappuccinoSecurityHelpers;return rd("=== WIDGET SECURITY DEBUG ==="),rd("Security Status:",e),rd("Security Helpers Available:",!!t),rd("CSP Meta Tag:",document.querySelector('meta[http-equiv="Content-Security-Policy"]')),rd("Widget Config:",i),rd("Protected Domains:",(null==t?void 0:t.getWidgetDomains())||[]),rd("Global Override Enabled:",(null==t?void 0:t.isGlobalOverrideEnabled())||!1),rd("Window Location:",{protocol:window.location.protocol,hostname:window.location.hostname,href:window.location.href}),rd("=============================="),{securityStatus:e,securityHelpersAvailable:!!t,cspMetaTag:document.querySelector('meta[http-equiv="Content-Security-Policy"]'),widgetConfig:i,protectedDomains:(null==t?void 0:t.getWidgetDomains())||[],globalOverrideEnabled:(null==t?void 0:t.isGlobalOverrideEnabled())||!1,windowLocation:{protocol:window.location.protocol,hostname:window.location.hostname,href:window.location.href}}},forceTheme:e=>{const t=e||a.getTheme();rd(`Force applying theme: ${t}`),ld(s,t),(null==c?void 0:c.themeStore)&&c.themeStore.setTheme(t);const i=new CustomEvent("widget-theme-force-update",{detail:{theme:t}});return s.dispatchEvent(i),a.debugTheme()},getState:()=>{var e;return{isInitialized:l,theme:a.getTheme(),hasStores:!!c,containerElement:s,config:{...i},mode:i.mode,currentTicket:(null==(e=null==c?void 0:c.ticketsStore)?void 0:e.selectedTicket)||null,security:a.checkSecurityStatus()}},updateConfig:e=>{if(rd("Updating configuration:",e),Object.assign(i,e),e.theme&&a.setTheme(e.theme),e.height&&(s.style.height=e.height),e.width&&(s.style.width=e.width),e.baseUrlApi||e.baseUrlWs||e.apiKey){const t=window.WIDGET_CONFIG;e.baseUrlApi&&(t.baseUrlApi=e.baseUrlApi),e.baseUrlWs&&(t.baseUrlWs=e.baseUrlWs),e.apiKey&&(t.apiKey=e.apiKey)}}},d().catch((e=>{ad("Failed to initialize widget:",e)})),i.debug&&(window.debugEmbeddedWidget=a.debugTheme,window.debugEmbeddedWidgetSecurity=a.debugSecurity,window.forceEmbeddedWidgetTheme=a.forceTheme,window.getEmbeddedWidgetState=a.getState,window.checkEmbeddedWidgetSecurity=a.checkSecurityStatus),a}window.CappuccinoChatEmbeddedWidget=cd,e.createEmbeddedChatWidget=cd,e.default=cd,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
